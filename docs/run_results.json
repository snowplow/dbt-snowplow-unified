{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.2", "generated_at": "2026-01-20T14:49:14.424896Z", "invocation_id": "69181895-0854-4f72-b03d-e7c8daeb1e27", "invocation_started_at": "2026-01-20T14:48:59.050009Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.372574Z", "completed_at": "2026-01-20T14:49:09.402480Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.403690Z", "completed_at": "2026-01-20T14:49:09.403709Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.036275386810302734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_base_quarantined_sessions", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n        with prep as (\n        select\n            \n                cast(null as \n    TEXT\n) session_identifier\n            \n        )\n\n        select *\n\n        from prep\n        where false\n\n    ", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snowplow_manifest.snowplow_unified_base_quarantined_sessions", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.386878Z", "completed_at": "2026-01-20T14:49:09.404826Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.406760Z", "completed_at": "2026-01-20T14:49:09.406771Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.037468671798706055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_incremental_manifest", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n        with prep as (\n        select\n            cast(null as \n    TEXT\n) model,\n            cast('1970-01-01' as timestamp) as last_success\n        )\n\n        select *\n\n        from prep\n        where false\n    ", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snowplow_manifest.snowplow_unified_incremental_manifest", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.393328Z", "completed_at": "2026-01-20T14:49:09.406060Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.409097Z", "completed_at": "2026-01-20T14:49:09.409109Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.038527488708496094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "operation.snowplow_unified.snowplow_unified-on-run-end-1", "compiled": true, "compiled_code": "\n                \n            ", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.397592Z", "completed_at": "2026-01-20T14:49:09.407625Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.410780Z", "completed_at": "2026-01-20T14:49:09.410792Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.03960156440734863, "adapter_response": {}, "message": null, "failures": null, "unique_id": "operation.snowplow_unified.snowplow_unified-on-run-start-0", "compiled": true, "compiled_code": "\n\n  \n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.414387Z", "completed_at": "2026-01-20T14:49:09.421015Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.428778Z", "completed_at": "2026-01-20T14:49:09.428797Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.020481348037719727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "operation.snowplow_unified.snowplow_unified-on-run-start-2", "compiled": true, "compiled_code": "\n\n  \n\n  \n\n  \n  \n  \n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.421621Z", "completed_at": "2026-01-20T14:49:09.424249Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.429794Z", "completed_at": "2026-01-20T14:49:09.429805Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01679253578186035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_unified.snowplow_unified_dim_ga4_source_categories", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.425536Z", "completed_at": "2026-01-20T14:49:09.428121Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.434880Z", "completed_at": "2026-01-20T14:49:09.434891Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.016731977462768555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_unified.snowplow_unified_dim_geo_country_mapping", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.430697Z", "completed_at": "2026-01-20T14:49:09.434231Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.437233Z", "completed_at": "2026-01-20T14:49:09.437249Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.0176699161529541, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_unified.snowplow_unified_dim_iso_639_2t", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.444275Z", "completed_at": "2026-01-20T14:49:09.446773Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.454330Z", "completed_at": "2026-01-20T14:49:09.454349Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.015610218048095703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_unified.snowplow_unified_dim_iso_639_3", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.447396Z", "completed_at": "2026-01-20T14:49:09.449848Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.455449Z", "completed_at": "2026-01-20T14:49:09.455460Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.015962839126586914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_unified.snowplow_unified_dim_rfc_5646_language_mapping", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.451247Z", "completed_at": "2026-01-20T14:49:09.453687Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.460260Z", "completed_at": "2026-01-20T14:49:09.460272Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.019418001174926758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_unified_integration_tests.snowplow_unified_base_quarantined_sessions_expected", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.456328Z", "completed_at": "2026-01-20T14:49:09.459634Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.462603Z", "completed_at": "2026-01-20T14:49:09.462618Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.0196993350982666, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_unified_integration_tests.snowplow_unified_consent_cmp_stats_expected", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.469577Z", "completed_at": "2026-01-20T14:49:09.472063Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.479568Z", "completed_at": "2026-01-20T14:49:09.479583Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01549386978149414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_unified_integration_tests.snowplow_unified_consent_cmp_visible", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.472719Z", "completed_at": "2026-01-20T14:49:09.475160Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.480621Z", "completed_at": "2026-01-20T14:49:09.480632Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.015738964080810547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_unified_integration_tests.snowplow_unified_consent_log_expected", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.476522Z", "completed_at": "2026-01-20T14:49:09.478918Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.485695Z", "completed_at": "2026-01-20T14:49:09.485708Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0194854736328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_unified_integration_tests.snowplow_unified_consent_preferences", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.482564Z", "completed_at": "2026-01-20T14:49:09.485044Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.488181Z", "completed_at": "2026-01-20T14:49:09.488192Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.019981861114501953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_unified_integration_tests.snowplow_unified_consent_scope_status_expected", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.495015Z", "completed_at": "2026-01-20T14:49:09.497411Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.505975Z", "completed_at": "2026-01-20T14:49:09.505989Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.016297340393066406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_unified_integration_tests.snowplow_unified_consent_totals_expected", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.498058Z", "completed_at": "2026-01-20T14:49:09.500594Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.506974Z", "completed_at": "2026-01-20T14:49:09.506985Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.016613245010375977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_unified_integration_tests.snowplow_unified_consent_users_expected", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.501964Z", "completed_at": "2026-01-20T14:49:09.505324Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.510905Z", "completed_at": "2026-01-20T14:49:09.510919Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.019174575805664062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_unified_integration_tests.snowplow_unified_consent_versions_expected", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.507891Z", "completed_at": "2026-01-20T14:49:09.510261Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.513368Z", "completed_at": "2026-01-20T14:49:09.513381Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.019701242446899414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_unified_integration_tests.snowplow_unified_cwv", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.520313Z", "completed_at": "2026-01-20T14:49:09.523064Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.531322Z", "completed_at": "2026-01-20T14:49:09.531333Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.016415119171142578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_unified_integration_tests.snowplow_unified_events", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.523700Z", "completed_at": "2026-01-20T14:49:09.526056Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.532497Z", "completed_at": "2026-01-20T14:49:09.532508Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.016823291778564453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_unified_integration_tests.snowplow_unified_geolocation_context", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.527308Z", "completed_at": "2026-01-20T14:49:09.530698Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.536382Z", "completed_at": "2026-01-20T14:49:09.536394Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.019423723220825195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_unified_integration_tests.snowplow_unified_screen_engagement_events", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.533379Z", "completed_at": "2026-01-20T14:49:09.535750Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.538767Z", "completed_at": "2026-01-20T14:49:09.538779Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.01993727684020996, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_unified_integration_tests.snowplow_unified_screen_view_event", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.545479Z", "completed_at": "2026-01-20T14:49:09.547849Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.556679Z", "completed_at": "2026-01-20T14:49:09.556692Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.016445398330688477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_unified_integration_tests.snowplow_unified_session_context", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.548500Z", "completed_at": "2026-01-20T14:49:09.551255Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.557732Z", "completed_at": "2026-01-20T14:49:09.557743Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.016822099685668945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_unified_integration_tests.snowplow_unified_sessions_expected", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.552664Z", "completed_at": "2026-01-20T14:49:09.556035Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.561644Z", "completed_at": "2026-01-20T14:49:09.561657Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.019426822662353516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_unified_integration_tests.snowplow_unified_users_expected", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.558637Z", "completed_at": "2026-01-20T14:49:09.561006Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.564174Z", "completed_at": "2026-01-20T14:49:09.564186Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.020070552825927734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_unified_integration_tests.snowplow_unified_views_expected", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.570953Z", "completed_at": "2026-01-20T14:49:09.573344Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.581981Z", "completed_at": "2026-01-20T14:49:09.581995Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.016313791275024414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_unified_integration_tests.snowplow_unified_views_mobile_screen_engagement_expected", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.574000Z", "completed_at": "2026-01-20T14:49:09.576582Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.582988Z", "completed_at": "2026-01-20T14:49:09.582999Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.016599655151367188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_unified_integration_tests.snowplow_unified_web_vital_events", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.577980Z", "completed_at": "2026-01-20T14:49:09.581328Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.587683Z", "completed_at": "2026-01-20T14:49:09.587695Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.019912004470825195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.snowplow_unified_integration_tests.snowplow_unified_web_vital_measurements_expected", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.583905Z", "completed_at": "2026-01-20T14:49:09.591966Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.594529Z", "completed_at": "2026-01-20T14:49:09.594545Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.02490520477294922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified_integration_tests.snowplow_unified_base_quarantined_sessions_actual", "compiled": true, "compiled_code": "\n\n\n\nselect *\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snowplow_manifest.snowplow_unified_base_quarantined_sessions", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_base_quarantined_sessions_actual", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.607840Z", "completed_at": "2026-01-20T14:49:09.628659Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.631351Z", "completed_at": "2026-01-20T14:49:09.631364Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03885531425476074, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_base_quarantined_sessions_session_identifier.09ea66d5f8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    session_identifier as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snowplow_manifest.snowplow_unified_base_quarantined_sessions\nwhere session_identifier is not null\ngroup by session_identifier\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.596678Z", "completed_at": "2026-01-20T14:49:09.629988Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.637487Z", "completed_at": "2026-01-20T14:49:09.637499Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.046309471130371094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_base_quarantined_sessions_session_identifier.aaf46f9514", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_identifier\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snowplow_manifest.snowplow_unified_base_quarantined_sessions\nwhere session_identifier is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.633123Z", "completed_at": "2026-01-20T14:49:09.639295Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.641304Z", "completed_at": "2026-01-20T14:49:09.641319Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.014635801315307617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "operation.snowplow_unified.snowplow_unified-on-run-start-1", "compiled": true, "compiled_code": "", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.644938Z", "completed_at": "2026-01-20T14:49:09.657764Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.663536Z", "completed_at": "2026-01-20T14:49:09.663549Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02301645278930664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_incremental_manifest_model.5f8ae0dc3e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect model\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snowplow_manifest.snowplow_unified_incremental_manifest\nwhere model is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.650937Z", "completed_at": "2026-01-20T14:49:09.665568Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.666975Z", "completed_at": "2026-01-20T14:49:09.666988Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.024859905242919922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_incremental_manifest_model.eae251f82d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    model as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snowplow_manifest.snowplow_unified_incremental_manifest\nwhere model is not null\ngroup by model\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.658390Z", "completed_at": "2026-01-20T14:49:09.669210Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.675786Z", "completed_at": "2026-01-20T14:49:09.675798Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.025708436965942383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_dim_iso_639_2t_iso_639_2t_code.62c445e871", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect iso_639_2t_code\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snowplow_manifest.snowplow_unified_dim_iso_639_2t\nwhere iso_639_2t_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.669883Z", "completed_at": "2026-01-20T14:49:09.678069Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.684011Z", "completed_at": "2026-01-20T14:49:09.684022Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.017830371856689453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_dim_iso_639_2t_iso_639_2t_code.05aa3c2bfb", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    iso_639_2t_code as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snowplow_manifest.snowplow_unified_dim_iso_639_2t\nwhere iso_639_2t_code is not null\ngroup by iso_639_2t_code\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.678781Z", "completed_at": "2026-01-20T14:49:09.686406Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.693102Z", "completed_at": "2026-01-20T14:49:09.693114Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.018222570419311523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified_integration_tests.snowplow_unified_base_quarantined_sessions_expected_stg", "compiled": true, "compiled_code": "\n\n\n\nselect *\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_base_quarantined_sessions_expected", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_base_quarantined_sessions_expected_stg", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.687107Z", "completed_at": "2026-01-20T14:49:09.701262Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.702897Z", "completed_at": "2026-01-20T14:49:09.702909Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.019666194915771484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified_integration_tests.snowplow_unified_consent_cmp_stats_expected_stg", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n\n  event_id,\n  user_identifier,\n  cast(view_id as TEXT) as view_id,\n  session_identifier,\n  cmp_load_time,\n  cast(cmp_tstamp as timestamp) as cmp_tstamp,\n  cast(first_consent_event_tstamp as timestamp) as first_consent_event_tstamp,\n  first_consent_event_type,\n  cmp_interaction_time\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_cmp_stats_expected", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_cmp_stats_expected_stg", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.695605Z", "completed_at": "2026-01-20T14:49:09.704443Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.710043Z", "completed_at": "2026-01-20T14:49:09.710055Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.017889738082885742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified_integration_tests.snowplow_unified_consent_log_expected_stg", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n\n  event_id,\n  user_identifier,\n  user_id,\n  geo_country,\n  cast(view_id as TEXT) as view_id,\n  session_identifier,\n  cast(derived_tstamp as timestamp) as derived_tstamp,\n  cast(load_tstamp as timestamp) as load_tstamp,\n  event_name,\n  event_type,\n  basis_for_processing,\n  consent_url,\n  replace(cast(consent_version as TEXT), '.0', '') ||'.0' as consent_version,\n  consent_scopes,\n  domains_applied,\n  gdpr_applies,\n  cmp_load_time\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_log_expected", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_log_expected_stg", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.705700Z", "completed_at": "2026-01-20T14:49:09.712539Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.714490Z", "completed_at": "2026-01-20T14:49:09.714501Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.012486934661865234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified_integration_tests.snowplow_unified_consent_scope_status_expected_stg", "compiled": true, "compiled_code": "\n\n\n\n\nselect *\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_scope_status_expected", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_scope_status_expected_stg", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.715359Z", "completed_at": "2026-01-20T14:49:09.730109Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.731391Z", "completed_at": "2026-01-20T14:49:09.731402Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.020526885986328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified_integration_tests.snowplow_unified_consent_totals_expected_stg", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n\n  replace(cast(consent_version as TEXT), '.0', '') ||'.0' as consent_version,\n  cast(version_start_tstamp as timestamp) as version_start_tstamp,\n  consent_scopes,\n  consent_url,\n  domains_applied,\n  cast(is_latest_version as boolean)as is_latest_version,\n  cast(last_allow_all_event as timestamp) as last_allow_all_event,\n  total_visitors,\n  allow_all,\n  allow_selected,\n  allow,\n  pending,\n  denied,\n  expired,\n  withdrawn,\n  implicit_consent,\n  expires_in_six_months\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_totals_expected", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_totals_expected_stg", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.723337Z", "completed_at": "2026-01-20T14:49:09.732262Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.739130Z", "completed_at": "2026-01-20T14:49:09.739145Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02539515495300293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified_integration_tests.snowplow_unified_consent_users_expected_stg", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n\n  user_identifier,\n  user_id,\n  geo_country,\n  cmp_events,\n  consent_events,\n  cast(last_cmp_event_tstamp as timestamp) as last_cmp_event_tstamp,\n  cast(last_consent_event_tstamp as timestamp) as last_consent_event_tstamp,\n  last_consent_event_type,\n  last_consent_scopes,\n  replace(cast(last_consent_version as TEXT), '.0', '') ||'.0' as last_consent_version,\n  last_consent_url,\n  last_domains_applied,\n  cast(last_processed_event as timestamp) as last_processed_event,\n  cast(is_latest_version as boolean)  as is_latest_version\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_users_expected", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_users_expected_stg", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.732916Z", "completed_at": "2026-01-20T14:49:09.741534Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.743526Z", "completed_at": "2026-01-20T14:49:09.743538Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.014350175857543945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified_integration_tests.snowplow_unified_consent_versions_expected_stg", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n\n  replace(cast(consent_version as TEXT), '.0', '') ||'.0' as consent_version,\n  cast(version_start_tstamp as timestamp) as version_start_tstamp,\n  consent_scopes,\n  consent_url,\n  domains_applied,\n  cast(is_latest_version as boolean) as is_latest_version,\n  cast(last_allow_all_event as timestamp) as last_allow_all_event\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_versions_expected", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_versions_expected_stg", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.744394Z", "completed_at": "2026-01-20T14:49:09.767251Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.768053Z", "completed_at": "2026-01-20T14:49:09.768064Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.02797389030456543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified_integration_tests.snowplow_unified_sessions_expected_stg", "compiled": true, "compiled_code": "\n\n\n-- Removing model_tstamp\n\nSELECT\n\n    \n    event_counts\n    \n    ,cv_view_page_volume\n    \n        ,AS_ARRAY(parse_json(cv_view_page_events)) as cv_view_page_events\n        ,AS_ARRAY(parse_json(cv_view_page_values)) as cv_view_page_values  \n    \n    ,cv_view_page_total\n    ,cv_view_page_first_conversion\n    ,cv_view_page_converted\n    ,cv__all_volume\n    ,cv__all_total\n    ,first_event_name\n    ,last_event_name\n    ,session_identifier\n    ,session__previous_session_id\n    ,user_id\n    ,user_identifier\n    ,stitched_user_id\n    ,network_userid\n    ,start_tstamp\n    ,end_tstamp\n\n    -- hard-coding due to non-deterministic outcome from row_number for Redshift/Postgres/databricks\n    \n    , app_id\n    \n    ,platform\n    ,device_identifier\n    ,device_category\n    ,device_session_index\n    ,os_version\n    ,os_type\n    ,os_timezone\n    ,screen_resolution\n    ,yauaa__device_class\n    ,yauaa__device_brand\n    ,yauaa__device_version\n    ,yauaa__operating_system_version\n    ,yauaa__operating_system_class\n    ,yauaa__operating_system_name\n    ,yauaa__operating_system_name_version\n    ,mobile__device_manufacturer\n    ,mobile__device_model\n    ,mobile__os_type\n    ,mobile__os_version\n    ,mobile__android_idfa\n    ,mobile__apple_idfa\n    ,mobile__apple_idfv\n    ,mobile__carrier\n    ,mobile__open_idfa\n    ,mobile__network_technology\n    ,mobile__network_type\n    ,mobile__physical_memory\n    ,mobile__system_available_memory\n    ,mobile__app_available_memory\n    ,mobile__battery_level\n    ,mobile__battery_state\n    ,mobile__low_power_mode\n    ,mobile__available_storage\n    ,mobile__total_storage\n    ,mobile__is_portrait\n    ,mobile__resolution\n    ,mobile__scale\n    ,mobile__language\n    ,mobile__app_set_id\n    ,mobile__app_set_id_scope\n    ,first_geo_country\n    ,first_geo_region_name\n    ,first_geo_city\n    ,first_geo_country_name\n    ,first_geo_continent\n    ,last_geo_country\n    ,last_geo_region_name\n    ,last_geo_city\n    ,last_geo_country_name\n    ,last_geo_continent\n    ,geo_zipcode\n    ,geo_latitude\n    ,geo_longitude\n    ,geo_timezone\n    ,user_ipaddress\n    ,views\n\n    ,total_events\n    ,is_engaged\n    ,engaged_time_in_s\n\n  -- hard-coding due to different rounding in Bigquery\n\n    ,absolute_time_in_s\n\n\n    ,screen_names_viewed\n    ,mkt_medium\n    ,mkt_source\n    ,mkt_term\n    ,mkt_content\n    ,mkt_campaign\n    ,mkt_clickid\n    ,mkt_network\n    ,default_channel_group\n    ,mkt_source_platform\n    ,first_page_url\n    ,last_page_url\n    ,page_referrer\n    ,refr_medium\n    ,refr_source\n    ,refr_term\n    ,first_page_title\n    ,first_page_urlscheme\n    ,first_page_urlhost\n    ,first_page_urlpath\n    ,first_page_urlquery\n    ,first_page_urlfragment\n    ,last_page_title\n    ,last_page_urlscheme\n    ,last_page_urlhost\n    ,last_page_urlpath\n    ,last_page_urlquery\n    ,last_page_urlfragment\n    ,refr_urlscheme\n    ,refr_urlhost\n    ,refr_urlpath\n    ,refr_urlquery\n    ,refr_urlfragment\n    ,br_renderengine\n    ,first_br_lang\n    ,first_br_lang_name\n    ,last_br_lang\n    ,last_br_lang_name\n    ,iab__category\n    ,iab__primary_impact\n    ,iab__reason\n    ,iab__spider_or_robot\n    ,yauaa__device_name\n    ,yauaa__agent_class\n    ,yauaa__agent_name\n    ,yauaa__agent_name_version\n    ,yauaa__agent_name_version_major\n    ,yauaa__agent_version\n    ,yauaa__agent_version_major\n    ,yauaa__layout_engine_class\n    ,yauaa__layout_engine_name\n    ,yauaa__layout_engine_name_version\n    ,yauaa__layout_engine_name_version_major\n    ,yauaa__layout_engine_version\n    ,yauaa__layout_engine_version_major\n    ,ua__os_family\n    ,ua__device_family\n    ,ua__os_version\n    ,ua__os_major\n    ,ua__os_minor\n    ,ua__os_patch\n    ,ua__os_patch_minor\n    ,ua__useragent_family\n    ,ua__useragent_major\n    ,ua__useragent_minor\n    ,ua__useragent_patch\n    ,ua__useragent_version\n    ,first_screen_view__name\n    ,first_screen_view__type\n    ,last_screen_view__name\n    ,last_screen_view__transition_type\n    ,last_screen_view__type\n    ,screen_view__previous_id\n    ,screen_view__previous_name\n    ,screen_view__previous_type\n    ,first_app__build\n    ,first_app__version\n    ,first_geo__altitude\n    ,first_geo__altitude_accuracy\n    ,first_geo__bearing\n    ,first_geo__latitude\n    ,first_geo__latitude_longitude_accuracy\n    ,first_geo__longitude\n    ,first_geo__speed\n    ,app_errors\n    ,fatal_app_errors\n    ,useragent\n\n-- hard-coding due to non-deterministic outcome from row_number for Redshift/Postgres/databricks\n\n    ,event_id\n    ,event_id2\n\n    ,agg_test\n\nFROM SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_sessions_expected", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_sessions_expected_stg", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.755577Z", "completed_at": "2026-01-20T14:49:09.776483Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.778339Z", "completed_at": "2026-01-20T14:49:09.778355Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03561234474182129, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified_integration_tests.snowplow_unified_users_expected_stg", "compiled": true, "compiled_code": "\n\n\n\nselect\n  user_id\n  ,user_identifier\n  ,network_userid\n  ,stitched_user_id\n  ,start_tstamp\n  ,end_tstamp\n\n  ,first_platform\n  ,last_platform\n  ,on_web\n  ,on_mobile\n  ,last_screen_resolution\n  ,last_os_type\n  ,last_os_version\n  ,first_mobile__device_manufacturer\n  ,first_mobile__device_model\n  ,first_mobile__carrier\n  ,last_mobile__device_manufacturer\n  ,last_mobile__device_model\n  ,last_mobile__carrier\n  ,mobile__os_type\n  ,cast(mobile__os_version as TEXT) as mobile__os_version\n  ,mobile__android_idfa\n  ,mobile__apple_idfa\n  ,mobile__apple_idfv\n  ,mobile__open_idfa\n  ,mobile__network_technology\n  ,mobile__network_type\n  ,mobile__physical_memory\n  ,mobile__system_available_memory\n  ,mobile__app_available_memory\n  ,mobile__battery_level\n  ,mobile__battery_state\n  ,mobile__low_power_mode\n  ,mobile__available_storage\n  ,mobile__total_storage\n  ,mobile__is_portrait\n  ,mobile__resolution\n  ,cast(mobile__scale as float) as mobile__scale\n  ,mobile__language\n  ,mobile__app_set_id\n  ,mobile__app_set_id_scope\n  ,first_geo_country\n  ,first_geo_country_name\n  ,first_geo_continent\n  ,first_geo_city\n  ,first_geo_region_name\n  ,last_geo_country\n  ,last_geo_country_name\n  ,last_geo_continent\n  ,last_geo_city\n  ,last_geo_region_name\n  ,geo_zipcode\n  ,geo_latitude\n  ,geo_longitude\n  ,geo_timezone\n  ,views\n  ,sessions\n  ,active_days\n  ,engaged_time_in_s\n  ,screen_names_viewed\n\n  -- hard-coding due to different rounding in Bigquery\n\n  ,absolute_time_in_s\n\n\n  ,page_referrer\n  ,refr_medium\n  ,refr_source\n  ,refr_term\n  ,first_page_title\n  ,first_page_url\n  ,first_page_urlscheme\n  ,first_page_urlhost\n  ,first_page_urlpath\n  ,first_page_urlquery\n  ,first_page_urlfragment\n  ,first_br_lang\n  ,first_br_lang_name\n  ,last_page_title\n  ,last_page_url\n  ,last_page_urlscheme\n  ,last_page_urlhost\n  ,last_page_urlpath\n  ,last_page_urlquery\n  ,last_page_urlfragment\n  ,last_br_lang\n  ,last_br_lang_name\n  ,refr_urlscheme\n  ,refr_urlhost\n  ,refr_urlpath\n  ,refr_urlquery\n  ,refr_urlfragment\n  ,first_screen_view__name\n  ,first_screen_view__type\n  ,last_screen_view__name\n  ,last_screen_view__transition_type\n  ,last_screen_view__type\n  ,mkt_medium\n  ,mkt_source\n  ,mkt_term\n  ,mkt_content\n  ,mkt_campaign\n  ,mkt_clickid\n  ,mkt_network\n  ,mkt_source_platform\n  ,default_channel_group\n  ,app_errors\n  ,fatal_app_errors\n\n-- hard-coding due to non-deterministic outcome from row_number for Redshift/Postgres/databricks\n\n  ,first_event_id\n  ,first_event_id2\n  ,last_event_id\n  ,last_event_id2\n\n  ,agg_test\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_users_expected", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_users_expected_stg", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.762106Z", "completed_at": "2026-01-20T14:49:09.777120Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.779274Z", "completed_at": "2026-01-20T14:49:09.779285Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.018626689910888672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified_integration_tests.snowplow_unified_views_expected_stg", "compiled": true, "compiled_code": "\n\n\n\nselect\n-- hard-coding due to non-deterministic outcome from row_number for Redshift/Postgres/databricks\n\n  app_id,\n\n\n  -- hard-coding due to non-deterministic outcome from row_number for Redshift/Postgres/databricks\n\n  dvce_created_tstamp,\n\n\n  -- hard-coding due to non-deterministic outcome from row_number for Redshift/Postgres/databricks\n\n  derived_tstamp,\n\n\n  -- hard-coding due to non-deterministic outcome from row_number for Redshift/Postgres/databricks\n\n  start_tstamp,\n\n\n  -- hard-coding due to non-deterministic outcome from row_number for Redshift/Postgres/databricks\n\n  end_tstamp,\n\n\nview_id,\nevent_name,\nevent_id,\nsession_identifier,\n\n -- hard-coding due to non-deterministic outcome from row_number for Redshift/Postgres/databricks\n\n  view_in_session_index,\n\n\nviews_in_session,\nsession__previous_session_id,\nuser_id,\nuser_identifier,\nstitched_user_id,\n\n -- hard-coding due to non-deterministic outcome from row_number for Redshift/Postgres/databricks\n\n  network_userid,\n\n\ncollector_tstamp,\n\nplatform,\ndevice_identifier,\ndevice_category,\ndevice_session_index,\nos_version,\nos_type,\nmobile__device_manufacturer,\nmobile__device_model,\nmobile__os_type,\nmobile__os_version,\nmobile__android_idfa,\nmobile__apple_idfa,\nmobile__apple_idfv,\nmobile__carrier,\nmobile__open_idfa,\nmobile__network_technology,\nmobile__network_type,\nmobile__physical_memory,\nmobile__system_available_memory,\nmobile__app_available_memory,\nmobile__battery_level,\nmobile__battery_state,\nmobile__low_power_mode,\nmobile__available_storage,\nmobile__total_storage,\nmobile__is_portrait,\nmobile__resolution,\nmobile__scale,\nmobile__language,\nmobile__app_set_id,\nmobile__app_set_id_scope,\nos_timezone,\nscreen_resolution,\nyauaa__device_class,\nyauaa__device_version,\nyauaa__operating_system_version,\nyauaa__operating_system_class,\nyauaa__operating_system_name,\nyauaa__operating_system_name_version,\ngeo_country,\ngeo_region,\ngeo_region_name,\ngeo_city,\ngeo_zipcode,\ngeo_latitude,\ngeo_longitude,\ngeo_timezone,\nuser_ipaddress,\nengaged_time_in_s,\nabsolute_time_in_s,\nhorizontal_pixels_scrolled,\nvertical_pixels_scrolled,\nhorizontal_percentage_scrolled,\nvertical_percentage_scrolled,\nmkt_medium,\nmkt_source,\nmkt_term,\nmkt_content,\nmkt_campaign,\nmkt_clickid,\nmkt_network,\ndefault_channel_group,\npage_url,\npage_referrer,\nrefr_medium,\nrefr_source,\nrefr_term,\npage_title,\ncontent_group,\npage_urlscheme,\npage_urlhost,\npage_urlpath,\npage_urlquery,\npage_urlfragment,\nrefr_urlscheme,\nrefr_urlhost,\nrefr_urlpath,\nrefr_urlquery,\nrefr_urlfragment,\nbr_lang,\nbr_viewwidth,\nbr_viewheight,\nbr_colordepth,\nbr_renderengine,\ndoc_width,\ndoc_height,\niab__category,\niab__primary_impact,\niab__reason,\niab__spider_or_robot,\nyauaa__device_name,\nyauaa__agent_class,\nyauaa__device_brand,\nyauaa__agent_name,\nyauaa__agent_name_version,\nyauaa__agent_name_version_major,\nyauaa__agent_version,\nyauaa__agent_version_major,\nyauaa__layout_engine_class,\nyauaa__layout_engine_name,\nyauaa__layout_engine_name_version,\nyauaa__layout_engine_name_version_major,\nyauaa__layout_engine_version,\nyauaa__layout_engine_version_major,\nua__device_family,\nua__os_family,\nua__os_version,\nua__os_major,\nua__os_minor,\nua__os_patch,\nua__os_patch_minor,\nua__useragent_family,\nua__useragent_major,\nua__useragent_minor,\nua__useragent_patch,\nua__useragent_version,\nscreen_view__name,\nscreen_view__previous_id,\nscreen_view__previous_name,\nscreen_view__previous_type,\nscreen_view__transition_type,\nscreen_view__type,\napp__build,\napp__version,\ngeo__altitude,\ngeo__altitude_accuracy,\ngeo__bearing,\ngeo__latitude,\ngeo__latitude_longitude_accuracy,\ngeo__longitude,\ngeo__speed,\nscreen__fragment,\ncast(screen__top_view_controller as TEXT) as screen__top_view_controller,\ncast(screen__view_controller as TEXT) as screen__view_controller,\nuseragent,\nv_collector,\nevent_id2,\nagg_test\n\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_views_expected", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_views_expected_stg", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.780203Z", "completed_at": "2026-01-20T14:49:09.787090Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.788972Z", "completed_at": "2026-01-20T14:49:09.788983Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.013575553894042969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified_integration_tests.snowplow_unified_views_mobile_screen_engagement_expected_stg", "compiled": true, "compiled_code": "\n\n\n\nselect\n    view_id,\n    session_identifier,\n    user_identifier,\n    engaged_time_in_s,\n    \n    absolute_time_in_s,\n    \n    horizontal_pixels_scrolled,\n    vertical_pixels_scrolled,\n    horizontal_percentage_scrolled,\n    vertical_percentage_scrolled,\n    last_list_item_index,\n    list_items_count,\n    list_items_percentage_scrolled\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_views_mobile_screen_engagement_expected", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_views_mobile_screen_engagement_expected_stg", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.790596Z", "completed_at": "2026-01-20T14:49:09.805845Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.807292Z", "completed_at": "2026-01-20T14:49:09.807304Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.020938396453857422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified_integration_tests.snowplow_unified_events_stg", "compiled": true, "compiled_code": "\n\n\n\n\n  -- page view context is given as json string in csv. Parse json\n\n    with prep as (\n      select\n      *,\n      parse_json(contexts_com_snowplowanalytics_snowplow_web_page_1_0_0) as contexts_com_snowplowanalytics_snowplow_web_page_1,\n      parse_json(unstruct_event_com_snowplowanalytics_snowplow_web_vitals_1_0_0) as unstruct_event_com_snowplowanalytics_snowplow_web_vitals_1,\n      parse_json(contexts_nl_basjes_yauaa_context_1_0_0) as contexts_nl_basjes_yauaa_context_1,\n      parse_json(contexts_com_iab_snowplow_spiders_and_robots_1_0_0) as contexts_com_iab_snowplow_spiders_and_robots_1\n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_web_vital_events\n\n    )\n\n    , flatten as (\n    select\n      *,\n      unstruct_event_com_snowplowanalytics_snowplow_web_vitals_1[0].lcp as lcp,\n      unstruct_event_com_snowplowanalytics_snowplow_web_vitals_1[0].fcp as fcp,\n      unstruct_event_com_snowplowanalytics_snowplow_web_vitals_1[0].fid as fid,\n      unstruct_event_com_snowplowanalytics_snowplow_web_vitals_1[0].cls as cls,\n      unstruct_event_com_snowplowanalytics_snowplow_web_vitals_1[0].inp as inp,\n      unstruct_event_com_snowplowanalytics_snowplow_web_vitals_1[0].ttfb as ttfb,\n      unstruct_event_com_snowplowanalytics_snowplow_web_vitals_1[0].navigation_type as navigationType,\n      contexts_nl_basjes_yauaa_context_1[0].device_class as deviceClass,\n      contexts_nl_basjes_yauaa_context_1[0].agent_class as agentClass,\n      contexts_nl_basjes_yauaa_context_1[0].agent_name as agentName,\n      contexts_nl_basjes_yauaa_context_1[0].agent_name_version as agentNameVersion,\n      contexts_nl_basjes_yauaa_context_1[0].agent_name_version_major as agentNameVersionMajor,\n      contexts_nl_basjes_yauaa_context_1[0].agent_version as agentVersion,\n      contexts_nl_basjes_yauaa_context_1[0].agent_version_major as agentVersionMajor,\n      contexts_nl_basjes_yauaa_context_1[0].device_brand as deviceBrand,\n      contexts_nl_basjes_yauaa_context_1[0].device_name as deviceName,\n      contexts_nl_basjes_yauaa_context_1[0].device_version as deviceVersion,\n      contexts_nl_basjes_yauaa_context_1[0].layout_engine_class as layoutEngineClass,\n      contexts_nl_basjes_yauaa_context_1[0].layout_engine_name as layoutEngineName,\n      contexts_nl_basjes_yauaa_context_1[0].layout_engine_name_version as layoutEngineNameVersion,\n      contexts_nl_basjes_yauaa_context_1[0].layout_engine_name_version_major as layoutEngineNameVersionMajor,\n      contexts_nl_basjes_yauaa_context_1[0].layout_engine_version as layoutEngineVersion,\n      contexts_nl_basjes_yauaa_context_1[0].layout_engine_version_major as layoutEngineVersionMajor,\n      contexts_nl_basjes_yauaa_context_1[0].operating_system_class as operatingSystemClass,\n      contexts_nl_basjes_yauaa_context_1[0].operating_system_name as operatingSystemName,\n      contexts_nl_basjes_yauaa_context_1[0].operating_system_name_version as operatingSystemNameVersion,\n      contexts_nl_basjes_yauaa_context_1[0].operating_system_version as operatingSystemVersion,\n      contexts_com_iab_snowplow_spiders_and_robots_1[0].category as category,\n      contexts_com_iab_snowplow_spiders_and_robots_1[0].primary_impact as primaryImpact,\n      contexts_com_iab_snowplow_spiders_and_robots_1[0].reason as reason,\n      contexts_com_iab_snowplow_spiders_and_robots_1[0].spider_or_robot as spiderOrRobot\n\n    from prep\n\n  )\n\n  select\n    app_id,\n    platform,\n    etl_tstamp,\n    collector_tstamp,\n    dvce_created_tstamp,\n    event,\n    event_id,\n    txn_id,\n    name_tracker,\n    v_tracker,\n    v_collector,\n    v_etl,\n    user_id,\n    user_ipaddress,\n    user_fingerprint,\n    domain_userid,\n    domain_sessionidx,\n    network_userid,\n    geo_country,\n    geo_region,\n    geo_city,\n    geo_zipcode,\n    geo_latitude,\n    geo_longitude,\n    geo_region_name,\n    ip_isp,\n    ip_organization,\n    ip_domain,\n    ip_netspeed,\n    page_url,\n    page_title,\n    page_referrer,\n    page_urlscheme,\n    page_urlhost,\n    page_urlport,\n    page_urlpath,\n    page_urlquery,\n    page_urlfragment,\n    refr_urlscheme,\n    refr_urlhost,\n    refr_urlport,\n    refr_urlpath,\n    refr_urlquery,\n    refr_urlfragment,\n    refr_medium,\n    refr_source,\n    refr_term,\n    mkt_medium,\n    mkt_source,\n    mkt_term,\n    mkt_content,\n    mkt_campaign,\n    se_category,\n    se_action,\n    se_label,\n    se_property,\n    se_value,\n    tr_orderid,\n    tr_affiliation,\n    tr_total,\n    tr_tax,\n    tr_shipping,\n    tr_city,\n    tr_state,\n    tr_country,\n    ti_orderid,\n    ti_sku,\n    ti_name,\n    ti_category,\n    ti_price,\n    ti_quantity,\n    pp_xoffset_min,\n    pp_xoffset_max,\n    pp_yoffset_min,\n    pp_yoffset_max,\n    useragent,\n    br_name,\n    br_family,\n    br_version,\n    br_type,\n    br_renderengine,\n    br_lang,\n    br_features_pdf,\n    br_features_flash,\n    br_features_java,\n    br_features_director,\n    br_features_quicktime,\n    br_features_realplayer,\n    br_features_windowsmedia,\n    br_features_gears,\n    br_features_silverlight,\n    br_cookies,\n    br_colordepth,\n    br_viewwidth,\n    br_viewheight,\n    os_name,\n    os_family,\n    os_manufacturer,\n    os_timezone,\n    dvce_type,\n    dvce_ismobile,\n    dvce_screenwidth,\n    dvce_screenheight,\n    doc_charset,\n    doc_width,\n    doc_height,\n    tr_currency,\n    tr_total_base,\n    tr_tax_base,\n    tr_shipping_base,\n    ti_currency,\n    ti_price_base,\n    base_currency,\n    geo_timezone,\n    mkt_clickid,\n    mkt_network,\n    etl_tags,\n    dvce_sent_tstamp,\n    refr_domain_userid,\n    refr_dvce_tstamp,\n    domain_sessionid,\n    derived_tstamp,\n    event_vendor,\n    event_name,\n    event_format,\n    event_version,\n    event_fingerprint,\n    true_tstamp,\n    load_tstamp,\n    contexts_com_snowplowanalytics_snowplow_web_page_1,\n    object_construct('cls', cls, 'fcp', fcp, 'fid', fid, 'inp', inp, 'lcp', lcp, 'navigationType', navigationType, 'ttfb', ttfb) as unstruct_event_com_snowplowanalytics_snowplow_web_vitals_1,\n    parse_json('[{\"deviceClass\":\"'||deviceClass||'\", \"agentClass\":\"'||agentClass||'\", \"agentName\":\"'||agentName||'\", \"agentNameVersion\":\"'||agentNameVersion||'\", \"agentNameVersionMajor\":\"'||agentNameVersionMajor||'\", \"agentVersion\":\"'||agentVersion||'\", \"agentVersionMajor\":\"'||agentVersionMajor||'\", \"deviceBrand\":\"'||deviceBrand||'\", \"deviceName\":\"'||deviceName||'\", \"deviceVersion\":\"'||deviceVersion||'\", \"layoutEngineClass\":\"'||layoutEngineClass||'\", \"layoutEngineName\":\"'||layoutEngineName||'\", \"layoutEngineNameVersion\":\"'||layoutEngineNameVersion||'\", \"layoutEngineNameVersionMajor\":\"'||layoutEngineNameVersionMajor||'\", \"layoutEngineVersion\":\"'||layoutEngineVersion||'\", \"layoutEngineVersionMajor\":\"'||layoutEngineVersionMajor||'\", \"operatingSystemClass\":\"'||operatingSystemClass||'\", \"operatingSystemName\":\"'||operatingSystemName||'\", \"operatingSystemNameVersion\":\"'||operatingSystemNameVersion||'\", \"operatingSystemVersion\":\"'||operatingSystemVersion||'\"}]') as contexts_nl_basjes_yauaa_context_1,\n    parse_json('[{\"category\":\"'||category||'\", \"primaryImpact\":\"'||primaryImpact||'\", \"reason\":\"'||reason||'\", \"spiderOrRobot\":\"'||spiderOrRobot||'\"}]') as contexts_com_iab_snowplow_spiders_and_robots_1\n\nfrom flatten\n\n", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_events_stg", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.800496Z", "completed_at": "2026-01-20T14:49:09.808178Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.815788Z", "completed_at": "2026-01-20T14:49:09.815800Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02816176414489746, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified_integration_tests.snowplow_unified_web_vital_measurements_expected_stg", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n  compound_key,\n  measurement_type,\n  page_url,\n  device_class,\n  geo_country,\n  country,\n  time_period,\n  view_count,\n  lcp_75p,\n  fid_75p,\n  cls_75p,\n  ttfb_75p,\n  inp_75p,\n  lcp_result,\n  fid_result,\n  cls_result,\n  ttfb_result,\n  inp_result,\n  passed\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_web_vital_measurements_expected", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_web_vital_measurements_expected_stg", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.808818Z", "completed_at": "2026-01-20T14:49:09.818170Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.820573Z", "completed_at": "2026-01-20T14:49:09.820585Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.015631914138793945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified_integration_tests.dbt_utils_equal_rowcount_snowplow_unified_base_quarantined_sessions_actual_ref_snowplow_unified_base_quarantined_sessions_expected_stg_.541911e8f1", "compiled": true, "compiled_code": "\n\n\n\n\nwith a as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_a \n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_base_quarantined_sessions_actual\n    group by id_dbtutils_test_equal_rowcount\n\n\n),\nb as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_b \n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_base_quarantined_sessions_expected_stg\n    group by id_dbtutils_test_equal_rowcount\n\n),\nfinal as (\n\n    select\n    \n        a.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_a,\n          b.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_b,\n        \n\n        count_a,\n        count_b,\n        abs(count_a - count_b) as diff_count\n\n    from a\n    full join b\n    on\n    a.id_dbtutils_test_equal_rowcount = b.id_dbtutils_test_equal_rowcount\n    \n\n\n)\n\nselect * from final\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.616741Z", "completed_at": "2026-01-20T14:49:09.857932Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:09.858643Z", "completed_at": "2026-01-20T14:49:09.858655Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.26551079750061035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_base_new_event_limits", "compiled": true, "compiled_code": "\n\n\n      select \n        cast('2020-07-03' as timestamp)\n     as lower_limit,\n              least(\n        cast('2021-03-02 23:57:07.557000' as timestamp)\n    ,\n              \n\n    dateadd(\n        day,\n        2,\n        \n        cast('2020-07-03' as timestamp)\n    \n        )\n\n) as upper_limit\n    ", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_base_new_event_limits", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.830980Z", "completed_at": "2026-01-20T14:49:10.254569Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:10.255161Z", "completed_at": "2026-01-20T14:49:10.255171Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.43831920623779297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified_integration_tests.dbt_utils_equality_snowplow_unified_base_quarantined_sessions_actual_ref_snowplow_unified_base_quarantined_sessions_expected_stg_.b675df62df", "compiled": true, "compiled_code": "\n\n\n\n-- setup\n\n\n\n\n\n\nwith a as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_base_quarantined_sessions_actual\n\n),\n\nb as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_base_quarantined_sessions_expected_stg\n\n),\n\na_minus_b as (\n\n    select  from a\n    \n\n    except\n\n\n    select  from b\n\n),\n\nb_minus_a as (\n\n    select  from b\n    \n\n    except\n\n\n    select  from a\n\n),\n\nunioned as (\n\n    select 'a_minus_b' as which_diff, a_minus_b.* from a_minus_b\n    union all\n    select 'b_minus_a' as which_diff, b_minus_a.* from b_minus_a\n\n)\n\nselect * from unioned\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:09.861677Z", "completed_at": "2026-01-20T14:49:10.366691Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:10.367311Z", "completed_at": "2026-01-20T14:49:10.367321Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5069668292999268, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_base_sessions_lifecycle_manifest", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n        with new_events_session_ids_init as (\n            select\n            \n                COALESCE(\n                    \ne.contexts_com_snowplowanalytics_snowplow_client_session_1[0]:sessionId::TEXT\n,e.domain_sessionid,NULL\n                ) as session_identifier,\n                max(\n                    COALESCE(\n                        \ne.contexts_com_snowplowanalytics_snowplow_client_session_1[0]:userId::TEXT\n,e.domain_userid,NULL\n                    )\n                ) as user_identifier, -- Edge case 1: Arbitary selection to avoid window function like first_value.\n            \n                min(collector_tstamp) as start_tstamp,\n                max(collector_tstamp) as end_tstamp\n\n            from SNOWPLOW_DEV1.snowflake_snplw_unified_int_tests.snowplow_unified_events_stg e\n\n            where\n            \n                coalesce(dvce_sent_tstamp, collector_tstamp) <= \n\n    dateadd(\n        day,\n        3,\n        coalesce(dvce_created_tstamp, collector_tstamp)\n        )\n\n\n             -- don't process data that's too late\n                and collector_tstamp >= \n        cast('2020-07-03 00:00:00' as timestamp)\n    \n                and collector_tstamp <= \n        cast('2021-03-03 00:00:00' as timestamp)\n    \n                and (1=1)\n                and cast(True as boolean) --don't reprocess sessions that have already been processed.\n                \n\n            group by 1\n        ), new_events_session_ids as (\n            select *\n            from new_events_session_ids_init e\n            \n                where session_identifier is not null\n                and not exists (select 1 from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snowplow_manifest.snowplow_unified_base_quarantined_sessions as a where a.session_identifier = e.session_identifier) -- don't continue processing v.long sessions\n\n        )\n        \n\n        , previous_sessions as (\n        select *\n\n        from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snowplow_manifest.snowplow_unified_base_sessions_lifecycle_manifest\n\n        where start_tstamp >= \n        cast('2018-07-04 00:00:00' as timestamp)\n    \n        and cast(True as boolean) --don't reprocess sessions that have already been processed.\n        )\n\n        , session_lifecycle as (\n        select\n            ns.session_identifier,\n            coalesce(self.user_identifier, ns.user_identifier) as user_identifier, -- Edge case 1: Take previous value to keep domain_userid consistent. Not deterministic but performant\n            least(ns.start_tstamp, coalesce(self.start_tstamp, ns.start_tstamp)) as start_tstamp,\n            greatest(ns.end_tstamp, coalesce(self.end_tstamp, ns.end_tstamp)) as end_tstamp -- BQ 1 NULL will return null hence coalesce\n\n        from new_events_session_ids ns\n        left join previous_sessions as self\n            on ns.session_identifier = self.session_identifier\n\n        where\n            self.session_identifier is null -- process all new sessions\n            or self.end_tstamp < \n\n    dateadd(\n        day,\n        3,\n        self.start_tstamp\n        )\n\n --stop updating sessions exceeding 3 days\n        )\n\n        \n\n        select\n        sl.session_identifier,\n        sl.user_identifier,\n        sl.start_tstamp,\n        least(\n\n    dateadd(\n        day,\n        3,\n        sl.start_tstamp\n        )\n\n, sl.end_tstamp) as end_tstamp -- limit session length to max_session_days\n        \n\n        from session_lifecycle sl\n    ", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snowplow_manifest.snowplow_unified_base_sessions_lifecycle_manifest", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:10.383054Z", "completed_at": "2026-01-20T14:49:10.403260Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:10.404572Z", "completed_at": "2026-01-20T14:49:10.404584Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.03251957893371582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_base_sessions_lifecycle_manifest_end_tstamp.68530988e8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect end_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snowplow_manifest.snowplow_unified_base_sessions_lifecycle_manifest\nwhere end_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:10.389391Z", "completed_at": "2026-01-20T14:49:10.403953Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:10.406210Z", "completed_at": "2026-01-20T14:49:10.406221Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03341817855834961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_base_sessions_lifecycle_manifest_session_identifier.b6a553df4c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_identifier\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snowplow_manifest.snowplow_unified_base_sessions_lifecycle_manifest\nwhere session_identifier is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:10.395538Z", "completed_at": "2026-01-20T14:49:10.405521Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:10.407895Z", "completed_at": "2026-01-20T14:49:10.407906Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03382444381713867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_base_sessions_lifecycle_manifest_start_tstamp.78e6f715a9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect start_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snowplow_manifest.snowplow_unified_base_sessions_lifecycle_manifest\nwhere start_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:10.410300Z", "completed_at": "2026-01-20T14:49:10.415799Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:10.416383Z", "completed_at": "2026-01-20T14:49:10.416393Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.007566213607788086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_base_sessions_lifecycle_manifest_session_identifier.55eb56faed", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    session_identifier as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snowplow_manifest.snowplow_unified_base_sessions_lifecycle_manifest\nwhere session_identifier is not null\ngroup by session_identifier\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:10.376070Z", "completed_at": "2026-01-20T14:49:10.506371Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:10.507002Z", "completed_at": "2026-01-20T14:49:10.507011Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.13643527030944824, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_base_sessions_this_run", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\n\n        select\n        s.session_identifier,\n        s.user_identifier,\n        s.start_tstamp,\n        -- end_tstamp used in next step to limit events. When backfilling, set end_tstamp to upper_limit if end_tstamp > upper_limit.\n        -- This ensures we don't accidentally process events after upper_limit\n        case when s.end_tstamp > \n        cast('2021-03-03 00:00:00' as timestamp)\n     then \n        cast('2021-03-03 00:00:00' as timestamp)\n     else s.end_tstamp end as end_tstamp\n\n        from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snowplow_manifest.snowplow_unified_base_sessions_lifecycle_manifest s\n\n        where\n        -- General window of start_tstamps to limit table scans. Logic complicated by backfills.\n        -- To be within the run, session start_tstamp must be >= lower_limit - max_session_days as we limit end_tstamp in manifest to start_tstamp + max_session_days\n        s.start_tstamp >= \n        cast('2020-06-30 00:00:00' as timestamp)\n    \n        and s.start_tstamp <= \n        cast('2021-03-03 00:00:00' as timestamp)\n    \n        -- Select sessions within window that either; start or finish between lower & upper limit, start and finish outside of lower and upper limits\n        and not (s.start_tstamp > \n        cast('2021-03-03 00:00:00' as timestamp)\n     or s.end_tstamp < \n        cast('2020-07-03 00:00:00' as timestamp)\n    )\n    ", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_base_sessions_this_run", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:10.533969Z", "completed_at": "2026-01-20T14:49:10.678294Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:10.678989Z", "completed_at": "2026-01-20T14:49:10.679005Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.16807770729064941, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_base_sessions_this_run_session_identifier.15278d0f20", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_identifier\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_base_sessions_this_run\nwhere session_identifier is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:10.539826Z", "completed_at": "2026-01-20T14:49:10.680109Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:10.680880Z", "completed_at": "2026-01-20T14:49:10.680892Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.16869258880615234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_base_sessions_this_run_session_identifier.4db28e3b1d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    session_identifier as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_base_sessions_this_run\nwhere session_identifier is not null\ngroup by session_identifier\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:10.513548Z", "completed_at": "2026-01-20T14:49:10.792172Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:10.792798Z", "completed_at": "2026-01-20T14:49:10.792808Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.28318285942077637, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_base_events_this_run", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\n  \n\n  \n  \n  \n    \n  \n  \n    \n  \n\n  \n  \n\n  \n  \n  \n  \n  \n  \n  \n\n\n\nwith base_query as (\n  \n        with identified_events AS (\n            select\n                COALESCE(\n                        \ne.contexts_com_snowplowanalytics_snowplow_client_session_1[0]:sessionId::TEXT\n,e.domain_sessionid,NULL\n                    ) as session_identifier,\n                e.*\n\n            from SNOWPLOW_DEV1.snowflake_snplw_unified_int_tests.snowplow_unified_events_stg e\n\n        )\n\n        select\n            a.*\n            ,b.user_identifier -- take user_identifier from manifest. This ensures only 1 domain_userid per session.\n            \n\n        from identified_events as a\n        inner join SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_base_sessions_this_run as b\n        on a.session_identifier = b.session_identifier\n\n        where a.collector_tstamp <= \n\n    dateadd(\n        day,\n        3,\n        b.start_tstamp\n        )\n\n\n        \n        \n            and coalesce(a.dvce_sent_tstamp, a.collector_tstamp) <= \n\n    dateadd(\n        day,\n        3,\n        coalesce(a.dvce_created_tstamp, a.collector_tstamp)\n        )\n\n\n        \n        \n        and a.collector_tstamp >= \n        cast('2020-07-03 15:55:18.542000' as timestamp)\n    \n        and a.collector_tstamp <= \n        cast('2021-03-02 23:57:07.557000' as timestamp)\n    \n        and a.collector_tstamp >= b.start_tstamp -- deal with late loading events\n\n        \n\n        and (1=1)\n\n        qualify row_number() over (partition by a.event_id order by a.collector_tstamp, a.dvce_created_tstamp) = 1\n    \n),\n\n\n\nbase_query_2 AS (\nselect\n  \n  *-- extract commonly used contexts / sdes (prefixed)\n  \n    \n      , contexts_com_snowplowanalytics_snowplow_web_page_1[0]:id::varchar as page_view__id\n    \n\n  \n    \n      , contexts_com_iab_snowplow_spiders_and_robots_1[0]:category::VARCHAR as iab__category\n      , contexts_com_iab_snowplow_spiders_and_robots_1[0]:primaryImpact::VARCHAR as iab__primary_impact\n      , contexts_com_iab_snowplow_spiders_and_robots_1[0]:reason::VARCHAR as iab__reason\n      , contexts_com_iab_snowplow_spiders_and_robots_1[0]:spiderOrRobot::BOOLEAN as iab__spider_or_robot\n    \n  \n    , contexts_com_snowplowanalytics_snowplow_ua_parser_context_1[0]:useragentFamily::VARCHAR as ua__useragent_family\n    , contexts_com_snowplowanalytics_snowplow_ua_parser_context_1[0]:useragentMajor::VARCHAR as ua__useragent_major\n    , contexts_com_snowplowanalytics_snowplow_ua_parser_context_1[0]:useragentMinor::VARCHAR as ua__useragent_minor\n    , contexts_com_snowplowanalytics_snowplow_ua_parser_context_1[0]:useragentPatch::VARCHAR as ua__useragent_patch\n    , contexts_com_snowplowanalytics_snowplow_ua_parser_context_1[0]:useragentVersion::VARCHAR as ua__useragent_version\n    , contexts_com_snowplowanalytics_snowplow_ua_parser_context_1[0]:osFamily::VARCHAR as ua__os_family\n    , contexts_com_snowplowanalytics_snowplow_ua_parser_context_1[0]:osMajor::VARCHAR as ua__os_major\n    , contexts_com_snowplowanalytics_snowplow_ua_parser_context_1[0]:osMinor::VARCHAR as ua__os_minor\n    , contexts_com_snowplowanalytics_snowplow_ua_parser_context_1[0]:osPatch::VARCHAR as ua__os_patch\n    , contexts_com_snowplowanalytics_snowplow_ua_parser_context_1[0]:osPatchMinor::VARCHAR as ua__os_patch_minor\n    , contexts_com_snowplowanalytics_snowplow_ua_parser_context_1[0]:osVersion::VARCHAR as ua__os_version\n    , contexts_com_snowplowanalytics_snowplow_ua_parser_context_1[0]:deviceFamily::VARCHAR as ua__device_family\n  \n\n  \n    , contexts_nl_basjes_yauaa_context_1[0]:deviceClass::VARCHAR as yauaa__device_class\n    , contexts_nl_basjes_yauaa_context_1[0]:agentClass::VARCHAR as yauaa__agent_class\n    , contexts_nl_basjes_yauaa_context_1[0]:agentName::VARCHAR as yauaa__agent_name\n    , contexts_nl_basjes_yauaa_context_1[0]:agentNameVersion::VARCHAR as yauaa__agent_name_version\n    , contexts_nl_basjes_yauaa_context_1[0]:agentNameVersionMajor::VARCHAR as yauaa__agent_name_version_major\n    , contexts_nl_basjes_yauaa_context_1[0]:agentVersion::VARCHAR as yauaa__agent_version\n    , contexts_nl_basjes_yauaa_context_1[0]:agentVersionMajor::VARCHAR as yauaa__agent_version_major\n    , contexts_nl_basjes_yauaa_context_1[0]:deviceBrand::VARCHAR as yauaa__device_brand\n    , contexts_nl_basjes_yauaa_context_1[0]:deviceName::VARCHAR as yauaa__device_name\n    , contexts_nl_basjes_yauaa_context_1[0]:deviceVersion::VARCHAR as yauaa__device_version\n    , contexts_nl_basjes_yauaa_context_1[0]:layoutEngineClass::VARCHAR as yauaa__layout_engine_class\n    , contexts_nl_basjes_yauaa_context_1[0]:layoutEngineName::VARCHAR as yauaa__layout_engine_name\n    , contexts_nl_basjes_yauaa_context_1[0]:layoutEngineNameVersion::VARCHAR as yauaa__layout_engine_name_version\n    , contexts_nl_basjes_yauaa_context_1[0]:layoutEngineNameVersionMajor::VARCHAR as yauaa__layout_engine_name_version_major\n    , contexts_nl_basjes_yauaa_context_1[0]:layoutEngineVersion::VARCHAR as yauaa__layout_engine_version\n    , contexts_nl_basjes_yauaa_context_1[0]:layoutEngineVersionMajor::VARCHAR as yauaa__layout_engine_version_major\n    , contexts_nl_basjes_yauaa_context_1[0]:operatingSystemClass::VARCHAR as yauaa__operating_system_class\n    , contexts_nl_basjes_yauaa_context_1[0]:operatingSystemName::VARCHAR as yauaa__operating_system_name\n    , contexts_nl_basjes_yauaa_context_1[0]:operatingSystemNameVersion::VARCHAR as yauaa__operating_system_name_version\n    , contexts_nl_basjes_yauaa_context_1[0]:operatingSystemVersion::VARCHAR as yauaa__operating_system_version\n  \n  \n  \n    \n      , contexts_com_snowplowanalytics_snowplow_browser_context_1[0]:viewport::varchar AS browser__viewport\n      , contexts_com_snowplowanalytics_snowplow_browser_context_1[0]:documentSize::varchar AS browser__document_size\n      , contexts_com_snowplowanalytics_snowplow_browser_context_1[0]:resolution::varchar AS browser__resolution\n      , contexts_com_snowplowanalytics_snowplow_browser_context_1[0]:colorDepth::int AS browser__color_depth\n      , contexts_com_snowplowanalytics_snowplow_browser_context_1[0]:devicePixelRatio::float AS browser__device_pixel_ratio\n      , contexts_com_snowplowanalytics_snowplow_browser_context_1[0]:cookiesEnabled::boolean AS browser__cookies_enabled\n      , contexts_com_snowplowanalytics_snowplow_browser_context_1[0]:online::boolean AS browser__online\n      , contexts_com_snowplowanalytics_snowplow_browser_context_1[0]:browserLanguage::varchar AS browser__browser_language\n      , contexts_com_snowplowanalytics_snowplow_browser_context_1[0]:documentLanguage::varchar AS browser__document_language\n      , contexts_com_snowplowanalytics_snowplow_browser_context_1[0]:webdriver::boolean AS browser__webdriver\n      , contexts_com_snowplowanalytics_snowplow_browser_context_1[0]:deviceMemory::int AS browser__device_memory\n      , contexts_com_snowplowanalytics_snowplow_browser_context_1[0]:hardwareConcurrency::int AS browser__hardware_concurrency\n      , contexts_com_snowplowanalytics_snowplow_browser_context_1[0]:tabId::varchar AS browser__tab_id\n    \n  \n\n  \n  \n    \n      , unstruct_event_com_snowplowanalytics_mobile_screen_view_1:id::varchar(36) AS screen_view__id\n      , unstruct_event_com_snowplowanalytics_mobile_screen_view_1:name::varchar AS screen_view__name\n      , unstruct_event_com_snowplowanalytics_mobile_screen_view_1:previousId::varchar(36) AS screen_view__previous_id\n      , unstruct_event_com_snowplowanalytics_mobile_screen_view_1:previousName::varchar AS screen_view__previous_name\n      , unstruct_event_com_snowplowanalytics_mobile_screen_view_1:previousType::varchar AS screen_view__previous_type\n      , unstruct_event_com_snowplowanalytics_mobile_screen_view_1:transitionType::varchar AS screen_view__transition_type\n      , unstruct_event_com_snowplowanalytics_mobile_screen_view_1:type::varchar AS screen_view__type\n    \n    \n\n  \n  \n    \n      , contexts_com_snowplowanalytics_snowplow_client_session_1[0]:sessionId::varchar(36) AS session__session_id\n      , contexts_com_snowplowanalytics_snowplow_client_session_1[0]:sessionIndex::int AS session__session_index\n      , contexts_com_snowplowanalytics_snowplow_client_session_1[0]:previousSessionId::varchar(36) AS session__previous_session_id\n      , contexts_com_snowplowanalytics_snowplow_client_session_1[0]:userId::varchar(36) AS session__user_id\n      , contexts_com_snowplowanalytics_snowplow_client_session_1[0]:firstEventId::varchar(36) AS session__first_event_id\n      , contexts_com_snowplowanalytics_snowplow_client_session_1[0]:eventIndex::int AS session__event_index\n      , contexts_com_snowplowanalytics_snowplow_client_session_1[0]:storageMechanism::varchar(36) AS session__storage_mechanism\n      , contexts_com_snowplowanalytics_snowplow_client_session_1[0]:firstEventTimestamp::varchar(36) AS session__first_event_timestamp\n    \n  \n\n  \n  \n    \n      , contexts_com_snowplowanalytics_snowplow_mobile_context_1[0]:deviceManufacturer::varchar AS mobile__device_manufacturer\n      , contexts_com_snowplowanalytics_snowplow_mobile_context_1[0]:deviceModel::varchar AS mobile__device_model\n      , contexts_com_snowplowanalytics_snowplow_mobile_context_1[0]:osType::varchar AS mobile__os_type\n      , contexts_com_snowplowanalytics_snowplow_mobile_context_1[0]:osVersion::varchar AS mobile__os_version\n      , contexts_com_snowplowanalytics_snowplow_mobile_context_1[0]:androidIdfa::varchar AS mobile__android_idfa\n      , contexts_com_snowplowanalytics_snowplow_mobile_context_1[0]:appleIdfa::varchar AS mobile__apple_idfa\n      , contexts_com_snowplowanalytics_snowplow_mobile_context_1[0]:appleIdfv::varchar AS mobile__apple_idfv\n      , contexts_com_snowplowanalytics_snowplow_mobile_context_1[0]:carrier::varchar AS mobile__carrier\n      , contexts_com_snowplowanalytics_snowplow_mobile_context_1[0]:openIdfa::varchar AS mobile__open_idfa\n      , contexts_com_snowplowanalytics_snowplow_mobile_context_1[0]:networkTechnology::varchar AS mobile__network_technology\n      , contexts_com_snowplowanalytics_snowplow_mobile_context_1[0]:networkType::varchar(255) AS mobile__network_type\n      , contexts_com_snowplowanalytics_snowplow_mobile_context_1[0]:physicalMemory::int AS mobile__physical_memory\n      , contexts_com_snowplowanalytics_snowplow_mobile_context_1[0]:systemAvailableMemory::int AS mobile__system_available_memory\n      , contexts_com_snowplowanalytics_snowplow_mobile_context_1[0]:appAvailableMemory::int AS mobile__app_available_memory\n      , contexts_com_snowplowanalytics_snowplow_mobile_context_1[0]:batteryLevel::int AS mobile__battery_level\n      , contexts_com_snowplowanalytics_snowplow_mobile_context_1[0]:batteryState::varchar AS mobile__battery_state\n      , contexts_com_snowplowanalytics_snowplow_mobile_context_1[0]:lowPowerMode::boolean AS mobile__low_power_mode\n      , contexts_com_snowplowanalytics_snowplow_mobile_context_1[0]:availableStorage::int AS mobile__available_storage\n      , contexts_com_snowplowanalytics_snowplow_mobile_context_1[0]:totalStorage::int AS mobile__total_storage\n      , contexts_com_snowplowanalytics_snowplow_mobile_context_1[0]:isPortrait::boolean AS mobile__is_portrait\n      , contexts_com_snowplowanalytics_snowplow_mobile_context_1[0]:resolution::varchar AS mobile__resolution\n      , contexts_com_snowplowanalytics_snowplow_mobile_context_1[0]:scale::float AS mobile__scale\n      , contexts_com_snowplowanalytics_snowplow_mobile_context_1[0]:language::varchar AS mobile__language\n      , contexts_com_snowplowanalytics_snowplow_mobile_context_1[0]:appSetId::varchar AS mobile__app_set_id\n      , contexts_com_snowplowanalytics_snowplow_mobile_context_1[0]:appSetIdScope::varchar AS mobile__app_set_id_scope\n    \n  \n\n  \n  \n    \n      , contexts_com_snowplowanalytics_snowplow_geolocation_context_1[0]:latitude::float AS geo__latitude\n      , contexts_com_snowplowanalytics_snowplow_geolocation_context_1[0]:longitude::float AS geo__longitude\n      , contexts_com_snowplowanalytics_snowplow_geolocation_context_1[0]:latitudeLongitudeAccuracy::float AS geo__latitude_longitude_accuracy\n      , contexts_com_snowplowanalytics_snowplow_geolocation_context_1[0]:altitude::float AS geo__altitude\n      , contexts_com_snowplowanalytics_snowplow_geolocation_context_1[0]:altitudeAccuracy::float AS geo__altitude_accuracy\n      , contexts_com_snowplowanalytics_snowplow_geolocation_context_1[0]:bearing::float AS geo__bearing\n      , contexts_com_snowplowanalytics_snowplow_geolocation_context_1[0]:speed::float AS geo__speed\n    \n  \n\n  \n    \n      , contexts_com_snowplowanalytics_mobile_application_1[0]:build::varchar(255) AS app__build\n      , contexts_com_snowplowanalytics_mobile_application_1[0]:version::varchar(255) AS app__version\n    \n\n  \n  \n    \n      , contexts_com_snowplowanalytics_mobile_screen_1[0]:id::varchar(36) AS screen__id\n      , contexts_com_snowplowanalytics_mobile_screen_1[0]:name::varchar AS screen__name\n      , contexts_com_snowplowanalytics_mobile_screen_1[0]:activity::varchar AS screen__activity\n      , contexts_com_snowplowanalytics_mobile_screen_1[0]:fragment::varchar AS screen__fragment\n      , contexts_com_snowplowanalytics_mobile_screen_1[0]:topViewController::varchar AS screen__top_view_controller\n      , contexts_com_snowplowanalytics_mobile_screen_1[0]:type::varchar AS screen__type\n      , contexts_com_snowplowanalytics_mobile_screen_1[0]:viewController::varchar AS screen__view_controller\n    \n  \n\n  \n  \n    , contexts_com_snowplowanalytics_mobile_deep_link_1[0]:url::varchar AS deep_link__url\n    , contexts_com_snowplowanalytics_mobile_deep_link_1[0]:referrer::varchar AS deep_link__referrer\n  \n\n  \n  \n    \n      , unstruct_event_com_snowplowanalytics_snowplow_application_error_1:message::VARCHAR AS app_error__message\n      , unstruct_event_com_snowplowanalytics_snowplow_application_error_1:programmingLanguage::VARCHAR AS app_error__programming_language\n      , unstruct_event_com_snowplowanalytics_snowplow_application_error_1:className::VARCHAR AS app_error__class_name\n      , unstruct_event_com_snowplowanalytics_snowplow_application_error_1:exceptionName::VARCHAR AS app_error__exception_name\n      , unstruct_event_com_snowplowanalytics_snowplow_application_error_1:isFatal::BOOLEAN AS app_error__is_fatal\n      , unstruct_event_com_snowplowanalytics_snowplow_application_error_1:lineNumber::INT AS app_error__line_number\n      , unstruct_event_com_snowplowanalytics_snowplow_application_error_1:stackTrace::VARCHAR AS app_error__stack_trace\n      , unstruct_event_com_snowplowanalytics_snowplow_application_error_1:threadId::INT AS app_error__thread_id\n      , unstruct_event_com_snowplowanalytics_snowplow_application_error_1:threadName::VARCHAR AS app_error__thread_name\n    \n\n  \n\n  \n  \n    , cast(null as float) as screen_summary__foreground_sec\n    , cast(null as float) as screen_summary__background_sec\n    , cast(null as integer) as screen_summary__last_item_index\n    , cast(null as integer) as screen_summary__items_count\n    , cast(null as integer) as screen_summary__min_x_offset\n    , cast(null as integer) as screen_summary__min_y_offset\n    , cast(null as integer) as screen_summary__max_x_offset\n    , cast(null as integer) as screen_summary__max_y_offset\n    , cast(null as integer) as screen_summary__content_width\n    , cast(null as integer) as screen_summary__content_height\n  \n\n\n\n  \n    \n      , unstruct_event_com_snowplowanalytics_snowplow_consent_preferences_1:eventType::varchar as consent__event_type\n      , unstruct_event_com_snowplowanalytics_snowplow_consent_preferences_1:basisForProcessing::varchar as consent__basis_for_processing\n      , unstruct_event_com_snowplowanalytics_snowplow_consent_preferences_1:consentUrl::varchar as consent__consent_url\n      , unstruct_event_com_snowplowanalytics_snowplow_consent_preferences_1:consentVersion::varchar as consent__consent_version\n      , unstruct_event_com_snowplowanalytics_snowplow_consent_preferences_1:consentScopes::array as consent__consent_scopes\n      , unstruct_event_com_snowplowanalytics_snowplow_consent_preferences_1:domainsApplied::array as consent__domains_applied\n      , unstruct_event_com_snowplowanalytics_snowplow_consent_preferences_1:gdprApplies::boolean as consent__gdpr_applies\n    \n\n  \n\n  \n    \n      \n        , unstruct_event_com_snowplowanalytics_snowplow_cmp_visible_1:elapsedTime::float as cmp__elapsed_time\n      \n    \n\n\n    \n      \n      , unstruct_event_com_snowplowanalytics_snowplow_web_vitals_1:lcp::decimal(14,4) as cwv__lcp\n      , unstruct_event_com_snowplowanalytics_snowplow_web_vitals_1:fcp::decimal(14,4) as cwv__fcp\n      , unstruct_event_com_snowplowanalytics_snowplow_web_vitals_1:fid::decimal(14,4) as cwv__fid\n      , unstruct_event_com_snowplowanalytics_snowplow_web_vitals_1:cls::decimal(14,4) as cwv__cls\n      , unstruct_event_com_snowplowanalytics_snowplow_web_vitals_1:inp::decimal(14,4) as cwv__inp\n      , unstruct_event_com_snowplowanalytics_snowplow_web_vitals_1:ttfb::decimal(14,4) as cwv__ttfb\n      , unstruct_event_com_snowplowanalytics_snowplow_web_vitals_1:navigationType::varchar as cwv__navigation_type\n      \n    \n\nfrom base_query\n)\n\nSELECT *\nFROM base_query_2", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_base_events_this_run", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:10.800502Z", "completed_at": "2026-01-20T14:49:10.826389Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:10.828047Z", "completed_at": "2026-01-20T14:49:10.828059Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03276348114013672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_events_this_run", "compiled": true, "compiled_code": "\n\n\n\n\n\n  with base as (\n\n    select\n      *,\n\n      cast(coalesce(\n        \n          ev.page_view__id,\n        \n        \n          ev.screen_view__id,\n        \n          ev.screen__id,\n        \n        \n        null, null) as TEXT ) as view_id,\n\n        cast(coalesce(\n        \n          ev.session__session_index,\n        \n        \n          ev.domain_sessionidx,\n        \n        null, null) as integer ) as device_session_index,\n\n      cast(coalesce(\n        \n          ev.deep_link__referrer,\n        \n        null, null) as TEXT ) as referrer,\n\n      cast(coalesce(\n        \n          ev.deep_link__url,\n        \n        null, null) as TEXT ) as url,\n\n      cast(coalesce(\n        \n          ev.mobile__resolution,\n        \n        null, null) as TEXT ) as screen_resolution,\n\n      cast(coalesce(\n        \n          ev.mobile__os_type,\n        \n        \n          ev.yauaa__operating_system_name,\n        \n        \n          ev.ua__os_family,\n        \n        null, null) as TEXT ) as os_type,\n\n      cast(coalesce(\n        \n          ev.yauaa__operating_system_version,\n        \n        \n          ev.mobile__os_version,\n        \n        \n          ev.ua__os_version,\n        \n        null, null) as TEXT ) as os_version,\n\n      cast(coalesce(\n        \n          ev.domain_userid,\n        \n        \n          ev.session__user_id,\n        \n        null, null) as TEXT ) as device_identifier,\n\n      case when platform = 'web' then 'Web' --includes mobile web\n          when platform = 'mob' then 'Mobile/Tablet'\n          when platform = 'pc' then 'Desktop/Laptop/Netbook'\n          when platform = 'srv' then 'Server-Side App'\n          when platform = 'app' then 'General App'\n          when platform = 'tv' then 'Connected TV'\n          when platform = 'cnsl' then 'Games Console'\n          when platform = 'iot' then 'Internet of Things'\n          when platform = 'headset' then 'AR/VR Headset' end as platform_name\n\n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_base_events_this_run as ev\n\n  )\n\n  select\n    *,\n\n    \n      case when platform = 'web' then yauaa__device_class\n          when yauaa__device_class = 'Phone' then 'Mobile'\n          when yauaa__device_class = 'Tablet' then 'Tablet'\n          else platform_name end as device_category\n\n  from base\n\n", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_events_this_run", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:10.815651Z", "completed_at": "2026-01-20T14:49:10.827310Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:10.829125Z", "completed_at": "2026-01-20T14:49:10.829136Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.03059220314025879, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_base_events_this_run_event_id.e3cb52ed73", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_base_events_this_run\nwhere event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:10.820798Z", "completed_at": "2026-01-20T14:49:10.830022Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:10.831915Z", "completed_at": "2026-01-20T14:49:10.831930Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0321803092956543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_base_events_this_run_event_id.9d8628f1f4", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_base_events_this_run\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:10.808306Z", "completed_at": "2026-01-20T14:49:10.830840Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:10.833472Z", "completed_at": "2026-01-20T14:49:10.833488Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03679299354553223, "adapter_response": {}, "message": null, "failures": null, "unique_id": "operation.snowplow_unified.snowplow_unified-on-run-end-0", "compiled": true, "compiled_code": "\n\n  \n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:10.840968Z", "completed_at": "2026-01-20T14:49:10.876894Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:10.877611Z", "completed_at": "2026-01-20T14:49:10.877623Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.042047739028930664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_app_errors_this_run", "compiled": true, "compiled_code": "\n\n\n\nselect\n  e.event_id,\n\n  e.app_id,\n\n  e.user_id,\n  e.user_identifier,\n  e.network_userid,\n\n  e.session_identifier,\n  e.session__session_index as session_index,\n  e.session__previous_session_id as previous_session_id,\n  e.session__first_event_id as session_first_event_id,\n\n  e.dvce_created_tstamp,\n  e.collector_tstamp,\n  e.derived_tstamp,\n\n  \n     \n    convert_timezone('UTC', convert_timezone('UTC', current_timestamp()))::timestamp\n as model_tstamp,\n  \n\n  e.platform,\n  e.dvce_screenwidth,\n  e.dvce_screenheight,\n  e.mobile__device_manufacturer as device_manufacturer,\n  e.mobile__device_model as device_model,\n  e.mobile__os_type as os_type,\n  e.mobile__os_version as os_version,\n  e.mobile__android_idfa as android_idfa,\n  e.mobile__apple_idfa as apple_idfa,\n  e.mobile__apple_idfv as apple_idfv,\n  e.mobile__open_idfa as open_idfa,\n\n  e.screen__id as screen_id,\n  e.screen__name as screen_name,\n  e.screen__activity as screen_activity,\n  e.screen__fragment as screen_fragment,\n  e.screen__top_view_controller as screen_top_view_controller,\n  e.screen__type as screen_type,\n  e.screen__view_controller as screen_view_controller,\n\n  e.geo__latitude as device_latitude,\n  e.geo__longitude as device_longitude,\n  e.geo__latitude_longitude_accuracy as device_latitude_longitude_accuracy,\n  e.geo__altitude as device_altitude,\n  e.geo__altitude_accuracy as device_altitude_accuracy,\n  e.geo__bearing as device_bearing,\n  e.geo__speed as device_speed,\n  e.geo_country,\n  e.geo_region,\n  e.geo_city,\n  e.geo_zipcode,\n  e.geo__latitude as geo_latitude,\n  e.geo__longitude as geo_longitude,\n  e.geo_region_name as geo_region_name,\n  e.geo_timezone as geo_timezone,\n\n  e.user_ipaddress,\n  e.useragent,\n\n  e.mobile__carrier as carrier,\n  e.mobile__network_technology as network_technology,\n  e.mobile__network_type as network_type,\n\n  e.app__build as build,\n  e.app__build as version,\n  row_number() over(partition by e.session_identifier order by e.derived_tstamp) as event_index_in_session,\n\n  -- app error events\n  e.app_error__message as message,\n  e.app_error__programming_language as programming_language,\n  e.app_error__class_name as class_name,\n  e.app_error__exception_name as exception_name,\n  e.app_error__is_fatal as is_fatal,\n  e.app_error__line_number as line_number,\n  e.app_error__stack_trace as stack_trace,\n  e.app_error__thread_id as thread_id,\n  e.app_error__thread_name as thread_name\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_events_this_run as e\nwhere e.event_name = 'application_error'", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_app_errors_this_run", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:10.857966Z", "completed_at": "2026-01-20T14:49:10.878572Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:10.881228Z", "completed_at": "2026-01-20T14:49:10.881240Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04350924491882324, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_pv_engaged_time", "compiled": true, "compiled_code": "\n\n\n\n-- the first page ping fires after the minimum visit length (n seconds), every subsequent page ping fires after every heartbeat length (n seconds)\n-- there may be imperfectly timed pings and odd duplicates therefore the safest is to do a special calculation:\n-- each pings' epoch timestamp is taken (n seconds) which are then divided by the heartbeat length, floored (to get precise heartbeat length separated intervals)\n-- each distinct value means the user spent that * the heartbeat length on the website (minus the first, which needed the minimum visit lenght to fire)\n\n\n\n\n\nselect\n  ev.view_id,\n  ev.session_identifier,\n  max(ev.derived_tstamp) as end_tstamp,\n  (10 * (count(distinct(floor(date_part('epoch_seconds', ev.dvce_created_tstamp)/10))) - 1)) + 5 as engaged_time_in_s,\n  cast(null as float) as absolute_time_in_s\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_events_this_run as ev\n\nwhere ev.event_name = 'page_ping'\nand ev.view_id is not null\n\ngroup by 1, 2\n\n", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_pv_engaged_time", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:10.849665Z", "completed_at": "2026-01-20T14:49:10.879207Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:10.882394Z", "completed_at": "2026-01-20T14:49:10.882409Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.045365333557128906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_consent_events_this_run", "compiled": true, "compiled_code": "\n\n\n\nwith prep as (\n\n  select\n    e.event_id\n    , e.user_identifier\n    , e.user_id\n    , e.geo_country\n    , e.view_id\n    , e.session_identifier\n    , e.derived_tstamp\n    , e.load_tstamp\n    , e.event_name\n    , e.consent__event_type as event_type\n    , e.consent__basis_for_processing as basis_for_processing\n    , e.consent__consent_url as consent_url\n    , e.consent__consent_version as consent_version\n    , e.consent__consent_scopes as consent_scopes\n    , e.consent__domains_applied as domains_applied\n    , e.consent__gdpr_applies as gdpr_applies\n    , e.cmp__elapsed_time as cmp_load_time\n\n  from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_events_this_run as e\n\n  where event_name in ('cmp_visible', 'consent_preferences')\n\n  and True --returns false if run doesn't contain new events.\n\n  \n      \n  \n    and coalesce(iab__spider_or_robot, False ) = False\n  \n  and not rlike(useragent, '.*(bot|crawl|slurp|spider|archiv|spinn|sniff|seo|audit|survey|pingdom|worm|capture|(browser|screen)shots|analyz|index|thumb|check|facebook|PingdomBot|PhantomJS|YandexBot|Twitterbot|a_archiver|facebookexternalhit|Bingbot|BingPreview|Googlebot|Baiduspider|360(Spider|User-agent)|semalt).*')\n\n  \n\n)\n\nselect\n  p.event_id,\n  p.user_identifier,\n  p.user_id,\n  p.geo_country,\n  p.view_id,\n  p.session_identifier,\n  p.derived_tstamp,\n  p.load_tstamp,\n  p.event_name,\n  p.event_type,\n  p.basis_for_processing,\n  p.consent_url,\n  p.consent_version,\n  \n    array_to_string(p.consent_scopes,', ')\n as consent_scopes,\n  \n    array_to_string(p.domains_applied,', ')\n as domains_applied,\n  coalesce(p.gdpr_applies, false) as gdpr_applies,\n  p.cmp_load_time\n\nfrom prep p", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_consent_events_this_run", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:10.865497Z", "completed_at": "2026-01-20T14:49:10.880504Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:10.883982Z", "completed_at": "2026-01-20T14:49:10.883993Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.044998884201049805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_pv_scroll_depth", "compiled": true, "compiled_code": "\n\n\n\nwith prep as (\n  select\n    ev.view_id,\n    ev.session_identifier,\n\n    max(ev.doc_width) as doc_width,\n    max(ev.doc_height) as doc_height,\n\n    max(ev.br_viewwidth) as br_viewwidth,\n    max(ev.br_viewheight) as br_viewheight,\n\n    -- coalesce replaces null with 0 (because the page view event does send an offset)\n    -- greatest prevents outliers (negative offsets)\n    -- least also prevents outliers (offsets greater than the docwidth or docheight)\n\n    \n    least(greatest(min(coalesce(ev.pp_xoffset_min, 0)), 0), max(ev.doc_width)) as hmin, -- should be zero\n    least(greatest(max(coalesce(ev.pp_xoffset_max, 0)), 0), max(ev.doc_width)) as hmax,\n\n    \n    least(greatest(min(coalesce(ev.pp_yoffset_min, 0)), 0), max(ev.doc_height)) as vmin, -- should be zero (edge case: not zero because the pv event is missing)\n    least(greatest(max(coalesce(ev.pp_yoffset_max, 0)), 0), max(ev.doc_height)) as vmax\n\n  from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_events_this_run as ev\n\n  where ev.event_name in ('page_view', 'page_ping')\n    and ev.view_id is not null\n    and ev.doc_height > 0 -- exclude problematic (but rare) edge case\n    and ev.doc_width > 0 -- exclude problematic (but rare) edge case\n\n  group by 1, 2\n)\n\nselect\n  view_id,\n  session_identifier,\n\n  doc_width,\n  doc_height,\n\n  br_viewwidth,\n  br_viewheight,\n\n  hmin,\n  hmax,\n  vmin,\n  vmax,\n\n  cast(round(100*(greatest(hmin, 0)/cast(doc_width as float))) as float) as relative_hmin, -- brackets matter: because hmin is of type int, we need to divide before we multiply by 100 or we risk an overflow\n  cast(round(100*(least(hmax + br_viewwidth, doc_width)/cast(doc_width as float))) as float) as relative_hmax,\n  cast(round(100*(greatest(vmin, 0)/cast(doc_height as float))) as float) as relative_vmin,\n  cast(round(100*(least(vmax + br_viewheight, doc_height)/cast(doc_height as float))) as float) as relative_vmax, -- not zero when a user hasn't scrolled because it includes the non-zero viewheight\n\n  cast(null as integer) as last_list_item_index,\n  cast(null as integer) as list_items_count,\n  cast(null as integer) as list_items_percentage_scrolled\n\nfrom prep\n\n", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_pv_scroll_depth", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:10.950845Z", "completed_at": "2026-01-20T14:49:10.967889Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:10.969624Z", "completed_at": "2026-01-20T14:49:10.969636Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.0811910629272461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_web_vital_events_this_run", "compiled": true, "compiled_code": "\n\n\n\nwith prep as (\n\n  select\n    e.event_id\n    , e.event_name\n    , e.app_id\n    , e.platform\n    , e.user_identifier\n    , e.user_id\n    , e.view_id\n    , e.session_identifier\n    , e.collector_tstamp\n    , e.derived_tstamp\n    , e.dvce_created_tstamp\n    , e.load_tstamp\n    , e.geo_country\n    , e.page_url\n    , e.page_title\n    , e.useragent\n    , e.yauaa__device_class as device_class\n    , e.yauaa__agent_class as agent_class\n    , e.yauaa__agent_name as agent_name\n    , e.yauaa__agent_name_version as agent_name_version\n    , e.yauaa__agent_name_version_major as agent_name_version_major\n    , e.yauaa__agent_version as agent_version\n    , e.yauaa__agent_version_major agent_version_major\n    , e.yauaa__device_brand as device_brand\n    , e.yauaa__device_name as device_name\n    , e.yauaa__device_version as device_version\n    , e.yauaa__layout_engine_class as layout_engine_class\n    , e.yauaa__layout_engine_name as layout_engine_name\n    , e.yauaa__layout_engine_name_version as layout_engine_name_version\n    , e.yauaa__layout_engine_name_version_major as layout_engine_name_version_major\n    , e.yauaa__layout_engine_version as layout_engine_version\n    , e.yauaa__layout_engine_version_major as layout_engine_version_major\n    , e.yauaa__operating_system_class as operating_system_class\n    , e.yauaa__operating_system_name as operating_system_name\n    , e.yauaa__operating_system_name_version as operating_system_name_version\n    , e.yauaa__operating_system_version as operating_system_version\n    , ceil(e.cwv__lcp, 3) /1000 as lcp\n    , ceil(e.cwv__fcp, 3) as fcp\n    , ceil(e.cwv__fid, 3) as fid\n    , ceil(e.cwv__cls, 3) as cls\n    , ceil(e.cwv__inp, 3)as inp\n    , ceil(e.cwv__ttfb, 3) as ttfb\n    , e.cwv__navigation_type as navigation_type\n\n  from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_events_this_run as e\n\n  where True --returns false if run doesn't contain new events.\n\n  and event_name = 'web_vitals'\n\n  and view_id is not null\n\n  -- exclude bot traffic\n\n  \n    and not \ne.contexts_com_iab_snowplow_spiders_and_robots_1[0]:spiderOrRobot::boolean\n = True\n  \n\n  \n  \n    and coalesce(iab__spider_or_robot, False ) = False\n  \n  and not rlike(useragent, '.*(bot|crawl|slurp|spider|archiv|spinn|sniff|seo|audit|survey|pingdom|worm|capture|(browser|screen)shots|analyz|index|thumb|check|facebook|PingdomBot|PhantomJS|YandexBot|Twitterbot|a_archiver|facebookexternalhit|Bingbot|BingPreview|Googlebot|Baiduspider|360(Spider|User-agent)|semalt).*')\n\n\n)\n\nselect\n  event_id,\n  event_name,\n  app_id,\n  platform,\n  user_identifier,\n  user_id,\n  view_id,\n  session_identifier,\n  collector_tstamp,\n  derived_tstamp,\n  dvce_created_tstamp,\n  load_tstamp,\n  geo_country,\n  page_url,\n  page_title,\n  useragent,\n  lower(device_class) as device_class,\n  agent_class,\n  agent_name,\n  agent_name_version,\n  agent_name_version_major,\n  agent_version,\n  agent_version_major,\n  device_brand,\n  device_name,\n  device_version,\n  layout_engine_class,\n  layout_engine_name,\n  layout_engine_name_version,\n  layout_engine_name_version_major,\n  layout_engine_version,\n  layout_engine_version_major,\n  operating_system_class,\n  operating_system_name,\n  operating_system_name_version,\n  operating_system_version,\n  lcp,\n  fcp,\n  fid,\n  cls,\n  inp,\n  ttfb,\n  navigation_type\n\nfrom prep p", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_web_vital_events_this_run", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:10.960122Z", "completed_at": "2026-01-20T14:49:10.968607Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:10.970706Z", "completed_at": "2026-01-20T14:49:10.970719Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07136392593383789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified_integration_tests.test_late_enabled_contexts", "compiled": true, "compiled_code": "\n\n\n\nselect *\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_events_this_run", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.test_late_enabled_contexts", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:10.975647Z", "completed_at": "2026-01-20T14:49:10.987269Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:10.988048Z", "completed_at": "2026-01-20T14:49:10.988060Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.015030860900878906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_events_this_run_event_id.152f747832", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_events_this_run\nwhere event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:10.981853Z", "completed_at": "2026-01-20T14:49:11.000664Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.001945Z", "completed_at": "2026-01-20T14:49:11.001957Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.028223037719726562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_events_this_run_event_id.d04b0599f5", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_events_this_run\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.005188Z", "completed_at": "2026-01-20T14:49:11.011930Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.012541Z", "completed_at": "2026-01-20T14:49:11.012551Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008653640747070312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_app_errors_this_run_collector_tstamp.4fc8c4afad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect collector_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_app_errors_this_run\nwhere collector_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.015229Z", "completed_at": "2026-01-20T14:49:11.020641Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.021211Z", "completed_at": "2026-01-20T14:49:11.021221Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007226228713989258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_app_errors_this_run_derived_tstamp.ea1324a9e3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect derived_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_app_errors_this_run\nwhere derived_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.023935Z", "completed_at": "2026-01-20T14:49:11.029621Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.030199Z", "completed_at": "2026-01-20T14:49:11.030209Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0075664520263671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_app_errors_this_run_dvce_created_tstamp.64cdf1fba6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dvce_created_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_app_errors_this_run\nwhere dvce_created_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.032872Z", "completed_at": "2026-01-20T14:49:11.038293Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.038887Z", "completed_at": "2026-01-20T14:49:11.038897Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007260560989379883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_app_errors_this_run_event_id.a04e4b56e9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_app_errors_this_run\nwhere event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.041521Z", "completed_at": "2026-01-20T14:49:11.048095Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.048698Z", "completed_at": "2026-01-20T14:49:11.048709Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008437871932983398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_app_errors_this_run_model_tstamp.2f83e1ec04", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect model_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_app_errors_this_run\nwhere model_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.051484Z", "completed_at": "2026-01-20T14:49:11.056768Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.057335Z", "completed_at": "2026-01-20T14:49:11.057344Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0072612762451171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_app_errors_this_run_network_userid.6e4a6bdf97", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect network_userid\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_app_errors_this_run\nwhere network_userid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.059978Z", "completed_at": "2026-01-20T14:49:11.065372Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.066004Z", "completed_at": "2026-01-20T14:49:11.066014Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007269859313964844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_app_errors_this_run_session_first_event_id.918c25b76d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_first_event_id\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_app_errors_this_run\nwhere session_first_event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.068714Z", "completed_at": "2026-01-20T14:49:11.075352Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.075950Z", "completed_at": "2026-01-20T14:49:11.075960Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0084991455078125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_app_errors_this_run_session_identifier.765b562252", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_identifier\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_app_errors_this_run\nwhere session_identifier is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.078663Z", "completed_at": "2026-01-20T14:49:11.084612Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.086253Z", "completed_at": "2026-01-20T14:49:11.086264Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008898496627807617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_app_errors_this_run_session_index.c4dd0f3b15", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_index\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_app_errors_this_run\nwhere session_index is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:10.889191Z", "completed_at": "2026-01-20T14:49:11.100482Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.101156Z", "completed_at": "2026-01-20T14:49:11.101168Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.21794915199279785, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_sessions_this_run", "compiled": true, "compiled_code": "\n\n\n\nwith session_firsts as (\n    select\n        \n\n    -- event categorization fields\n    ev.event_name,\n    ev.user_id,\n    ev.user_identifier,\n    ev.network_userid,\n\n    -- timestamp fields\n    ev.dvce_created_tstamp,\n    ev.collector_tstamp,\n    ev.derived_tstamp,\n    ev.derived_tstamp as start_tstamp,\n\n    -- geo fields\n    ev.geo_country,\n    ev.geo_region,\n    ev.geo_region_name,\n    ev.geo_city,\n    ev.geo_zipcode,\n    ev.geo_latitude,\n    ev.geo_longitude,\n    ev.geo_timezone,\n    ev.user_ipaddress,\n\n    -- device fields\n    ev.app_id,\n    ev.platform,\n    ev.device_identifier,\n    ev.device_category,\n    ev.device_session_index,\n    ev.os_version,\n    ev.os_type,\n    ev.screen_resolution,\n\n    -- marketing fields\n    ev.mkt_medium,\n    ev.mkt_source,\n    ev.mkt_term,\n    ev.mkt_content,\n    ev.mkt_campaign,\n    ev.mkt_clickid,\n    ev.mkt_network,\n    \n\n\n\n\ncase\n   when lower(trim(\n   \n      mkt_source\n   \n)) = 'direct' and lower(trim(\n   \n      mkt_medium\n   \n)) in ('not set', 'none') then 'Direct'\n   when lower(trim(\n   \n      mkt_medium\n   \n)) like '%cross-network%' then 'Cross-network'\n   when regexp_like(lower(trim(\n   \n      mkt_medium\n   \n)), '^(.*cp.*|ppc|retargeting|paid.*)$') then\n      case\n         when upper(source_category) = 'SOURCE_CATEGORY_SHOPPING'\n            or regexp_like(lower(trim(mkt_campaign)), '^(.*(([^a-df-z]|^)shop|shopping).*)$') then 'Paid Shopping'\n         when upper(source_category) = 'SOURCE_CATEGORY_SEARCH' then 'Paid Search'\n         when upper(source_category) = 'SOURCE_CATEGORY_SOCIAL' then 'Paid Social'\n         when upper(source_category) = 'SOURCE_CATEGORY_VIDEO' then 'Paid Video'\n         else 'Paid Other'\n      end\n   when lower(trim(\n   \n      mkt_medium\n   \n)) in ('display', 'banner', 'expandable', 'intersitial', 'cpm') then 'Display'\n   when upper(source_category) = 'SOURCE_CATEGORY_SHOPPING'\n      or regexp_like(lower(trim(mkt_campaign)), '^(.*(([^a-df-z]|^)shop|shopping).*)$') then 'Organic Shopping'\n   when upper(source_category) = 'SOURCE_CATEGORY_SOCIAL' or lower(trim(\n   \n      mkt_medium\n   \n)) in ('social', 'social-network', 'sm', 'social network', 'social media') then 'Organic Social'\n   when upper(source_category) = 'SOURCE_CATEGORY_VIDEO'\n      or regexp_like(lower(trim(\n   \n      mkt_medium\n   \n)), '^(.*video.*)$') then 'Organic Video'\n   when upper(source_category) = 'SOURCE_CATEGORY_SEARCH' or lower(trim(\n   \n      mkt_medium\n   \n)) = 'organic' then 'Organic Search'\n   when lower(trim(\n   \n      mkt_medium\n   \n)) in ('referral', 'app', 'link') then 'Referral'\n   when lower(trim(\n   \n      mkt_source\n   \n)) in ('email', 'e-mail', 'e_mail', 'e mail') or lower(trim(\n   \n      mkt_medium\n   \n)) in ('email', 'e-mail', 'e_mail', 'e mail') then 'Email'\n   when lower(trim(\n   \n      mkt_medium\n   \n)) = 'affiliate' then 'Affiliates'\n   when lower(trim(\n   \n      mkt_medium\n   \n)) = 'audio' then 'Audio'\n   when lower(trim(\n   \n      mkt_medium\n   \n)) = 'chatbot' then 'Chatbot'\n   when lower(trim(\n   \n      mkt_source\n   \n)) = 'sms' or lower(trim(\n   \n      mkt_medium\n   \n)) = 'sms' then 'SMS'\n   when lower(trim(\n   \n      mkt_medium\n   \n)) like '%push' or regexp_like(lower(trim(\n   \n      mkt_medium\n   \n)), '.*(mobile|notification).*') or lower(trim(\n   \n      mkt_source\n   \n)) = 'firebase' then 'Mobile Push Notifications'\n   else 'Unassigned'\nend\n as default_channel_group,\n\n    -- webpage / referer / browser fields\n    ev.page_url,\n    ev.page_referrer,\n    ev.refr_medium,\n    ev.refr_source,\n    ev.refr_term,\n    ev.useragent\n\n\n        , session_identifier\n\n        \n          \n\n      , ev.br_lang\n      , ev.br_viewwidth\n      , ev.br_viewheight\n      , ev.br_renderengine\n      , ev.doc_width\n      , ev.doc_height\n      , ev.page_title\n      , ev.page_urlscheme\n      , ev.page_urlhost\n      , ev.page_urlpath\n      , ev.page_urlquery\n      , ev.page_urlfragment\n      , ev.refr_urlscheme\n      , ev.refr_urlhost\n      , ev.refr_urlpath\n      , ev.refr_urlquery\n      , ev.refr_urlfragment\n      , ev.os_timezone\n\n\n        \n\n        \n          \n\n  , ev.session__previous_session_id\n  , ev.screen_view__name\n  , ev.screen_view__previous_id\n  , ev.screen_view__previous_name\n  , ev.screen_view__previous_type\n  , ev.screen_view__transition_type\n  , ev.screen_view__type\n\n\n        \n\n        \n          -- updated with mapping as part of post hook on derived sessions table\n          , cast(user_identifier as \n    TEXT\n) as stitched_user_id\n        \n\n        \n          \n\n    , ev.iab__category\n    , ev.iab__primary_impact\n    , ev.iab__reason\n    , ev.iab__spider_or_robot\n\n\n        \n\n        \n          \n\n    , ev.yauaa__device_class\n    , ev.yauaa__agent_class\n    , ev.yauaa__agent_name\n    , ev.yauaa__agent_name_version\n    , ev.yauaa__agent_name_version_major\n    , ev.yauaa__agent_version\n    , ev.yauaa__agent_version_major\n    , ev.yauaa__device_brand\n    , ev.yauaa__device_name\n    , ev.yauaa__device_version\n    , ev.yauaa__layout_engine_class\n    , ev.yauaa__layout_engine_name\n    , ev.yauaa__layout_engine_name_version\n    , ev.yauaa__layout_engine_name_version_major\n    , ev.yauaa__layout_engine_version\n    , ev.yauaa__layout_engine_version_major\n    , ev.yauaa__operating_system_class\n    , ev.yauaa__operating_system_name\n    , ev.yauaa__operating_system_name_version\n    , ev.yauaa__operating_system_version\n\n\n        \n\n        \n          \n\n      , ev.ua__useragent_family\n      , ev.ua__useragent_major\n      , ev.ua__useragent_minor\n      , ev.ua__useragent_patch\n      , ev.ua__useragent_version\n      , ev.ua__os_family\n      , ev.ua__os_major\n      , ev.ua__os_minor\n      , ev.ua__os_patch\n      , ev.ua__os_patch_minor\n      , ev.ua__os_version\n      , ev.ua__device_family\n\n\n        \n\n        \n          \n\n  , ev.app__build\n  , ev.app__version\n\n\n        \n\n        \n          \n\n    , ev.geo__latitude\n    , ev.geo__longitude\n    , ev.geo__latitude_longitude_accuracy\n    , ev.geo__altitude\n    , ev.geo__altitude_accuracy\n    , ev.geo__bearing\n    , ev.geo__speed\n\n\n        \n\n        , g.name as geo_country_name\n        , g.region as geo_continent\n        , l.name as br_lang_name\n\n        \n          \n\n      , ev.screen__id\n      , ev.screen__name\n      , ev.screen__activity\n      , ev.screen__fragment\n      , ev.screen__top_view_controller\n      , ev.screen__type\n      , ev.screen__view_controller\n\n\n        \n\n        \n          \n\n    , ev.mobile__device_manufacturer\n    , ev.mobile__device_model\n    , ev.mobile__os_type\n    , ev.mobile__os_version\n    , ev.mobile__android_idfa\n    , ev.mobile__apple_idfa\n    , ev.mobile__apple_idfv\n    , ev.mobile__carrier\n    , ev.mobile__open_idfa\n    , ev.mobile__network_technology\n    , ev.mobile__network_type\n    , ev.mobile__physical_memory\n    , ev.mobile__system_available_memory\n    , ev.mobile__app_available_memory\n    , ev.mobile__battery_level\n    , ev.mobile__battery_state\n    , ev.mobile__low_power_mode\n    , ev.mobile__available_storage\n    , ev.mobile__total_storage\n    , ev.mobile__is_portrait\n    , ev.mobile__resolution\n    , ev.mobile__scale\n    , ev.mobile__language\n    , ev.mobile__app_set_id\n    , ev.mobile__app_set_id_scope\n\n\n        \n\n        \n\n        , \n  regexp_substr(page_urlquery, 'utm_source_platform=([^?&#]*)', 1, 1, 'e')\n as mkt_source_platform\n            ,ev.event_id\n            ,event_id as event_id2\n\n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_events_this_run ev\n    left join\n        SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snowplow_manifest.snowplow_unified_dim_ga4_source_categories c on \n        \n          lower(trim(ev.mkt_source)) = lower(c.source)\n        \n    left join\n        SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snowplow_manifest.snowplow_unified_dim_rfc_5646_language_mapping l on lower(ev.br_lang) = lower(l.lang_tag)\n    left join\n        SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snowplow_manifest.snowplow_unified_dim_geo_country_mapping g on lower(ev.geo_country) = lower(g.alpha_2)\n    where event_name in ('page_ping', 'page_view', 'screen_view')\n    and view_id is not null\n\n    \n      \n  \n    and coalesce(iab__spider_or_robot, False ) = False\n  \n  and not rlike(useragent, '.*(bot|crawl|slurp|spider|archiv|spinn|sniff|seo|audit|survey|pingdom|worm|capture|(browser|screen)shots|analyz|index|thumb|check|facebook|PingdomBot|PhantomJS|YandexBot|Twitterbot|a_archiver|facebookexternalhit|Bingbot|BingPreview|Googlebot|Baiduspider|360(Spider|User-agent)|semalt).*')\n\n    \n\n    \n      qualify row_number() over (partition by session_identifier order by derived_tstamp, dvce_created_tstamp, event_id) = 1\n    \n)\n\n, session_lasts as (\n    select\n\n      ev.event_name as last_event_name,\n      ev.geo_country as last_geo_country,\n      ev.geo_city as last_geo_city,\n      ev.geo_region_name as last_geo_region_name,\n      g.name as last_geo_country_name,\n      g.region as last_geo_continent,\n      ev.page_url as last_page_url,\n\n      \n        ev.page_title as last_page_title,\n        ev.page_urlscheme as last_page_urlscheme,\n        ev.page_urlhost as last_page_urlhost,\n        ev.page_urlpath as last_page_urlpath,\n        ev.page_urlquery as last_page_urlquery,\n        ev.page_urlfragment as last_page_urlfragment,\n        br_lang as last_br_lang,\n        l.name as last_br_lang_name,\n      \n\n      \n        ev.screen_view__name as last_screen_view__name,\n        ev.screen_view__transition_type as last_screen_view__transition_type,\n        ev.screen_view__type as last_screen_view__type,\n      \n\n      \n\n      session_identifier\n\n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_events_this_run ev\n    left join\n        SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snowplow_manifest.snowplow_unified_dim_rfc_5646_language_mapping l on lower(ev.br_lang) = lower(l.lang_tag)\n    left join\n        SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snowplow_manifest.snowplow_unified_dim_geo_country_mapping g on lower(ev.geo_country) = lower(g.alpha_2)\n    where\n        event_name in ('page_view', 'screen_view')\n        and view_id is not null\n        \n            \n  \n    and coalesce(iab__spider_or_robot, False ) = False\n  \n  and not rlike(useragent, '.*(bot|crawl|slurp|spider|archiv|spinn|sniff|seo|audit|survey|pingdom|worm|capture|(browser|screen)shots|analyz|index|thumb|check|facebook|PingdomBot|PhantomJS|YandexBot|Twitterbot|a_archiver|facebookexternalhit|Bingbot|BingPreview|Googlebot|Baiduspider|360(Spider|User-agent)|semalt).*')\n\n        \n\n    \n      qualify row_number() over (partition by session_identifier order by derived_tstamp desc, dvce_created_tstamp desc, event_id) = 1\n    \n)\n\n, session_aggs as (\n    select\n      session_identifier\n      , min(derived_tstamp) as start_tstamp\n      , max(derived_tstamp) as end_tstamp\n      , count(*) as total_events\n      , count(distinct view_id) as views\n          , \n  \n  \n\n  '{' || rtrim(\n      case when sum(case when event_name = 'application_background' then 1 else 0 end) > 0 then '\"application_background\" :' || sum(case when event_name = 'application_background' then 1 else 0 end) || ', ' else '' end ||\n      case when sum(case when event_name = 'application_foreground' then 1 else 0 end) > 0 then '\"application_foreground\" :' || sum(case when event_name = 'application_foreground' then 1 else 0 end) || ', ' else '' end ||\n      case when sum(case when event_name = 'cmp_visible' then 1 else 0 end) > 0 then '\"cmp_visible\" :' || sum(case when event_name = 'cmp_visible' then 1 else 0 end) || ', ' else '' end ||\n      case when sum(case when event_name = 'consent_preferences' then 1 else 0 end) > 0 then '\"consent_preferences\" :' || sum(case when event_name = 'consent_preferences' then 1 else 0 end) || ', ' else '' end ||\n      case when sum(case when event_name = 'data_structures_workflow' then 1 else 0 end) > 0 then '\"data_structures_workflow\" :' || sum(case when event_name = 'data_structures_workflow' then 1 else 0 end) || ', ' else '' end ||\n      case when sum(case when event_name = 'event' then 1 else 0 end) > 0 then '\"event\" :' || sum(case when event_name = 'event' then 1 else 0 end) || ', ' else '' end ||\n      case when sum(case when event_name = 'link_click' then 1 else 0 end) > 0 then '\"link_click\" :' || sum(case when event_name = 'link_click' then 1 else 0 end) || ', ' else '' end ||\n      case when sum(case when event_name = 'page_ping' then 1 else 0 end) > 0 then '\"page_ping\" :' || sum(case when event_name = 'page_ping' then 1 else 0 end) || ', ' else '' end ||\n      case when sum(case when event_name = 'page_view' then 1 else 0 end) > 0 then '\"page_view\" :' || sum(case when event_name = 'page_view' then 1 else 0 end) || ', ' else '' end ||\n      case when sum(case when event_name = 'screen_view' then 1 else 0 end) > 0 then '\"screen_view\" :' || sum(case when event_name = 'screen_view' then 1 else 0 end) || ', ' else '' end ||\n      case when sum(case when event_name = 'snplow_cookies' then 1 else 0 end) > 0 then '\"snplow_cookies\" :' || sum(case when event_name = 'snplow_cookies' then 1 else 0 end) || ', ' else '' end ||'', ', ') || '}'\n\n as event_counts_string\n\n      \n        -- (hb * (#page pings - # distinct page view ids ON page pings)) + (# distinct page view ids ON page pings * min visit length)\n        , (10 * (\n              -- number of (unqiue in heartbeat increment) pages pings following a page ping (gap of heartbeat)\n              count(distinct case when event_name = 'page_ping' and view_id is not null then\n                          -- need to get a unique list of floored time PER page view, so create a dummy surrogate key...\n                          view_id || cast(floor(date_part('epoch_seconds', dvce_created_tstamp)/10) as TEXT)\n                      else null end) - count(distinct case when event_name = 'page_ping' and view_id is not null then view_id else null end)\n                            ))  +\n                            -- number of page pings following a page view (or no event) (gap of min visit length)\n                            (count(distinct case when event_name = 'page_ping' and view_id is not null then view_id else null end) * 5) as engaged_time_in_s_web\n      \n\n      , datediff(\n        second,\n        min(derived_tstamp),\n        max(derived_tstamp)\n        ) as absolute_time_in_s\n\n      \n        , count(distinct case when event_name = 'application_error' then 1 end) as app_errors\n        , count(distinct case when app_error__is_fatal then event_id end) as fatal_app_errors\n      \n\n      \n        , count(distinct screen_view__name) as screen_names_viewed\n      \n\n      \n        \n          , \n  \n  \n  \n\n  \n  \n  \n    count(case when event_name = 'page_view' then 1 else null end) as agg_test\n  \n\n\n        \n      \n\n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_events_this_run\n    where 1 = 1\n\n    \n        \n  \n    and coalesce(iab__spider_or_robot, False ) = False\n  \n  and not rlike(useragent, '.*(bot|crawl|slurp|spider|archiv|spinn|sniff|seo|audit|survey|pingdom|worm|capture|(browser|screen)shots|analyz|index|thumb|check|facebook|PingdomBot|PhantomJS|YandexBot|Twitterbot|a_archiver|facebookexternalhit|Bingbot|BingPreview|Googlebot|Baiduspider|360(Spider|User-agent)|semalt).*')\n\n    \n\n    group by session_identifier\n)\n\n, session_aggs_with_engaged_time as (\n  \n    select a.*\n\n      \n      , a.engaged_time_in_s_web as engaged_time_in_s\n      \n\n    from session_aggs a\n  \n)\n\n, iso_639_3_deduped AS (\n    select *,\n      row_number() over (partition by iso_639_3_code ORDER BY name) as row_num\n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snowplow_manifest.snowplow_unified_dim_iso_639_3\n)\n\n\n\n-- Redshift does not allow listagg and other aggregations in the same CTE\n,session_convs as (\n    select\n        session_identifier\n            \n\n\n\n\n,COUNT(CASE WHEN event_name = 'page_view' THEN 1 ELSE null END) AS cv_view_page_volume\n,ARRAYAGG(CASE WHEN event_name = 'page_view' THEN event_id ELSE null END) WITHIN GROUP (ORDER BY derived_tstamp, dvce_created_tstamp, event_id) AS cv_view_page_events\n,ARRAYAGG(CASE WHEN event_name = 'page_view' THEN coalesce(tr_total_base,0.5) ELSE null END) WITHIN GROUP (ORDER BY derived_tstamp, dvce_created_tstamp, event_id) AS cv_view_page_values\n,SUM(CASE WHEN event_name = 'page_view' THEN coalesce(tr_total_base, 0.5) ELSE 0 END) AS cv_view_page_total\n,MIN(CASE WHEN event_name = 'page_view' THEN derived_tstamp ELSE null END) AS cv_view_page_first_conversion\n,CAST(MAX(CASE WHEN event_name = 'page_view' THEN 1 ELSE 0 END) AS boolean) AS cv_view_page_converted\n\n        \n          from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_events_this_run\n          where 1 = 1\n          \n            \n  \n    and coalesce(iab__spider_or_robot, False ) = False\n  \n  and not rlike(useragent, '.*(bot|crawl|slurp|spider|archiv|spinn|sniff|seo|audit|survey|pingdom|worm|capture|(browser|screen)shots|analyz|index|thumb|check|facebook|PingdomBot|PhantomJS|YandexBot|Twitterbot|a_archiver|facebookexternalhit|Bingbot|BingPreview|Googlebot|Baiduspider|360(Spider|User-agent)|semalt).*')\n\n          \n        \n        group by session_identifier\n)\n\nselect\n\n  -- event categorization fields\n  f.event_name as first_event_name\n  , l.last_event_name\n  , f.session_identifier\n  \n    , f.session__previous_session_id\n  \n\n  -- user id fields\n  , f.user_id\n  , f.user_identifier\n  , f.stitched_user_id\n  , f.network_userid\n\n  -- timestamp fields\n  -- when the session starts with a ping we need to add the min visit length to get when the session actually started\n  , case when f.event_name = 'page_ping' then \n\n    dateadd(\n        second,\n        -5,\n        a.start_tstamp\n        )\n\n else a.start_tstamp end as start_tstamp\n  , a.end_tstamp -- only page views with pings will have a row in table t\n  , \n    convert_timezone('UTC', convert_timezone('UTC', current_timestamp()))::timestamp\n as model_tstamp\n\n  -- device fields\n  , f.app_id\n  , f.platform\n  , f.device_identifier\n  , f.device_category\n  , f.device_session_index\n  , f.os_version\n  , f.os_type\n\n  \n    , f.os_timezone\n  \n\n  , f.screen_resolution\n\n\n  \n    \n\n    , f.mobile__device_manufacturer\n    , f.mobile__device_model\n    , f.mobile__os_type\n    , f.mobile__os_version\n    , f.mobile__android_idfa\n    , f.mobile__apple_idfa\n    , f.mobile__apple_idfv\n    , f.mobile__carrier\n    , f.mobile__open_idfa\n    , f.mobile__network_technology\n    , f.mobile__network_type\n    , f.mobile__physical_memory\n    , f.mobile__system_available_memory\n    , f.mobile__app_available_memory\n    , f.mobile__battery_level\n    , f.mobile__battery_state\n    , f.mobile__low_power_mode\n    , f.mobile__available_storage\n    , f.mobile__total_storage\n    , f.mobile__is_portrait\n    , f.mobile__resolution\n    , f.mobile__scale\n    , f.mobile__language\n    , f.mobile__app_set_id\n    , f.mobile__app_set_id_scope\n\n\n    , coalesce(iso_639_2t_2_char.name, iso_639_2t_3_char.name, iso_639_3.name, f.mobile__language) as mobile_language_name\n  \n\n  -- geo fields\n  , f.geo_country as first_geo_country\n  , f.geo_region_name as first_geo_region_name\n  , f.geo_city as first_geo_city\n  , f.geo_country_name as first_geo_country_name\n  , f.geo_continent as first_geo_continent\n\n  , case when l.last_geo_country is null then coalesce(l.last_geo_country, f.geo_country) else l.last_geo_country end as last_geo_country\n  , case when l.last_geo_country is null then coalesce(l.last_geo_region_name, f.geo_region_name) else l.last_geo_region_name end as last_geo_region_name\n  , case when l.last_geo_country is null then coalesce(l.last_geo_city, f.geo_city) else l.last_geo_city end as last_geo_city\n  , case when l.last_geo_country is null then coalesce(l.last_geo_country_name,f.geo_country_name) else l.last_geo_country_name end as last_geo_country_name\n  , case when l.last_geo_country is null then coalesce(l.last_geo_continent, f.geo_continent) else l.last_geo_continent end as last_geo_continent\n\n  , f.geo_zipcode\n  , f.geo_latitude\n  , f.geo_longitude\n  , f.geo_timezone\n  , f.user_ipaddress\n\n  -- engagement fields\n  , a.views\n    , \n  try_parse_json(event_counts_string)\n as event_counts\n  , a.total_events\n  , coalesce(\n    case when a.session_identifier= '0b0c7bb589ebd041177514f3e43446ca5d4343328936d2f8f12a42b41bf9140e' then true\n    else\n    views >= 2\n\n    \n      or engaged_time_in_s / 10 >= 2\n        or cv_view_page_converted end\n, false) as is_engaged\n  -- when the session starts with a ping we need to add the min visit length to get when the session actually started\n\n  \n    , a.engaged_time_in_s\n\n  , a.absolute_time_in_s + case when f.event_name = 'page_ping' then 5 else 0 end as absolute_time_in_s\n\n  \n    , a.screen_names_viewed\n\n  -- marketing fields\n  , f.mkt_medium\n  , f.mkt_source\n  , f.mkt_term\n  , f.mkt_content\n  , f.mkt_campaign\n  , f.mkt_clickid\n  , f.mkt_network\n  , f.default_channel_group\n  , mkt_source_platform\n\n  -- webpage / referrer / browser fields\n  , f.page_url as first_page_url\n  , case when l.last_page_url is null then coalesce(l.last_page_url, f.page_url) else l.last_page_url end as last_page_url\n  , f.page_referrer\n  , f.refr_medium\n  , f.refr_source\n  , f.refr_term\n\n  \n    , f.page_title as first_page_title\n    , f.page_urlscheme as first_page_urlscheme\n    , f.page_urlhost as first_page_urlhost\n    , f.page_urlpath as first_page_urlpath\n    , f.page_urlquery as first_page_urlquery\n    , f.page_urlfragment as first_page_urlfragment\n    -- only take the first value when the last is genuinely missing (base on url as has to always be populated)\n    , case when l.last_page_url is null then coalesce(l.last_page_title, f.page_title) else l.last_page_title end as last_page_title\n    , case when l.last_page_url is null then coalesce(l.last_page_urlscheme, f.page_urlscheme) else l.last_page_urlscheme end as last_page_urlscheme\n    , case when l.last_page_url is null then coalesce(l.last_page_urlhost, f.page_urlhost) else l.last_page_urlhost end as last_page_urlhost\n    , case when l.last_page_url is null then coalesce(l.last_page_urlpath, f.page_urlpath) else l.last_page_urlpath end as last_page_urlpath\n    , case when l.last_page_url is null then coalesce(l.last_page_urlquery, f.page_urlquery) else l.last_page_urlquery end as last_page_urlquery\n    , case when l.last_page_url is null then coalesce(l.last_page_urlfragment, f.page_urlfragment) else l.last_page_urlfragment end as last_page_urlfragment\n    , f.refr_urlscheme\n    , f.refr_urlhost\n    , f.refr_urlpath\n    , f.refr_urlquery\n    , f.refr_urlfragment\n    , f.br_renderengine\n    , f.br_lang as first_br_lang\n    , f.br_lang_name as first_br_lang_name\n    , case when l.last_br_lang is null then coalesce(l.last_br_lang, f.br_lang) else l.last_br_lang end as last_br_lang\n    , case when l.last_br_lang is null then coalesce(l.last_br_lang_name, f.br_lang_name) else l.last_br_lang_name end as last_br_lang_name\n  \n\n  -- iab enrichment fields\n  \n    \n\n    , f.iab__category\n    , f.iab__primary_impact\n    , f.iab__reason\n    , f.iab__spider_or_robot\n\n\n  \n\n  -- yauaa enrichment fields\n  \n    \n\n    , f.yauaa__device_class\n    , f.yauaa__agent_class\n    , f.yauaa__agent_name\n    , f.yauaa__agent_name_version\n    , f.yauaa__agent_name_version_major\n    , f.yauaa__agent_version\n    , f.yauaa__agent_version_major\n    , f.yauaa__device_brand\n    , f.yauaa__device_name\n    , f.yauaa__device_version\n    , f.yauaa__layout_engine_class\n    , f.yauaa__layout_engine_name\n    , f.yauaa__layout_engine_name_version\n    , f.yauaa__layout_engine_name_version_major\n    , f.yauaa__layout_engine_version\n    , f.yauaa__layout_engine_version_major\n    , f.yauaa__operating_system_class\n    , f.yauaa__operating_system_name\n    , f.yauaa__operating_system_name_version\n    , f.yauaa__operating_system_version\n\n\n  \n\n  -- ua parser enrichment fields\n  \n    \n\n      , f.ua__useragent_family\n      , f.ua__useragent_major\n      , f.ua__useragent_minor\n      , f.ua__useragent_patch\n      , f.ua__useragent_version\n      , f.ua__os_family\n      , f.ua__os_major\n      , f.ua__os_minor\n      , f.ua__os_patch\n      , f.ua__os_patch_minor\n      , f.ua__os_version\n      , f.ua__device_family\n\n\n  \n\n  -- mobile only\n  \n    , f.screen_view__name as first_screen_view__name\n    , f.screen_view__type as first_screen_view__type\n    , case when l.last_screen_view__name is null then coalesce(l.last_screen_view__name, f.screen_view__name) else l.last_screen_view__name end as last_screen_view__name\n    , case when l.last_screen_view__transition_type is null then coalesce(l.last_screen_view__transition_type, f.screen_view__transition_type) else l.last_screen_view__transition_type end as last_screen_view__transition_type\n    , case when l.last_screen_view__type is null then coalesce(l.last_screen_view__type, f.screen_view__type) else l.last_screen_view__type end as last_screen_view__type\n    , f.screen_view__previous_id\n    , f.screen_view__previous_name\n    , f.screen_view__previous_type\n\n  \n\n  \n    \n\n  , f.app__build as first_app__build\n  , f.app__version as first_app__version\n\n\n  \n\n  \n    \n\n    , f.geo__latitude as first_geo__latitude \n    , f.geo__longitude as first_geo__longitude \n    , f.geo__latitude_longitude_accuracy as first_geo__latitude_longitude_accuracy \n    , f.geo__altitude as first_geo__altitude \n    , f.geo__altitude_accuracy as first_geo__altitude_accuracy \n    , f.geo__bearing as first_geo__bearing \n    , f.geo__speed as first_geo__speed \n\n\n  \n\n  \n    , f.screen__fragment\n    , f.screen__top_view_controller\n    , f.screen__view_controller\n  \n\n  \n    , a.app_errors\n    , a.fatal_app_errors\n  \n\n  , f.useragent\n\n  -- conversion fields\n      \n\n\n\n,coalesce(cv_view_page_volume, 0) as cv_view_page_volume\n,coalesce(cv_view_page_events, []) as cv_view_page_events\n,coalesce(cv_view_page_values, []) as cv_view_page_values\n,coalesce(cv_view_page_total, 0) as cv_view_page_total\n,cv_view_page_first_conversion\n,coalesce(cv_view_page_converted, false) as cv_view_page_converted\n\n    \n      , coalesce(cv_view_page_volume,0) as cv__all_volume\n      \n      ,0 + coalesce(cv_view_page_total, 0) as cv__all_total\n    \n\n  -- passthrough fields\n          , f.event_id\n          , f.event_id2\n\n  \n    \n      , a.agg_test\n    \n  \n\nfrom session_firsts f\n\nleft join session_lasts l\non f.session_identifier = l.session_identifier\n\n\n\nleft join session_aggs_with_engaged_time a\non f.session_identifier = a.session_identifier\nleft join session_convs d on f.session_identifier = d.session_identifier\n\n    -- if the language uses a two letter code we can match on that\n  left join SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snowplow_manifest.snowplow_unified_dim_iso_639_2t iso_639_2t_2_char on lower(f.mobile__language) = lower(iso_639_2t_2_char.iso_639_1_code)\n    -- if the language uses a three letter code we can match on that\n  left join SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snowplow_manifest.snowplow_unified_dim_iso_639_2t iso_639_2t_3_char on lower(f.mobile__language) = lower(iso_639_2t_3_char.iso_639_2t_code)\n  -- A fallback to the three letter code, with a more complete list, we first try to join on the other dataset the three letter code\n  -- in order to get a language name that will match the mapping of the two letter code\n  left join iso_639_3_deduped iso_639_3 on lower(f.mobile__language) = lower(iso_639_3.iso_639_3_code)\n    and iso_639_3.row_num = 1\n", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_sessions_this_run", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.094965Z", "completed_at": "2026-01-20T14:49:11.102059Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.103383Z", "completed_at": "2026-01-20T14:49:11.103393Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009748458862304688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_app_errors_this_run_user_identifier.0d35170908", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_identifier\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_app_errors_this_run\nwhere user_identifier is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.107211Z", "completed_at": "2026-01-20T14:49:11.124318Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.125153Z", "completed_at": "2026-01-20T14:49:11.125166Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.020682096481323242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_app_errors_this_run_event_id.27c49e9797", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_app_errors_this_run\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:10.942791Z", "completed_at": "2026-01-20T14:49:11.138861Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.139520Z", "completed_at": "2026-01-20T14:49:11.139531Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.2518491744995117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_user_mapping", "compiled": true, "compiled_code": "\n\n\n\n\nselect distinct\n  user_identifier,\n  last_value(user_id) over(\n    partition by user_identifier\n    order by collector_tstamp\n    rows between unbounded preceding and unbounded following\n  ) as user_id,\n  max(collector_tstamp) over (partition by user_identifier) as end_tstamp\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_events_this_run\n\nwhere cast(True as boolean) --returns false if run doesn't contain new events.\nand user_id is not null\nand user_identifier is not null", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_user_mapping", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.132387Z", "completed_at": "2026-01-20T14:49:11.147748Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.148573Z", "completed_at": "2026-01-20T14:49:11.148586Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.020619869232177734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_pv_engaged_time_session_identifier.369fb4dedc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_identifier\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_pv_engaged_time\nwhere session_identifier is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.142319Z", "completed_at": "2026-01-20T14:49:11.150210Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.151654Z", "completed_at": "2026-01-20T14:49:11.151670Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010691404342651367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_pv_engaged_time_view_id.fab3bfc907", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect view_id\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_pv_engaged_time\nwhere view_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.153889Z", "completed_at": "2026-01-20T14:49:11.161961Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.177924Z", "completed_at": "2026-01-20T14:49:11.177939Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02718329429626465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_pv_engaged_time__view_id_session_identifier_.f0fca93783", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    (view_id || '-' || session_identifier) as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_pv_engaged_time\nwhere (view_id || '-' || session_identifier) is not null\ngroup by (view_id || '-' || session_identifier)\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.186133Z", "completed_at": "2026-01-20T14:49:11.204732Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.206637Z", "completed_at": "2026-01-20T14:49:11.206653Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.021879196166992188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_pv_scroll_depth_view_id.0e2d9dba7d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect view_id\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_pv_scroll_depth\nwhere view_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.162611Z", "completed_at": "2026-01-20T14:49:11.207548Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.210492Z", "completed_at": "2026-01-20T14:49:11.210504Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05018973350524902, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_views_this_run", "compiled": true, "compiled_code": "\n\n\n\nwith prep as (\n  select\n\n    \n\n    -- event categorization fields\n    ev.event_name,\n    ev.user_id,\n    ev.user_identifier,\n    ev.network_userid,\n\n    -- timestamp fields\n    ev.dvce_created_tstamp,\n    ev.collector_tstamp,\n    ev.derived_tstamp,\n    ev.derived_tstamp as start_tstamp,\n\n    -- geo fields\n    ev.geo_country,\n    ev.geo_region,\n    ev.geo_region_name,\n    ev.geo_city,\n    ev.geo_zipcode,\n    ev.geo_latitude,\n    ev.geo_longitude,\n    ev.geo_timezone,\n    ev.user_ipaddress,\n\n    -- device fields\n    ev.app_id,\n    ev.platform,\n    ev.device_identifier,\n    ev.device_category,\n    ev.device_session_index,\n    ev.os_version,\n    ev.os_type,\n    ev.screen_resolution,\n\n    -- marketing fields\n    ev.mkt_medium,\n    ev.mkt_source,\n    ev.mkt_term,\n    ev.mkt_content,\n    ev.mkt_campaign,\n    ev.mkt_clickid,\n    ev.mkt_network,\n    \n\n\n\n\ncase\n   when lower(trim(\n   \n      mkt_source\n   \n)) = 'direct' and lower(trim(\n   \n      mkt_medium\n   \n)) in ('not set', 'none') then 'Direct'\n   when lower(trim(\n   \n      mkt_medium\n   \n)) like '%cross-network%' then 'Cross-network'\n   when regexp_like(lower(trim(\n   \n      mkt_medium\n   \n)), '^(.*cp.*|ppc|retargeting|paid.*)$') then\n      case\n         when upper(source_category) = 'SOURCE_CATEGORY_SHOPPING'\n            or regexp_like(lower(trim(mkt_campaign)), '^(.*(([^a-df-z]|^)shop|shopping).*)$') then 'Paid Shopping'\n         when upper(source_category) = 'SOURCE_CATEGORY_SEARCH' then 'Paid Search'\n         when upper(source_category) = 'SOURCE_CATEGORY_SOCIAL' then 'Paid Social'\n         when upper(source_category) = 'SOURCE_CATEGORY_VIDEO' then 'Paid Video'\n         else 'Paid Other'\n      end\n   when lower(trim(\n   \n      mkt_medium\n   \n)) in ('display', 'banner', 'expandable', 'intersitial', 'cpm') then 'Display'\n   when upper(source_category) = 'SOURCE_CATEGORY_SHOPPING'\n      or regexp_like(lower(trim(mkt_campaign)), '^(.*(([^a-df-z]|^)shop|shopping).*)$') then 'Organic Shopping'\n   when upper(source_category) = 'SOURCE_CATEGORY_SOCIAL' or lower(trim(\n   \n      mkt_medium\n   \n)) in ('social', 'social-network', 'sm', 'social network', 'social media') then 'Organic Social'\n   when upper(source_category) = 'SOURCE_CATEGORY_VIDEO'\n      or regexp_like(lower(trim(\n   \n      mkt_medium\n   \n)), '^(.*video.*)$') then 'Organic Video'\n   when upper(source_category) = 'SOURCE_CATEGORY_SEARCH' or lower(trim(\n   \n      mkt_medium\n   \n)) = 'organic' then 'Organic Search'\n   when lower(trim(\n   \n      mkt_medium\n   \n)) in ('referral', 'app', 'link') then 'Referral'\n   when lower(trim(\n   \n      mkt_source\n   \n)) in ('email', 'e-mail', 'e_mail', 'e mail') or lower(trim(\n   \n      mkt_medium\n   \n)) in ('email', 'e-mail', 'e_mail', 'e mail') then 'Email'\n   when lower(trim(\n   \n      mkt_medium\n   \n)) = 'affiliate' then 'Affiliates'\n   when lower(trim(\n   \n      mkt_medium\n   \n)) = 'audio' then 'Audio'\n   when lower(trim(\n   \n      mkt_medium\n   \n)) = 'chatbot' then 'Chatbot'\n   when lower(trim(\n   \n      mkt_source\n   \n)) = 'sms' or lower(trim(\n   \n      mkt_medium\n   \n)) = 'sms' then 'SMS'\n   when lower(trim(\n   \n      mkt_medium\n   \n)) like '%push' or regexp_like(lower(trim(\n   \n      mkt_medium\n   \n)), '.*(mobile|notification).*') or lower(trim(\n   \n      mkt_source\n   \n)) = 'firebase' then 'Mobile Push Notifications'\n   else 'Unassigned'\nend\n as default_channel_group,\n\n    -- webpage / referer / browser fields\n    ev.page_url,\n    ev.page_referrer,\n    ev.refr_medium,\n    ev.refr_source,\n    ev.refr_term,\n    ev.useragent\n\n\n    , view_id\n    , session_identifier\n    , event_id\n\n\n    \n      \n\n      , ev.br_lang\n      , ev.br_viewwidth\n      , ev.br_viewheight\n      , ev.br_renderengine\n      , ev.doc_width\n      , ev.doc_height\n      , ev.page_title\n      , ev.page_urlscheme\n      , ev.page_urlhost\n      , ev.page_urlpath\n      , ev.page_urlquery\n      , ev.page_urlfragment\n      , ev.refr_urlscheme\n      , ev.refr_urlhost\n      , ev.refr_urlpath\n      , ev.refr_urlquery\n      , ev.refr_urlfragment\n      , ev.os_timezone\n\n\n      , \n  case when ev.view_id = 'ff8cc048-afe8-4913-843d-37de6b7d87d0' then 'Look no further, I am the test subject!'\n      when ev.page_url like '%/product%' then 'PDP'\n      when ev.page_url like '%/list%' then 'PLP'\n      when ev.page_url like '%/checkout%' then 'checkout'\n      when ev.page_url like '%/home%' then 'homepage'\n      else 'other'\n  end\n as content_group\n      , coalesce(\n      \n        cast(ev.browser__color_depth as TEXT),\n      \n      null) as br_colordepth\n    \n\n    \n     \n\n  , ev.session__previous_session_id\n  , ev.screen_view__name\n  , ev.screen_view__previous_id\n  , ev.screen_view__previous_name\n  , ev.screen_view__previous_type\n  , ev.screen_view__transition_type\n  , ev.screen_view__type\n\n\n    \n\n    \n      -- updated with mapping as part of post hook on derived page_views table\n      , cast(ev.user_identifier as \n    TEXT\n) as stitched_user_id\n    \n\n    \n      \n\n    , ev.iab__category\n    , ev.iab__primary_impact\n    , ev.iab__reason\n    , ev.iab__spider_or_robot\n\n\n    \n\n    \n      \n\n    , ev.yauaa__device_class\n    , ev.yauaa__agent_class\n    , ev.yauaa__agent_name\n    , ev.yauaa__agent_name_version\n    , ev.yauaa__agent_name_version_major\n    , ev.yauaa__agent_version\n    , ev.yauaa__agent_version_major\n    , ev.yauaa__device_brand\n    , ev.yauaa__device_name\n    , ev.yauaa__device_version\n    , ev.yauaa__layout_engine_class\n    , ev.yauaa__layout_engine_name\n    , ev.yauaa__layout_engine_name_version\n    , ev.yauaa__layout_engine_name_version_major\n    , ev.yauaa__layout_engine_version\n    , ev.yauaa__layout_engine_version_major\n    , ev.yauaa__operating_system_class\n    , ev.yauaa__operating_system_name\n    , ev.yauaa__operating_system_name_version\n    , ev.yauaa__operating_system_version\n\n\n    \n\n    \n      \n\n      , ev.ua__useragent_family\n      , ev.ua__useragent_major\n      , ev.ua__useragent_minor\n      , ev.ua__useragent_patch\n      , ev.ua__useragent_version\n      , ev.ua__os_family\n      , ev.ua__os_major\n      , ev.ua__os_minor\n      , ev.ua__os_patch\n      , ev.ua__os_patch_minor\n      , ev.ua__os_version\n      , ev.ua__device_family\n\n\n    \n\n    \n      \n\n  , ev.app__build\n  , ev.app__version\n\n\n    \n\n    \n      \n\n    , ev.geo__latitude\n    , ev.geo__longitude\n    , ev.geo__latitude_longitude_accuracy\n    , ev.geo__altitude\n    , ev.geo__altitude_accuracy\n    , ev.geo__bearing\n    , ev.geo__speed\n\n\n    \n\n    \n      \n\n      , ev.screen__id\n      , ev.screen__name\n      , ev.screen__activity\n      , ev.screen__fragment\n      , ev.screen__top_view_controller\n      , ev.screen__type\n      , ev.screen__view_controller\n\n\n    \n\n    \n      \n\n    , ev.mobile__device_manufacturer\n    , ev.mobile__device_model\n    , ev.mobile__os_type\n    , ev.mobile__os_version\n    , ev.mobile__android_idfa\n    , ev.mobile__apple_idfa\n    , ev.mobile__apple_idfv\n    , ev.mobile__carrier\n    , ev.mobile__open_idfa\n    , ev.mobile__network_technology\n    , ev.mobile__network_type\n    , ev.mobile__physical_memory\n    , ev.mobile__system_available_memory\n    , ev.mobile__app_available_memory\n    , ev.mobile__battery_level\n    , ev.mobile__battery_state\n    , ev.mobile__low_power_mode\n    , ev.mobile__available_storage\n    , ev.mobile__total_storage\n    , ev.mobile__is_portrait\n    , ev.mobile__resolution\n    , ev.mobile__scale\n    , ev.mobile__language\n    , ev.mobile__app_set_id\n    , ev.mobile__app_set_id_scope\n\n\n    \n\n    \n      ,ev.v_collector\n      ,event_id as event_id2\n\n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_events_this_run as ev\n\n    left join SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snowplow_manifest.snowplow_unified_dim_ga4_source_categories c on \n      \n        lower(trim(ev.mkt_source)) = lower(c.source)\n      \n\n    where ev.event_name in ('page_view', 'screen_view')\n    and ev.view_id is not null\n\n    \n      \n  \n    and coalesce(iab__spider_or_robot, False ) = False\n  \n  and not rlike(ev.useragent, '.*(bot|crawl|slurp|spider|archiv|spinn|sniff|seo|audit|survey|pingdom|worm|capture|(browser|screen)shots|analyz|index|thumb|check|facebook|PingdomBot|PhantomJS|YandexBot|Twitterbot|a_archiver|facebookexternalhit|Bingbot|BingPreview|Googlebot|Baiduspider|360(Spider|User-agent)|semalt).*')\n\n    \n\n    \n      qualify row_number() over (partition by ev.view_id order by ev.derived_tstamp, ev.dvce_created_tstamp) = 1\n    \n)\n\n\n, view_aggs as (\n  select \n    view_id\n    , session_identifier\n    \n      , \n  \n  \n  \n\n  \n  \n  \n    count(case when event_name = 'page_view' then 1 else null end) as agg_test\n  \n\n\n    \n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_events_this_run as ev\n    where 1=1 \n    \n      \n  \n    and coalesce(iab__spider_or_robot, False ) = False\n  \n  and not rlike(ev.useragent, '.*(bot|crawl|slurp|spider|archiv|spinn|sniff|seo|audit|survey|pingdom|worm|capture|(browser|screen)shots|analyz|index|thumb|check|facebook|PingdomBot|PhantomJS|YandexBot|Twitterbot|a_archiver|facebookexternalhit|Bingbot|BingPreview|Googlebot|Baiduspider|360(Spider|User-agent)|semalt).*')\n\n    \n    group by 1, 2\n  \n)\n\n\n, view_events as (\n  select\n\n    p.*\n\n    , row_number() over (partition by p.session_identifier order by p.derived_tstamp, p.dvce_created_tstamp, p.event_id) AS view_in_session_index\n\n    , coalesce(t.end_tstamp, p.derived_tstamp) as end_tstamp -- only page views with pings will have a row in table t\n\n    \n      , coalesce(t.engaged_time_in_s, 0) as engaged_time_in_s -- where there are no pings, engaged time is 0.\n      , coalesce(\n        t.absolute_time_in_s,\n        datediff(\n        second,\n        p.derived_tstamp,\n        coalesce(t.end_tstamp, p.derived_tstamp)\n        )\n      ) as absolute_time_in_s\n      , sd.hmax as horizontal_pixels_scrolled\n      , sd.vmax as vertical_pixels_scrolled\n      , sd.relative_hmax as horizontal_percentage_scrolled\n      , sd.relative_vmax as vertical_percentage_scrolled\n    \n    \n\n    , \n    convert_timezone('UTC', convert_timezone('UTC', current_timestamp()))::timestamp\n as model_tstamp\n\n  from prep p\n\n  left join SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_pv_engaged_time t\n  on p.view_id = t.view_id and p.session_identifier = t.session_identifier\n\n  left join SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_pv_scroll_depth sd\n  on p.view_id = sd.view_id and p.session_identifier = sd.session_identifier\n\n  \n\n)\n\nselect\n\n    -- event categorization fields\n    pve.view_id\n    , pve.event_name\n    , pve.event_id\n    , pve.session_identifier\n    , pve.view_in_session_index\n    , max(pve.view_in_session_index) over (partition by pve.session_identifier) as views_in_session\n\n    -- user id fields\n    , pve.user_id\n    , pve.user_identifier\n    , pve.stitched_user_id\n    , pve.network_userid\n\n    -- timestamp fields\n    , pve.dvce_created_tstamp\n    , pve.collector_tstamp\n    , pve.derived_tstamp\n    , pve.derived_tstamp as start_tstamp\n    , pve.end_tstamp -- only page views with pings will have a row in table t\n    , pve.model_tstamp\n\n    -- device fields\n    , pve.app_id\n    , pve.platform\n    , pve.device_identifier\n    , pve.device_category\n    , pve.device_session_index\n    , pve.os_version\n    , pve.os_type\n    \n      \n\n    , pve.mobile__device_manufacturer\n    , pve.mobile__device_model\n    , pve.mobile__os_type\n    , pve.mobile__os_version\n    , pve.mobile__android_idfa\n    , pve.mobile__apple_idfa\n    , pve.mobile__apple_idfv\n    , pve.mobile__carrier\n    , pve.mobile__open_idfa\n    , pve.mobile__network_technology\n    , pve.mobile__network_type\n    , pve.mobile__physical_memory\n    , pve.mobile__system_available_memory\n    , pve.mobile__app_available_memory\n    , pve.mobile__battery_level\n    , pve.mobile__battery_state\n    , pve.mobile__low_power_mode\n    , pve.mobile__available_storage\n    , pve.mobile__total_storage\n    , pve.mobile__is_portrait\n    , pve.mobile__resolution\n    , pve.mobile__scale\n    , pve.mobile__language\n    , pve.mobile__app_set_id\n    , pve.mobile__app_set_id_scope\n\n\n    \n    , pve.screen_resolution\n\n    -- geo fields\n    , pve.geo_country\n    , pve.geo_region\n    , pve.geo_region_name\n    , pve.geo_city\n    , pve.geo_zipcode\n    , pve.geo_latitude\n    , pve.geo_longitude\n    , pve.geo_timezone\n    , pve.user_ipaddress\n\n    -- engagement fields\n    \n      , pve.engaged_time_in_s -- where there are no pings, engaged time is 0.\n      , pve.absolute_time_in_s\n      , pve.horizontal_pixels_scrolled\n      , pve.vertical_pixels_scrolled\n      , pve.horizontal_percentage_scrolled\n      , pve.vertical_percentage_scrolled\n    \n    \n\n    -- marketing fields\n    , pve.mkt_medium\n    , pve.mkt_source\n    , pve.mkt_term\n    , pve.mkt_content\n    , pve.mkt_campaign\n    , pve.mkt_clickid\n    , pve.mkt_network\n    , pve.default_channel_group\n\n    -- webpage / referer / browser fields\n    , pve.page_url\n    , pve.page_referrer\n    , pve.refr_medium\n    , pve.refr_source\n    , pve.refr_term\n\n    \n      , br_colordepth\n      \n\n      , pve.br_lang\n      , pve.br_viewwidth\n      , pve.br_viewheight\n      , pve.br_renderengine\n      , pve.doc_width\n      , pve.doc_height\n      , pve.page_title\n      , pve.page_urlscheme\n      , pve.page_urlhost\n      , pve.page_urlpath\n      , pve.page_urlquery\n      , pve.page_urlfragment\n      , pve.refr_urlscheme\n      , pve.refr_urlhost\n      , pve.refr_urlpath\n      , pve.refr_urlquery\n      , pve.refr_urlfragment\n      , pve.os_timezone\n\n\n      , content_group\n    \n\n    -- iab enrichment fields\n    \n      \n\n    , pve.iab__category\n    , pve.iab__primary_impact\n    , pve.iab__reason\n    , pve.iab__spider_or_robot\n\n\n    \n\n    -- yauaa enrichment fields\n    \n      \n\n    , pve.yauaa__device_class\n    , pve.yauaa__agent_class\n    , pve.yauaa__agent_name\n    , pve.yauaa__agent_name_version\n    , pve.yauaa__agent_name_version_major\n    , pve.yauaa__agent_version\n    , pve.yauaa__agent_version_major\n    , pve.yauaa__device_brand\n    , pve.yauaa__device_name\n    , pve.yauaa__device_version\n    , pve.yauaa__layout_engine_class\n    , pve.yauaa__layout_engine_name\n    , pve.yauaa__layout_engine_name_version\n    , pve.yauaa__layout_engine_name_version_major\n    , pve.yauaa__layout_engine_version\n    , pve.yauaa__layout_engine_version_major\n    , pve.yauaa__operating_system_class\n    , pve.yauaa__operating_system_name\n    , pve.yauaa__operating_system_name_version\n    , pve.yauaa__operating_system_version\n\n\n    \n\n    -- ua parser enrichment fields\n    \n      \n\n      , pve.ua__useragent_family\n      , pve.ua__useragent_major\n      , pve.ua__useragent_minor\n      , pve.ua__useragent_patch\n      , pve.ua__useragent_version\n      , pve.ua__os_family\n      , pve.ua__os_major\n      , pve.ua__os_minor\n      , pve.ua__os_patch\n      , pve.ua__os_patch_minor\n      , pve.ua__os_version\n      , pve.ua__device_family\n\n\n    \n\n    -- mobile only\n    \n      \n\n  , pve.session__previous_session_id\n  , pve.screen_view__name\n  , pve.screen_view__previous_id\n  , pve.screen_view__previous_name\n  , pve.screen_view__previous_type\n  , pve.screen_view__transition_type\n  , pve.screen_view__type\n\n\n    \n\n    \n      \n\n  , pve.app__build\n  , pve.app__version\n\n\n    \n\n    \n      \n\n    , pve.geo__latitude\n    , pve.geo__longitude\n    , pve.geo__latitude_longitude_accuracy\n    , pve.geo__altitude\n    , pve.geo__altitude_accuracy\n    , pve.geo__bearing\n    , pve.geo__speed\n\n\n    \n\n    \n      , pve.screen__fragment\n      , pve.screen__top_view_controller\n      , pve.screen__view_controller\n    \n\n    , pve.useragent\n        , pve.v_collector\n        , pve.event_id2\n\n    \n      \n        , a.agg_test\n      \n    \n\nfrom view_events pve\n\n  left join view_aggs a on pve.session_identifier = a.session_identifier and pve.view_id = a.view_id\n", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_views_this_run", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:10.991016Z", "completed_at": "2026-01-20T14:49:11.212208Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.214578Z", "completed_at": "2026-01-20T14:49:11.214590Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.22504401206970215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_app_errors", "compiled": true, "compiled_code": "\n\n\n\n\nselect *\n  \nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_app_errors_this_run\nwhere cast(True as boolean) --returns false if run doesn't contain new events.", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_app_errors", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.216101Z", "completed_at": "2026-01-20T14:49:11.224071Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.232185Z", "completed_at": "2026-01-20T14:49:11.232197Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.020760059356689453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_pv_scroll_depth__view_id_session_identifier_.009d0ff70e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    (view_id || '-' || session_identifier) as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_pv_scroll_depth\nwhere (view_id || '-' || session_identifier) is not null\ngroup by (view_id || '-' || session_identifier)\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.224709Z", "completed_at": "2026-01-20T14:49:11.238258Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.239810Z", "completed_at": "2026-01-20T14:49:11.239821Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.024439334869384766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_web_vitals_this_run", "compiled": true, "compiled_code": "\n\n\n\nwith prep as (\n\n  select\n    e.event_id,\n    e.event_name,\n    e.app_id,\n    e.platform,\n    e.user_identifier,\n    e.user_id,\n    e.view_id,\n    e.session_identifier,\n    e.collector_tstamp,\n    e.derived_tstamp,\n    e.load_tstamp,\n    coalesce(e.geo_country, 'unknown_geo_country') as geo_country,\n    coalesce(e.page_url, 'unknown_page_url') as page_url,\n    \n\n  case when page_url like '%/product%' then 'PDP'\n      when page_url like '%/list%' then 'PLP'\n      when page_url like '%/checkout%' then 'checkout'\n      when page_url like '%/home%' then 'homepage'\n      else 'other' end\n\n as url_group,\n    e.page_title,\n    e.useragent,\n    coalesce(e.device_class, 'unknown_device_class') as device_class,\n    e.device_name,\n    e.agent_name,\n    e.agent_version,\n    e.operating_system_name,\n    e.lcp,\n    e.fcp,\n    e.fid,\n    e.cls,\n    e.inp,\n    e.ttfb,\n    e.navigation_type,\n    row_number() over (partition by e.view_id order by e.derived_tstamp, e.dvce_created_tstamp, e.event_id) dedupe_index\n\n  from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_web_vital_events_this_run as e\n\n  where True --returns false if run doesn't contain new events.\n\n\n)\n\nselect\n  *,\n  \n  case when lcp is null then 'not measurable'\n    when  lcp < 2.5 then 'good'\n    when lcp < 4 then 'needs improvement'\n    else 'poor' end as lcp_result,\n\n  case when fid is null then 'not measurable'\n    when fid < 100 then 'good'\n    when fid < 300 then 'needs improvement'\n    else 'poor' end as fid_result,\n\n  case when cls is null then 'not measurable'\n    when cls < 0.1 then 'good'\n    when cls < 0.25 then 'needs improvement'\n    else 'poor' end as cls_result,\n\n  case when ttfb is null then 'not measurable'\n    when ttfb < 800 then 'good'\n    when ttfb < 1800 then 'needs improvement'\n    else 'poor' end as ttfb_result,\n\n  case when inp is null then 'not measurable'\n    when inp < 200 then 'good'\n    when inp < 500 then 'needs improvement'\n    else 'poor' end as inp_result\n\n\n\nfrom prep p\n\nwhere dedupe_index = 1", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_web_vitals_this_run", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.233211Z", "completed_at": "2026-01-20T14:49:11.241400Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.243477Z", "completed_at": "2026-01-20T14:49:11.243493Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.020178556442260742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_web_vital_events_this_run_event_id.e5bc4bf41e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_web_vital_events_this_run\nwhere event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.245002Z", "completed_at": "2026-01-20T14:49:11.253397Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.259787Z", "completed_at": "2026-01-20T14:49:11.259798Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.019132137298583984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_web_vital_events_this_run_page_url.febc36e022", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect page_url\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_web_vital_events_this_run\nwhere page_url is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.254020Z", "completed_at": "2026-01-20T14:49:11.265914Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.267444Z", "completed_at": "2026-01-20T14:49:11.267460Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.023189544677734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_web_vital_events_this_run_event_id.e1799e0876", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_web_vital_events_this_run\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.260841Z", "completed_at": "2026-01-20T14:49:11.269716Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.271670Z", "completed_at": "2026-01-20T14:49:11.271682Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.019036293029785156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_sessions_this_run_absolute_time_in_s.5768c67caa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect absolute_time_in_s\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_sessions_this_run\nwhere absolute_time_in_s is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.272551Z", "completed_at": "2026-01-20T14:49:11.286352Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.289824Z", "completed_at": "2026-01-20T14:49:11.289837Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.021569013595581055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_sessions_this_run_device_session_index.5c2b86a93c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_session_index\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_sessions_this_run\nwhere device_session_index is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.280393Z", "completed_at": "2026-01-20T14:49:11.289184Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.297661Z", "completed_at": "2026-01-20T14:49:11.297673Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.026765108108520508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_sessions_this_run_end_tstamp.07dd45d070", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect end_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_sessions_this_run\nwhere end_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.113633Z", "completed_at": "2026-01-20T14:49:11.299536Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.302235Z", "completed_at": "2026-01-20T14:49:11.302247Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.1957390308380127, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_consent_log", "compiled": true, "compiled_code": "\n\n\n\nselect\n  *\n  \n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_consent_events_this_run\n\nwhere cast(True as boolean) --returns false if run doesn't contain new events.", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_log", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.290761Z", "completed_at": "2026-01-20T14:49:11.300959Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.303809Z", "completed_at": "2026-01-20T14:49:11.303821Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.01817178726196289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_sessions_this_run_engaged_time_in_s.98c95134a4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engaged_time_in_s\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_sessions_this_run\nwhere engaged_time_in_s is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.307557Z", "completed_at": "2026-01-20T14:49:11.322259Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.333942Z", "completed_at": "2026-01-20T14:49:11.333958Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03248119354248047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_sessions_this_run_is_engaged.32ff9493b2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect is_engaged\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_sessions_this_run\nwhere is_engaged is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.313720Z", "completed_at": "2026-01-20T14:49:11.327948Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.335162Z", "completed_at": "2026-01-20T14:49:11.335173Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03211236000061035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_sessions_this_run_session_identifier.38695dce6d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_identifier\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_sessions_this_run\nwhere session_identifier is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.322929Z", "completed_at": "2026-01-20T14:49:11.336280Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.338921Z", "completed_at": "2026-01-20T14:49:11.338933Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.026293277740478516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_sessions_this_run_start_tstamp.4b70415d30", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect start_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_sessions_this_run\nwhere start_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.328729Z", "completed_at": "2026-01-20T14:49:11.337642Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.340551Z", "completed_at": "2026-01-20T14:49:11.340562Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.020593643188476562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_sessions_this_run_total_events.29cffeca11", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_events\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_sessions_this_run\nwhere total_events is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.351143Z", "completed_at": "2026-01-20T14:49:11.373902Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.376712Z", "completed_at": "2026-01-20T14:49:11.376728Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03538918495178223, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_sessions_this_run_session_identifier.9866ae020a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    session_identifier as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_sessions_this_run\nwhere session_identifier is not null\ngroup by session_identifier\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.345359Z", "completed_at": "2026-01-20T14:49:11.374676Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.377646Z", "completed_at": "2026-01-20T14:49:11.377657Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.037862539291381836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_sessions_this_run_views.e8617150ef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect views\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_sessions_this_run\nwhere views is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.368812Z", "completed_at": "2026-01-20T14:49:11.380973Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.383021Z", "completed_at": "2026-01-20T14:49:11.383032Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.03268289566040039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_user_mapping_end_tstamp.8930fbf647", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect end_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_user_mapping\nwhere end_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.386567Z", "completed_at": "2026-01-20T14:49:11.403863Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.404873Z", "completed_at": "2026-01-20T14:49:11.404890Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02267622947692871, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_user_mapping_user_id.0fb58f2762", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_user_mapping\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.392540Z", "completed_at": "2026-01-20T14:49:11.405778Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.407226Z", "completed_at": "2026-01-20T14:49:11.407241Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.023396968841552734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_user_mapping_user_identifier.fc04955624", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_identifier\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_user_mapping\nwhere user_identifier is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.398768Z", "completed_at": "2026-01-20T14:49:11.408180Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.410137Z", "completed_at": "2026-01-20T14:49:11.410148Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.018491029739379883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_user_mapping_user_identifier.35e726d1ba", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_identifier as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_user_mapping\nwhere user_identifier is not null\ngroup by user_identifier\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.424904Z", "completed_at": "2026-01-20T14:49:11.432069Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.438713Z", "completed_at": "2026-01-20T14:49:11.438728Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02709197998046875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_views_this_run_absolute_time_in_s.960178ffa8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect absolute_time_in_s\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_views_this_run\nwhere absolute_time_in_s is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.433454Z", "completed_at": "2026-01-20T14:49:11.447824Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.448623Z", "completed_at": "2026-01-20T14:49:11.448635Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.024518489837646484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_views_this_run_collector_tstamp.98b0c0df1b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect collector_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_views_this_run\nwhere collector_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.441862Z", "completed_at": "2026-01-20T14:49:11.449542Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.450831Z", "completed_at": "2026-01-20T14:49:11.450843Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010344505310058594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_views_this_run_derived_tstamp.3270a2d7ef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect derived_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_views_this_run\nwhere derived_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.454279Z", "completed_at": "2026-01-20T14:49:11.465319Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.466180Z", "completed_at": "2026-01-20T14:49:11.466191Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.014544010162353516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_views_this_run_device_session_index.3c52b66c6d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_session_index\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_views_this_run\nwhere device_session_index is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.460176Z", "completed_at": "2026-01-20T14:49:11.475069Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.475803Z", "completed_at": "2026-01-20T14:49:11.475813Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.022237300872802734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_views_this_run_dvce_created_tstamp.19b30ff7fb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dvce_created_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_views_this_run\nwhere dvce_created_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.469105Z", "completed_at": "2026-01-20T14:49:11.478581Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.484556Z", "completed_at": "2026-01-20T14:49:11.484569Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.01691460609436035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_views_this_run_end_tstamp.4af862c0e6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect end_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_views_this_run\nwhere end_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.479157Z", "completed_at": "2026-01-20T14:49:11.487016Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.488240Z", "completed_at": "2026-01-20T14:49:11.488251Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011028051376342773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_views_this_run_engaged_time_in_s.efb00705e1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engaged_time_in_s\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_views_this_run\nwhere engaged_time_in_s is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.489144Z", "completed_at": "2026-01-20T14:49:11.495813Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.497030Z", "completed_at": "2026-01-20T14:49:11.497042Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.010801315307617188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_views_this_run_event_id.1cbbdc3adf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_views_this_run\nwhere event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.497932Z", "completed_at": "2026-01-20T14:49:11.504738Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.505918Z", "completed_at": "2026-01-20T14:49:11.505929Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010871171951293945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_views_this_run_session_identifier.59be3a100c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_identifier\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_views_this_run\nwhere session_identifier is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.506818Z", "completed_at": "2026-01-20T14:49:11.520005Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.520760Z", "completed_at": "2026-01-20T14:49:11.520772Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.016788482666015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_views_this_run_start_tstamp.c8c1676039", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect start_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_views_this_run\nwhere start_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.514915Z", "completed_at": "2026-01-20T14:49:11.523873Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.529677Z", "completed_at": "2026-01-20T14:49:11.529691Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01609039306640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_views_this_run_view_id.6bc7169d25", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect view_id\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_views_this_run\nwhere view_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.524670Z", "completed_at": "2026-01-20T14:49:11.537768Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.538543Z", "completed_at": "2026-01-20T14:49:11.538555Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.016083717346191406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_views_this_run_view_in_session_index.5ce5ac1b50", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect view_in_session_index\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_views_this_run\nwhere view_in_session_index is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.532691Z", "completed_at": "2026-01-20T14:49:11.546447Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.547153Z", "completed_at": "2026-01-20T14:49:11.547164Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.015880346298217773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_views_this_run_views_in_session.6dc8364a51", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect views_in_session\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_views_this_run\nwhere views_in_session is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.541606Z", "completed_at": "2026-01-20T14:49:11.555136Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.555919Z", "completed_at": "2026-01-20T14:49:11.555931Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.01583266258239746, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.snowplow_tests_view_in_session_values", "compiled": true, "compiled_code": "\n\n\nwith prep as (\n  select\n    session_identifier,\n    count(distinct views_in_session) as dist_pvis_values,\n    count(*) - count(distinct view_in_session_index)  as all_minus_dist_pvisi,\n    count(*) - count(distinct view_id) as all_minus_dist_pvids\n\n  from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_views_this_run\n  group by 1\n)\n\nselect\n  session_identifier\n\nfrom prep\n\nwhere dist_pvis_values != 1\nor all_minus_dist_pvisi != 0\nor all_minus_dist_pvids != 0", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.550021Z", "completed_at": "2026-01-20T14:49:11.558744Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.564384Z", "completed_at": "2026-01-20T14:49:11.564398Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01580071449279785, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_views_this_run_event_id.5609868632", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_views_this_run\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.559338Z", "completed_at": "2026-01-20T14:49:11.573770Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.574376Z", "completed_at": "2026-01-20T14:49:11.574385Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.016912221908569336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_views_this_run_view_id.5cfb771408", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    view_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_views_this_run\nwhere view_id is not null\ngroup by view_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.567397Z", "completed_at": "2026-01-20T14:49:11.686509Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.687894Z", "completed_at": "2026-01-20T14:49:11.687910Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.12188982963562012, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_app_errors_collector_tstamp.fd6db01a42", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect collector_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_app_errors\nwhere collector_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.577200Z", "completed_at": "2026-01-20T14:49:11.700983Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.708758Z", "completed_at": "2026-01-20T14:49:11.708770Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.13287019729614258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_app_errors_derived_tstamp.57ca9d9382", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect derived_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_app_errors\nwhere derived_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.359044Z", "completed_at": "2026-01-20T14:49:11.709928Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.712098Z", "completed_at": "2026-01-20T14:49:11.712111Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.36747241020202637, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_sessions", "compiled": true, "compiled_code": "\n\n\n\n\nselect *\n  \nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_sessions_this_run\nwhere cast(True as boolean) --returns false if run doesn't contain new events.", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_sessions", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.703267Z", "completed_at": "2026-01-20T14:49:11.711439Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.714273Z", "completed_at": "2026-01-20T14:49:11.714284Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.017477989196777344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_app_errors_dvce_created_tstamp.f8ea85c5e4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dvce_created_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_app_errors\nwhere dvce_created_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.413096Z", "completed_at": "2026-01-20T14:49:11.712995Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.715955Z", "completed_at": "2026-01-20T14:49:11.715967Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.30723047256469727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_views", "compiled": true, "compiled_code": "\n\n\n\n\nselect *\n  \nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_views_this_run\nwhere cast(True as boolean) --returns false if run doesn't contain new events.", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_views", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.720192Z", "completed_at": "2026-01-20T14:49:11.728408Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.741281Z", "completed_at": "2026-01-20T14:49:11.741296Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.02780604362487793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_app_errors_event_id.1927547c47", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_app_errors\nwhere event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.729030Z", "completed_at": "2026-01-20T14:49:11.748890Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.750870Z", "completed_at": "2026-01-20T14:49:11.750882Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03252053260803223, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_app_errors_model_tstamp.1dbf1b6723", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect model_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_app_errors\nwhere model_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.735890Z", "completed_at": "2026-01-20T14:49:11.750184Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.753023Z", "completed_at": "2026-01-20T14:49:11.753038Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.027590513229370117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_app_errors_network_userid.5f50553758", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect network_userid\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_app_errors\nwhere network_userid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.742364Z", "completed_at": "2026-01-20T14:49:11.751779Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.754637Z", "completed_at": "2026-01-20T14:49:11.754652Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.027724266052246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_app_errors_session_first_event_id.cc8700559f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_first_event_id\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_app_errors\nwhere session_first_event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.755555Z", "completed_at": "2026-01-20T14:49:11.763846Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.766278Z", "completed_at": "2026-01-20T14:49:11.766290Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.016792774200439453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_app_errors_session_identifier.3099f21f2c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_identifier\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_app_errors\nwhere session_identifier is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.767176Z", "completed_at": "2026-01-20T14:49:11.786086Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.788262Z", "completed_at": "2026-01-20T14:49:11.788274Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.026617765426635742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_app_errors_session_index.0c20768315", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_index\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_app_errors\nwhere session_index is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.774488Z", "completed_at": "2026-01-20T14:49:11.787646Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.790410Z", "completed_at": "2026-01-20T14:49:11.790443Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02729511260986328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_app_errors_user_identifier.f874778b72", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_identifier\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_app_errors\nwhere user_identifier is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.780804Z", "completed_at": "2026-01-20T14:49:11.789809Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.801822Z", "completed_at": "2026-01-20T14:49:11.801836Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03690695762634277, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_app_errors_event_id.f6537234ea", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_app_errors\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.792162Z", "completed_at": "2026-01-20T14:49:11.805834Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.808325Z", "completed_at": "2026-01-20T14:49:11.808337Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.02162790298461914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_web_vitals", "compiled": true, "compiled_code": "\n\n\n\nselect\n  *\n  \n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_web_vitals_this_run\n\nwhere True --returns false if run doesn't contain new events.", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_web_vitals", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.809247Z", "completed_at": "2026-01-20T14:49:11.831965Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.835775Z", "completed_at": "2026-01-20T14:49:11.835793Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.032247304916381836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_consent_cmp_stats", "compiled": true, "compiled_code": "\n\nwith events as (\n\n  select\n    event_id,\n    user_identifier,\n    view_id,\n    session_identifier,\n    derived_tstamp,\n    event_name,\n    event_type,\n    cmp_load_time,\n    last_value(case when event_name = 'cmp_visible' then event_id else null end ignore nulls)\n    over (partition by user_identifier order by derived_tstamp\n    rows between unbounded preceding and current row) as cmp_id\n\n  from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_log\n\n  where event_type <> 'pending' or event_type is null\n\n), event_orders as (\n\n  select\n    event_id,\n    event_type,\n    cmp_id,\n    derived_tstamp,\n    row_number() over(partition by cmp_id order by derived_tstamp) as row_num\n\n  from events\n\n)\n\n, first_consent_events as (\n\n  select\n    event_id,\n    cmp_id,\n    event_type,\n    derived_tstamp as first_consent_event_tstamp\n\n  from event_orders\n\n  where row_num = 2\n\n)\n\n, cmp_events as (\n\n  select distinct\n    event_id,\n    user_identifier,\n    view_id,\n    session_identifier,\n    cmp_load_time,\n    derived_tstamp as cmp_tstamp\n\n  from events\n\n  where event_name = 'cmp_visible'\n\n)\n\nselect\n  e.event_id,\n  e.user_identifier,\n  e.view_id,\n  e.session_identifier,\n  e.cmp_load_time,\n  e.cmp_tstamp,\n  f.first_consent_event_tstamp,\n  f.event_type as first_consent_event_type,\n  datediff(\n        second,\n        e.cmp_tstamp,\n        f.first_consent_event_tstamp\n        ) as cmp_interaction_time\n\nfrom cmp_events e\n\nleft join first_consent_events f\non e.event_id = f.cmp_id", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_cmp_stats", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.825901Z", "completed_at": "2026-01-20T14:49:11.835122Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.837516Z", "completed_at": "2026-01-20T14:49:11.837528Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.030556201934814453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified_integration_tests.snowplow_unified_consent_log_actual", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n\n  event_id,\n  user_identifier,\n  user_id,\n  geo_country,\n  view_id,\n  session_identifier,\n  derived_tstamp,\n  load_tstamp,\n  event_name,\n  event_type,\n  basis_for_processing,\n  consent_url,\n  consent_version,\n  case when consent_scopes = '' then null else consent_scopes end as consent_scopes,\n  case when domains_applied = '' then null else domains_applied end as domains_applied,\n  gdpr_applies,\n  cmp_load_time\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_log", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_log_actual", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.839150Z", "completed_at": "2026-01-20T14:49:11.847781Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.854231Z", "completed_at": "2026-01-20T14:49:11.854244Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.021651268005371094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.accepted_values_snowplow_unified_consent_log_event_type__deny_all__allow_all__allow_selected__pending__implicit_consent__withdrawn__expired.0f024b208b", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        event_type as value_field,\n        count(*) as n_records\n\n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_log\n    group by event_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'deny_all','allow_all','allow_selected','pending','implicit_consent','withdrawn','expired'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.848968Z", "completed_at": "2026-01-20T14:49:11.860699Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.862126Z", "completed_at": "2026-01-20T14:49:11.862141Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.016656160354614258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_consent_log_event_id.d048b68e09", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_log\nwhere event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.855159Z", "completed_at": "2026-01-20T14:49:11.863693Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.865639Z", "completed_at": "2026-01-20T14:49:11.865650Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01929306983947754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_consent_log_event_id.cb11e5f422", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_log\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.867173Z", "completed_at": "2026-01-20T14:49:11.883210Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.892102Z", "completed_at": "2026-01-20T14:49:11.892122Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.0291593074798584, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_users_sessions_this_run", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n  a.*,\n  min(a.start_tstamp) over(partition by a.user_identifier) as user_start_tstamp,\n  max(a.end_tstamp) over(partition by a.user_identifier) as user_end_tstamp,\n  \n\n  max(case when platform = 'web' then true else false end) over(partition by user_identifier) as on_web,\n  max(case when platform <> 'web' then true else false end) over(partition by user_identifier) as on_mobile\n\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_sessions a\nwhere exists (select 1 from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_base_sessions_this_run b where a.user_identifier = b.user_identifier)", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_users_sessions_this_run", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.886775Z", "completed_at": "2026-01-20T14:49:11.895823Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.902179Z", "completed_at": "2026-01-20T14:49:11.902191Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.025593042373657227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_sessions_absolute_time_in_s.615acac3d6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect absolute_time_in_s\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_sessions\nwhere absolute_time_in_s is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.877399Z", "completed_at": "2026-01-20T14:49:11.901495Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.903193Z", "completed_at": "2026-01-20T14:49:11.903208Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.036756038665771484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified_integration_tests.snowplow_unified_sessions_actual", "compiled": true, "compiled_code": "\n\n\n-- Removing model_tstamp\n\nselect\n    -- just compare the string version for simplicity...\n    \n    cast(event_counts as \n    TEXT\n) as event_counts\n    \n\n\n    ,  cv_view_page_volume\n    \n    ,  cv_view_page_events\n    ,  cv_view_page_values\n    \n    ,  cv_view_page_total\n    ,  cv_view_page_first_conversion\n    ,  cv_view_page_converted\n    \n    ,  cv__all_volume\n    ,  cv__all_total\n    \n\n\n,first_event_name\n,last_event_name\n,session_identifier\n,session__previous_session_id\n,user_id\n,user_identifier\n,stitched_user_id\n,network_userid\n,start_tstamp\n,end_tstamp\n\n-- hard-coding due to non-deterministic outcome from row_number for Redshift/Postgres/databricks\n\n, app_id\n\n,platform\n,device_identifier\n,device_category\n,device_session_index\n,os_version\n,os_type\n,os_timezone\n,screen_resolution\n,yauaa__device_class\n,yauaa__device_version\n,yauaa__operating_system_version\n,yauaa__operating_system_class\n,yauaa__operating_system_name\n,yauaa__operating_system_name_version\n,mobile__device_manufacturer\n,mobile__device_model\n,mobile__os_type\n,mobile__os_version\n,mobile__android_idfa\n,mobile__apple_idfa\n,mobile__apple_idfv\n,mobile__carrier\n,mobile__open_idfa\n,mobile__network_technology\n,mobile__network_type\n,mobile__physical_memory\n,mobile__system_available_memory\n,mobile__app_available_memory\n,mobile__battery_level\n,mobile__battery_state\n,mobile__low_power_mode\n,mobile__available_storage\n,mobile__total_storage\n,mobile__is_portrait\n,mobile__resolution\n,mobile__scale\n,mobile__language\n,mobile__app_set_id\n,mobile__app_set_id_scope\n,first_geo_country\n,first_geo_region_name\n,first_geo_city\n,first_geo_country_name\n,first_geo_continent\n,last_geo_country\n,last_geo_region_name\n,last_geo_city\n,last_geo_country_name\n,last_geo_continent\n,geo_zipcode\n,geo_latitude\n,geo_longitude\n,geo_timezone\n,user_ipaddress\n,views\n\n,total_events\n,is_engaged\n,engaged_time_in_s\n,absolute_time_in_s\n,screen_names_viewed\n,mkt_medium\n,mkt_source\n,mkt_term\n,mkt_content\n,mkt_campaign\n,mkt_clickid\n,mkt_network\n,default_channel_group\n,mkt_source_platform\n,first_page_url\n,last_page_url\n,page_referrer\n,refr_medium\n,refr_source\n,refr_term\n,first_page_title\n,first_page_urlscheme\n,first_page_urlhost\n,first_page_urlpath\n,first_page_urlquery\n,first_page_urlfragment\n,last_page_title\n,last_page_urlscheme\n,last_page_urlhost\n,last_page_urlpath\n,last_page_urlquery\n,last_page_urlfragment\n,refr_urlscheme\n,refr_urlhost\n,refr_urlpath\n,refr_urlquery\n,refr_urlfragment\n,br_renderengine\n,first_br_lang\n,first_br_lang_name\n,last_br_lang\n,last_br_lang_name\n,iab__category\n,iab__primary_impact\n,iab__reason\n,iab__spider_or_robot\n,yauaa__device_name\n,yauaa__agent_class\n,yauaa__device_brand\n,yauaa__agent_name\n,yauaa__agent_name_version\n,yauaa__agent_name_version_major\n,yauaa__agent_version\n,yauaa__agent_version_major\n,yauaa__layout_engine_class\n,yauaa__layout_engine_name\n,yauaa__layout_engine_name_version\n,yauaa__layout_engine_name_version_major\n,yauaa__layout_engine_version\n,yauaa__layout_engine_version_major\n,ua__device_family\n,ua__os_family\n,ua__os_version\n,ua__os_major\n,ua__os_minor\n,ua__os_patch\n,ua__os_patch_minor\n,ua__useragent_family\n,ua__useragent_major\n,ua__useragent_minor\n,ua__useragent_patch\n,ua__useragent_version\n,first_screen_view__name\n,first_screen_view__type\n,last_screen_view__name\n,last_screen_view__transition_type\n,last_screen_view__type\n,screen_view__previous_id\n,screen_view__previous_name\n,screen_view__previous_type\n,first_app__build\n,first_app__version\n,first_geo__altitude\n,first_geo__altitude_accuracy\n,first_geo__bearing\n,first_geo__latitude\n,first_geo__latitude_longitude_accuracy\n,first_geo__longitude\n,first_geo__speed\n,app_errors\n,fatal_app_errors\n,useragent\n\n-- hard-coding due to non-deterministic outcome from row_number for Redshift/Postgres/databricks\n\n    ,event_id\n    ,event_id2\n\n    ,agg_test\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_sessions", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_sessions_actual", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.896433Z", "completed_at": "2026-01-20T14:49:11.904100Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.906044Z", "completed_at": "2026-01-20T14:49:11.906055Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.011855363845825195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_sessions_device_session_index.04ce4fd111", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_session_index\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_sessions\nwhere device_session_index is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.912532Z", "completed_at": "2026-01-20T14:49:11.929514Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.931377Z", "completed_at": "2026-01-20T14:49:11.931391Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02302408218383789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_sessions_end_tstamp.d10ab70f31", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect end_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_sessions\nwhere end_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.917592Z", "completed_at": "2026-01-20T14:49:11.930188Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.932291Z", "completed_at": "2026-01-20T14:49:11.932302Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.023105859756469727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_sessions_engaged_time_in_s.6b702898cc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engaged_time_in_s\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_sessions\nwhere engaged_time_in_s is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.923905Z", "completed_at": "2026-01-20T14:49:11.930781Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.933172Z", "completed_at": "2026-01-20T14:49:11.933183Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.021389007568359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_sessions_is_engaged.05221eb41c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect is_engaged\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_sessions\nwhere is_engaged is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.946900Z", "completed_at": "2026-01-20T14:49:11.961624Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.962351Z", "completed_at": "2026-01-20T14:49:11.962365Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02558112144470215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_sessions_start_tstamp.22e855927c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect start_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_sessions\nwhere start_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.952054Z", "completed_at": "2026-01-20T14:49:11.964719Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.966602Z", "completed_at": "2026-01-20T14:49:11.966614Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.029192686080932617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_sessions_total_events.5c72a6e786", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_events\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_sessions\nwhere total_events is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.939949Z", "completed_at": "2026-01-20T14:49:11.965935Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.973410Z", "completed_at": "2026-01-20T14:49:11.973449Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03732895851135254, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_sessions_session_identifier.833be1a65d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_identifier\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_sessions\nwhere session_identifier is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.817081Z", "completed_at": "2026-01-20T14:49:11.967470Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.975120Z", "completed_at": "2026-01-20T14:49:11.975131Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.1701061725616455, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_consent_versions", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\nwith consent_versions as (\n\n  select\n    consent_version,\n    consent_scopes,\n    consent_url,\n    domains_applied,\n    min(derived_tstamp) as version_start_tstamp,\n    max(load_tstamp) as last_allow_all_event\n\n  from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_log\n\n  where event_name <> 'cmp_visible' and event_type = 'allow_all'\n\n   -- and it has not been processed yet\n  and load_tstamp > \n        cast('2021-02-26 09:13:39.940000' as timestamp)\n    \n  \n\n  group by 1,2,3,4\n)\n\n, latest_version as (\n\n  select\n    consent_version,\n    version_start_tstamp\n\n  from consent_versions\n\n  order by 2 desc limit 1\n)\n\n\n\nselect\n  v.consent_version,\n  least(v.version_start_tstamp, t.version_start_tstamp) as version_start_tstamp,\n  v.consent_scopes,\n  v.consent_url,\n  v.domains_applied,\n  case when l.consent_version is not null then True else False end is_latest_version,\n  v.last_allow_all_event\n\nfrom consent_versions v\n\nleft join latest_version l\n\non v.consent_version = l.consent_version\n\nleft join SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_versions t\non t.consent_version = v.consent_version\n\n", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_versions", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.968088Z", "completed_at": "2026-01-20T14:49:11.976866Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:11.980465Z", "completed_at": "2026-01-20T14:49:11.980476Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.016515016555786133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_sessions_views.9efb838735", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect views\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_sessions\nwhere views is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.983823Z", "completed_at": "2026-01-20T14:49:12.007362Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.009758Z", "completed_at": "2026-01-20T14:49:12.009773Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.032404184341430664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_sessions_session_identifier.3620ace50e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    session_identifier as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_sessions\nwhere session_identifier is not null\ngroup by session_identifier\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:11.991289Z", "completed_at": "2026-01-20T14:49:12.009098Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.017576Z", "completed_at": "2026-01-20T14:49:12.017588Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03787684440612793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified_integration_tests.snowplow_unified_views_actual", "compiled": true, "compiled_code": "\n\n\n-- Removing model_tstamp\n\nselect\n-- hard-coding due to non-deterministic outcome from row_number for Redshift/Postgres/databricks\n\n  app_id,\n\n\n  -- hard-coding due to non-deterministic outcome from row_number for Redshift/Postgres/databricks\n\n  dvce_created_tstamp,\n\n\n  -- hard-coding due to non-deterministic outcome from row_number for Redshift/Postgres/databricks\n\n  derived_tstamp,\n\n\n  -- hard-coding due to non-deterministic outcome from row_number for Redshift/Postgres/databricks\n\n  start_tstamp,\n\n\n  -- hard-coding due to non-deterministic outcome from row_number for Redshift/Postgres/databricks\n\n  end_tstamp,\n\n\nview_id,\nevent_name,\nevent_id,\nsession_identifier,\n\n  -- hard-coding due to non-deterministic outcome from row_number for Redshift/Postgres/databricks\n\n  view_in_session_index,\n\n\nviews_in_session,\nsession__previous_session_id,\nuser_id,\nuser_identifier,\nstitched_user_id,\n\n -- hard-coding due to non-deterministic outcome from row_number for Redshift/Postgres/databricks\n\n  network_userid,\n\n\ncollector_tstamp,\n\nplatform,\ndevice_identifier,\ndevice_category,\ndevice_session_index,\nos_version,\nos_type,\nmobile__device_manufacturer,\nmobile__device_model,\nmobile__os_type,\nmobile__os_version,\nmobile__android_idfa,\nmobile__apple_idfa,\nmobile__apple_idfv,\nmobile__carrier,\nmobile__open_idfa,\nmobile__network_technology,\nmobile__network_type,\nmobile__physical_memory,\nmobile__system_available_memory,\nmobile__app_available_memory,\nmobile__battery_level,\nmobile__battery_state,\nmobile__low_power_mode,\nmobile__available_storage,\nmobile__total_storage,\nmobile__is_portrait,\nmobile__resolution,\nmobile__scale,\nmobile__language,\nmobile__app_set_id,\nmobile__app_set_id_scope,\nos_timezone,\nscreen_resolution,\nyauaa__device_class,\nyauaa__device_version,\nyauaa__operating_system_version,\nyauaa__operating_system_class,\nyauaa__operating_system_name,\nyauaa__operating_system_name_version,\ngeo_country,\ngeo_region,\ngeo_region_name,\ngeo_city,\ngeo_zipcode,\ngeo_latitude,\ngeo_longitude,\ngeo_timezone,\nuser_ipaddress,\nengaged_time_in_s,\nabsolute_time_in_s,\nhorizontal_pixels_scrolled,\nvertical_pixels_scrolled,\nhorizontal_percentage_scrolled,\nvertical_percentage_scrolled,\nmkt_medium,\nmkt_source,\nmkt_term,\nmkt_content,\nmkt_campaign,\nmkt_clickid,\nmkt_network,\ndefault_channel_group,\npage_url,\npage_referrer,\nrefr_medium,\nrefr_source,\nrefr_term,\npage_title,\ncontent_group,\npage_urlscheme,\npage_urlhost,\npage_urlpath,\npage_urlquery,\npage_urlfragment,\nrefr_urlscheme,\nrefr_urlhost,\nrefr_urlpath,\nrefr_urlquery,\nrefr_urlfragment,\nbr_lang,\nbr_viewwidth,\nbr_viewheight,\nbr_colordepth,\nbr_renderengine,\ndoc_width,\ndoc_height,\niab__category,\niab__primary_impact,\niab__reason,\niab__spider_or_robot,\nyauaa__device_name,\nyauaa__device_brand,\nyauaa__agent_class,\nyauaa__agent_name,\nyauaa__agent_name_version,\nyauaa__agent_name_version_major,\nyauaa__agent_version,\nyauaa__agent_version_major,\nyauaa__layout_engine_class,\nyauaa__layout_engine_name,\nyauaa__layout_engine_name_version,\nyauaa__layout_engine_name_version_major,\nyauaa__layout_engine_version,\nyauaa__layout_engine_version_major,\nua__device_family,\nua__os_family,\nua__os_version,\nua__os_major,\nua__os_minor,\nua__os_patch,\nua__os_patch_minor,\nua__useragent_family,\nua__useragent_major,\nua__useragent_minor,\nua__useragent_patch,\nua__useragent_version,\nscreen_view__name,\nscreen_view__previous_id,\nscreen_view__previous_name,\nscreen_view__previous_type,\nscreen_view__transition_type,\nscreen_view__type,\napp__build,\napp__version,\ngeo__altitude,\ngeo__altitude_accuracy,\ngeo__bearing,\ngeo__latitude,\ngeo__latitude_longitude_accuracy,\ngeo__longitude,\ngeo__speed,\nscreen__fragment,\nscreen__top_view_controller,\nscreen__view_controller,\nuseragent,\nv_collector,\nevent_id2,\nagg_test\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_views", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_views_actual", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.002052Z", "completed_at": "2026-01-20T14:49:12.010694Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.019122Z", "completed_at": "2026-01-20T14:49:12.019133Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03728199005126953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_views_absolute_time_in_s.54b3c5c9fc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect absolute_time_in_s\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_views\nwhere absolute_time_in_s is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.011265Z", "completed_at": "2026-01-20T14:49:12.021559Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.024321Z", "completed_at": "2026-01-20T14:49:12.024332Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.027853727340698242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_views_collector_tstamp.826c18335b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect collector_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_views\nwhere collector_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.026476Z", "completed_at": "2026-01-20T14:49:12.039000Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.046340Z", "completed_at": "2026-01-20T14:49:12.046352Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.025514841079711914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_views_derived_tstamp.8e5fcb344e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect derived_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_views\nwhere derived_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.032935Z", "completed_at": "2026-01-20T14:49:12.045769Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.053911Z", "completed_at": "2026-01-20T14:49:12.053923Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.031019210815429688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_views_device_session_index.3a9aeaa22e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_session_index\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_views\nwhere device_session_index is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.039637Z", "completed_at": "2026-01-20T14:49:12.054801Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.056919Z", "completed_at": "2026-01-20T14:49:12.056930Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03180503845214844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_views_dvce_created_tstamp.2cfe0b4cb4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dvce_created_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_views\nwhere dvce_created_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.047338Z", "completed_at": "2026-01-20T14:49:12.057792Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.060412Z", "completed_at": "2026-01-20T14:49:12.060445Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.022350072860717773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_views_end_tstamp.901b1d09a9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect end_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_views\nwhere end_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.069331Z", "completed_at": "2026-01-20T14:49:12.082582Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.084533Z", "completed_at": "2026-01-20T14:49:12.084548Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02554464340209961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_views_event_id.4fc9c1e85a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_views\nwhere event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.063870Z", "completed_at": "2026-01-20T14:49:12.083793Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.091435Z", "completed_at": "2026-01-20T14:49:12.091447Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.03307795524597168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_views_engaged_time_in_s.dd74f36be9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engaged_time_in_s\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_views\nwhere engaged_time_in_s is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.076307Z", "completed_at": "2026-01-20T14:49:12.090547Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.093053Z", "completed_at": "2026-01-20T14:49:12.093064Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.030599594116210938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_views_session_identifier.f4ae3412ff", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_identifier\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_views\nwhere session_identifier is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.085464Z", "completed_at": "2026-01-20T14:49:12.094801Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.097411Z", "completed_at": "2026-01-20T14:49:12.097444Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0221555233001709, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_views_start_tstamp.dbc42b7f20", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect start_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_views\nwhere start_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.100927Z", "completed_at": "2026-01-20T14:49:12.120606Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.127377Z", "completed_at": "2026-01-20T14:49:12.127389Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.032080888748168945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_views_view_id.3a1d547e18", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect view_id\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_views\nwhere view_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.112877Z", "completed_at": "2026-01-20T14:49:12.121166Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.128305Z", "completed_at": "2026-01-20T14:49:12.128320Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.029506921768188477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_views_views_in_session.b139e474d0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect views_in_session\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_views\nwhere views_in_session is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.106850Z", "completed_at": "2026-01-20T14:49:12.121756Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.129222Z", "completed_at": "2026-01-20T14:49:12.129233Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.03254365921020508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_views_view_in_session_index.e092c63b1e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect view_in_session_index\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_views\nwhere view_in_session_index is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.122333Z", "completed_at": "2026-01-20T14:49:12.131709Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.134267Z", "completed_at": "2026-01-20T14:49:12.134278Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02227640151977539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_views_event_id.e61ed6df21", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_views\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.138266Z", "completed_at": "2026-01-20T14:49:12.167714Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.173870Z", "completed_at": "2026-01-20T14:49:12.173887Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04105329513549805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_views_view_id.deffd898f9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    view_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_views\nwhere view_id is not null\ngroup by view_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.143324Z", "completed_at": "2026-01-20T14:49:12.174852Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.177572Z", "completed_at": "2026-01-20T14:49:12.177583Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04402470588684082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_web_vital_measurements", "compiled": true, "compiled_code": "\n\n\n\nwith measurements as (\n\n  select\n    page_url,\n    device_class,\n    geo_country,\n    cast( date_trunc('day', derived_tstamp) as TEXT) as time_period,\n    count(*) as view_count,\n    grouping_id(page_url, device_class) as id_url_and_device,\n    grouping_id(device_class) as id_device,\n    grouping_id(cast( date_trunc('day', derived_tstamp) as TEXT)) as id_period,\n    grouping_id(cast( date_trunc('day', derived_tstamp) as TEXT), device_class) as id_period_and_device,\n    grouping_id(geo_country) as id_country,\n    grouping_id(geo_country, device_class) as id_country_and_device,\n    percentile_cont(0.75) within group (order by lcp) as lcp_75p,\n    percentile_cont(0.75) within group (order by fid) as fid_75p,\n    percentile_cont(0.75) within group (order by cls) as cls_75p,\n    percentile_cont(0.75) within group (order by ttfb) as ttfb_75p,\n    percentile_cont(0.75) within group (order by inp) as inp_75p\n\n  from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_web_vitals\n\n  where cast(derived_tstamp as date) >= \n\n    dateadd(\n        day,\n        -28,\n        date_trunc('day', \n    convert_timezone('UTC', convert_timezone('UTC', current_timestamp()))::timestamp\n)\n        )\n\n\n\n  group by grouping sets ((), (page_url, device_class), (device_class), (cast( date_trunc('day', derived_tstamp) as TEXT)), (cast( date_trunc('day', derived_tstamp) as TEXT), device_class), (geo_country), (geo_country, device_class))\n\n)\n\n, measurement_type as (\n\n  select\n    *,\n    case when id_url_and_device <> 0 and id_device <> 0 and id_period <> 0 and id_period_and_device <> 0 and id_country <> 0 and id_country_and_device <> 0 then 'overall'\n       when id_url_and_device = 0 then 'by_url_and_device'\n       when id_period_and_device = 0 then 'by_day_and_device'\n       when id_country_and_device = 0 then 'by_country_and_device'\n       when id_country = 0 then 'by_country'\n       when id_device = 0 then 'by_device'\n       when id_period = 0 then 'by_day'\n       end as measurement_type,\n   \n  case when lcp_75p is null then 'not measurable'\n    when  lcp_75p < 2.5 then 'good'\n    when lcp_75p < 4 then 'needs improvement'\n    else 'poor' end as lcp_result,\n\n  case when fid_75p is null then 'not measurable'\n    when fid_75p < 100 then 'good'\n    when fid_75p < 300 then 'needs improvement'\n    else 'poor' end as fid_result,\n\n  case when cls_75p is null then 'not measurable'\n    when cls_75p < 0.1 then 'good'\n    when cls_75p < 0.25 then 'needs improvement'\n    else 'poor' end as cls_result,\n\n  case when ttfb_75p is null then 'not measurable'\n    when ttfb_75p < 800 then 'good'\n    when ttfb_75p < 1800 then 'needs improvement'\n    else 'poor' end as ttfb_result,\n\n  case when inp_75p is null then 'not measurable'\n    when inp_75p < 200 then 'good'\n    when inp_75p < 500 then 'needs improvement'\n    else 'poor' end as inp_result\n\n\n\n  from measurements\n)\n\n, coalesce as (\n\n  select\n    m.measurement_type,\n    coalesce(m.page_url, 'all') as page_url,\n    coalesce(m.device_class, 'all') as device_class,\n    coalesce(m.geo_country, 'all') as geo_country,\n    coalesce(g.name, 'all') as country,\n    coalesce(time_period, 'last 28 days') as time_period,\n    view_count,\n    ceil(lcp_75p, 3) as lcp_75p,\n    ceil(fid_75p, 3) as fid_75p,\n    ceil(cls_75p, 3) as cls_75p,\n    ceil(ttfb_75p, 3) as ttfb_75p,\n    ceil(inp_75p, 3) as inp_75p,\n    m.lcp_result,\n    m.fid_result,\n    m.cls_result,\n    m.ttfb_result,\n    m.inp_result,\n    \n\ncase when m.lcp_result = 'good' and m.fid_result = 'good' and m.cls_result = 'good' then 1 else 0 end\n\n as passed\n\n  from measurement_type m\n\n  left join SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snowplow_manifest.snowplow_unified_dim_geo_country_mapping g on lower(m.geo_country) = lower(g.alpha_2)\n\n  order by 1\n\n)\n\nselect\n  page_url || '-' || device_class || '-' || geo_country || '-' || time_period compound_key,\n  *\nfrom coalesce", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_web_vital_measurements", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.162240Z", "completed_at": "2026-01-20T14:49:12.175592Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.178468Z", "completed_at": "2026-01-20T14:49:12.178483Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.04342007637023926, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified_integration_tests.snowplow_unified_consent_cmp_stats_actual", "compiled": true, "compiled_code": "\n\n\n\n\nselect *\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_cmp_stats", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_cmp_stats_actual", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.168514Z", "completed_at": "2026-01-20T14:49:12.176966Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.179999Z", "completed_at": "2026-01-20T14:49:12.180013Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02136683464050293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_consent_cmp_stats_event_id.70b4093ca8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_cmp_stats\nwhere event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.185044Z", "completed_at": "2026-01-20T14:49:12.192816Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.219377Z", "completed_at": "2026-01-20T14:49:12.219389Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04015612602233887, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_consent_cmp_stats_event_id.4bdb9bcc41", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_cmp_stats\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.193402Z", "completed_at": "2026-01-20T14:49:12.221106Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.223376Z", "completed_at": "2026-01-20T14:49:12.223387Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03971529006958008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified_integration_tests.dbt_utils_equal_rowcount_snowplow_unified_consent_log_actual_ref_snowplow_unified_consent_log_expected_stg_.2bc14dd7de", "compiled": true, "compiled_code": "\n\n\n\n\nwith a as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_a \n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_log_actual\n    group by id_dbtutils_test_equal_rowcount\n\n\n),\nb as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_b \n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_log_expected_stg\n    group by id_dbtutils_test_equal_rowcount\n\n),\nfinal as (\n\n    select\n    \n        a.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_a,\n          b.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_b,\n        \n\n        count_a,\n        count_b,\n        abs(count_a - count_b) as diff_count\n\n    from a\n    full join b\n    on\n    a.id_dbtutils_test_equal_rowcount = b.id_dbtutils_test_equal_rowcount\n    \n\n\n)\n\nselect * from final\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.209947Z", "completed_at": "2026-01-20T14:49:12.225167Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.227519Z", "completed_at": "2026-01-20T14:49:12.227530Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03746676445007324, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_users_aggs", "compiled": true, "compiled_code": "\n\n\n\nselect\n  user_identifier\n  -- time\n  , user_start_tstamp as start_tstamp\n  , user_end_tstamp as end_tstamp\n  -- first/last session. Max to resolve edge case with multiple sessions with the same start/end tstamp\n  , max(case when start_tstamp = user_start_tstamp then session_identifier end) as first_session_identifier\n  , max(case when end_tstamp = user_end_tstamp then session_identifier end) as last_session_identifier\n  -- engagement\n  , sum(views) as views\n  , count(distinct session_identifier) as sessions\n  , count(distinct date_trunc('day', start_tstamp)) as active_days\n\n  \n    , sum(engaged_time_in_s) as engaged_time_in_s\n  \n\n  , sum(absolute_time_in_s) as absolute_time_in_s\n\n  \n    , sum(screen_names_viewed) as screen_names_viewed\n  \n\n  \n    , sum(app_errors) as app_errors\n    , sum(fatal_app_errors) as fatal_app_errors\n  \n\n  \n    \n      , \n  \n  \n  \n\n  \n  \n  \n    sum(agg_test) as agg_test\n  \n\n\n    \n  \n\n  \n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_users_sessions_this_run\n\ngroup by 1,2,3", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_users_aggs", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.230343Z", "completed_at": "2026-01-20T14:49:12.243542Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.249380Z", "completed_at": "2026-01-20T14:49:12.249393Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.023638486862182617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_users_sessions_this_run_session_identifier.ccd4dad35f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_identifier\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_users_sessions_this_run\nwhere session_identifier is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.237344Z", "completed_at": "2026-01-20T14:49:12.264866Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.265608Z", "completed_at": "2026-01-20T14:49:12.265619Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03667926788330078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_users_sessions_this_run_session_identifier.d123f43ae3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    session_identifier as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_users_sessions_this_run\nwhere session_identifier is not null\ngroup by session_identifier\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.244200Z", "completed_at": "2026-01-20T14:49:12.269100Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.279066Z", "completed_at": "2026-01-20T14:49:12.279083Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04252266883850098, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified_integration_tests.dbt_utils_equal_rowcount_snowplow_unified_sessions_actual_ref_snowplow_unified_sessions_expected_stg_.deb9a7689f", "compiled": true, "compiled_code": "\n\n\n\n\nwith a as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_a \n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_sessions_actual\n    group by id_dbtutils_test_equal_rowcount\n\n\n),\nb as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_b \n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_sessions_expected_stg\n    group by id_dbtutils_test_equal_rowcount\n\n),\nfinal as (\n\n    select\n    \n        a.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_a,\n          b.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_b,\n        \n\n        count_a,\n        count_b,\n        abs(count_a - count_b) as diff_count\n\n    from a\n    full join b\n    on\n    a.id_dbtutils_test_equal_rowcount = b.id_dbtutils_test_equal_rowcount\n    \n\n\n)\n\nselect * from final\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.283784Z", "completed_at": "2026-01-20T14:49:12.289223Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.289841Z", "completed_at": "2026-01-20T14:49:12.289851Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007824897766113281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified_integration_tests.snowplow_unified_consent_versions_actual", "compiled": true, "compiled_code": "\n\n\n\n\nselect *\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_versions", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_versions_actual", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.292823Z", "completed_at": "2026-01-20T14:49:12.297967Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.298562Z", "completed_at": "2026-01-20T14:49:12.298571Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00717616081237793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_consent_versions_consent_version.309008d9d1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect consent_version\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_versions\nwhere consent_version is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.301214Z", "completed_at": "2026-01-20T14:49:12.305197Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.305793Z", "completed_at": "2026-01-20T14:49:12.305803Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005835294723510742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.snowplow_tests_consent_versions", "compiled": true, "compiled_code": "\n\nwith prep as (\n\n  select\n    consent_version,\n    count(*) as n_consents\n\n  from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_versions\n\n  group by 1\n\n  having count(*)>1\n)\n\nselect * from prep", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.308412Z", "completed_at": "2026-01-20T14:49:12.314302Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.314894Z", "completed_at": "2026-01-20T14:49:12.314904Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007729768753051758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_consent_versions_consent_version.5ceb06b341", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    consent_version as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_versions\nwhere consent_version is not null\ngroup by consent_version\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.317535Z", "completed_at": "2026-01-20T14:49:12.324646Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.326253Z", "completed_at": "2026-01-20T14:49:12.326265Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010002851486206055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified_integration_tests.dbt_utils_equal_rowcount_snowplow_unified_views_actual_ref_snowplow_unified_views_expected_stg_.bcfd303281", "compiled": true, "compiled_code": "\n\n\n\n\nwith a as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_a \n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_views_actual\n    group by id_dbtutils_test_equal_rowcount\n\n\n),\nb as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_b \n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_views_expected_stg\n    group by id_dbtutils_test_equal_rowcount\n\n),\nfinal as (\n\n    select\n    \n        a.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_a,\n          b.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_b,\n        \n\n        count_a,\n        count_b,\n        abs(count_a - count_b) as diff_count\n\n    from a\n    full join b\n    on\n    a.id_dbtutils_test_equal_rowcount = b.id_dbtutils_test_equal_rowcount\n    \n\n\n)\n\nselect * from final\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.269724Z", "completed_at": "2026-01-20T14:49:12.371228Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.371886Z", "completed_at": "2026-01-20T14:49:12.371897Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.10471701622009277, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_consent_users", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\nwith base as (\n\n  select\n    user_identifier,\n    user_id,\n    geo_country,\n    max(load_tstamp) as last_processed_event,\n    count(case when event_name = 'cmp_visible' then 1 end) as cmp_events,\n    count(case when event_name = 'consent_preferences' then 1 end) as consent_events,\n    max(case when event_name = 'cmp_visible' then derived_tstamp end) as last_cmp_event_tstamp,\n    row_number() over(partition by user_identifier order by max(load_tstamp) desc) as latest_event_by_user_rank\n\n  from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_log\n\n   -- and it has not been processed yet\n  where load_tstamp > \n        cast('2021-02-26 09:13:51.444000' as timestamp)\n    \n  \n\n  group by 1,2,3\n\n)\n\n, latest_consents as (\n\n  select\n    user_identifier,\n    derived_tstamp as last_consent_event_tstamp,\n    event_type as last_consent_event_type,\n    consent_scopes as last_consent_scopes,\n    consent_version as last_consent_version,\n    consent_url as last_consent_url,\n    domains_applied as last_domains_applied,\n    row_number() over(partition by user_identifier order by load_tstamp desc) as latest_consent_event_by_user_rank\n\n  from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_log\n\n  where event_name = 'consent_preferences'\n\n   -- and it has not been processed yet\n  and load_tstamp > \n        cast('2021-02-26 09:13:51.444000' as timestamp)\n    \n  \n\n)\n\n\n\nselect\n  b.user_identifier,\n  b.user_id,\n  b.geo_country,\n  coalesce(b.cmp_events, 0) + coalesce(t.cmp_events, 0) as cmp_events,\n  coalesce(b.consent_events, 0) + coalesce(t.consent_events, 0) as consent_events,\n  b.last_cmp_event_tstamp,\n  l.last_consent_event_tstamp,\n  l.last_consent_event_type,\n  l.last_consent_scopes,\n  l.last_consent_version,\n  l.last_consent_url,\n  l.last_domains_applied,\n  b.last_processed_event,\n  case when v.is_latest_version then True else False end as is_latest_version\n\nfrom base b\n\nleft join latest_consents l\non b.user_identifier = l.user_identifier\n\nleft join SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_versions v\non v.consent_version = l.last_consent_version\n\nleft join SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_users t\non t.user_identifier = b.user_identifier\n\nwhere (l.latest_consent_event_by_user_rank = 1 or l.user_identifier is null)\nand b.latest_event_by_user_rank = 1\n\n", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_users", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.377789Z", "completed_at": "2026-01-20T14:49:12.386813Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.388101Z", "completed_at": "2026-01-20T14:49:12.388112Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.013083457946777344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified_integration_tests.snowplow_unified_web_vital_measurements_actual", "compiled": true, "compiled_code": "\n\n\n\n\nselect *\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_web_vital_measurements", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_web_vital_measurements_actual", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.391505Z", "completed_at": "2026-01-20T14:49:12.397469Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.398059Z", "completed_at": "2026-01-20T14:49:12.398068Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008020401000976562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_web_vital_measurements_compound_key.ff79f11fe6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect compound_key\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_web_vital_measurements\nwhere compound_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.511686Z", "completed_at": "2026-01-20T14:49:12.523661Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.529161Z", "completed_at": "2026-01-20T14:49:12.529177Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.1297152042388916, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_web_vital_measurements_compound_key.cf8bddba94", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    compound_key as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_web_vital_measurements\nwhere compound_key is not null\ngroup by compound_key\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.546737Z", "completed_at": "2026-01-20T14:49:12.555837Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.556470Z", "completed_at": "2026-01-20T14:49:12.556482Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.021596908569335938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified_integration_tests.dbt_utils_equal_rowcount_snowplow_unified_consent_cmp_stats_actual_ref_snowplow_unified_consent_cmp_stats_expected_stg_.22d90b662d", "compiled": true, "compiled_code": "\n\n\n\n\nwith a as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_a \n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_cmp_stats_actual\n    group by id_dbtutils_test_equal_rowcount\n\n\n),\nb as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_b \n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_cmp_stats_expected_stg\n    group by id_dbtutils_test_equal_rowcount\n\n),\nfinal as (\n\n    select\n    \n        a.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_a,\n          b.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_b,\n        \n\n        count_a,\n        count_b,\n        abs(count_a - count_b) as diff_count\n\n    from a\n    full join b\n    on\n    a.id_dbtutils_test_equal_rowcount = b.id_dbtutils_test_equal_rowcount\n    \n\n\n)\n\nselect * from final\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.252555Z", "completed_at": "2026-01-20T14:49:12.646524Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.647910Z", "completed_at": "2026-01-20T14:49:12.647921Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.39676332473754883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified_integration_tests.dbt_utils_equality_snowplow_unified_sessions_actual_ref_snowplow_unified_sessions_expected_stg_.e1af6ef1db", "compiled": true, "compiled_code": "\n\n\n\n-- setup\n\n\n\n\n\n\nwith a as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_sessions_actual\n\n),\n\nb as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_sessions_expected_stg\n\n),\n\na_minus_b as (\n\n    select  from a\n    \n\n    except\n\n\n    select  from b\n\n),\n\nb_minus_a as (\n\n    select  from b\n    \n\n    except\n\n\n    select  from a\n\n),\n\nunioned as (\n\n    select 'a_minus_b' as which_diff, a_minus_b.* from a_minus_b\n    union all\n    select 'b_minus_a' as which_diff, b_minus_a.* from b_minus_a\n\n)\n\nselect * from unioned\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.659383Z", "completed_at": "2026-01-20T14:49:12.671658Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.673641Z", "completed_at": "2026-01-20T14:49:12.673657Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.019253253936767578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_users_lasts", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n  a.user_identifier\n  , a.platform as last_platform\n  , os_type as last_os_type\n  , os_version as last_os_version\n  , screen_resolution as last_screen_resolution\n  , a.last_geo_country\n  , a.last_geo_country_name\n  , a.last_geo_continent\n  , a.last_geo_city\n  , a.last_geo_region_name\n  , a.last_page_url\n\n  \n    , a.last_page_title\n    , a.last_page_urlscheme\n    , a.last_page_urlhost\n    , a.last_page_urlpath\n    , a.last_page_urlquery\n    , a.last_page_urlfragment\n\n    , a.last_br_lang\n    , a.last_br_lang_name\n\n  \n    , a.last_screen_view__name\n    , a.last_screen_view__transition_type\n    , a.last_screen_view__type\n  \n\n  \n    , a.mobile__carrier as last_mobile__carrier\n    , a.mobile__device_manufacturer as last_mobile__device_manufacturer\n    , a.mobile__device_model as last_mobile__device_model\n  \n    , a.event_id as last_event_id\n    , event_id2 || '-last' as last_event_id2\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_users_sessions_this_run a\n\ninner join SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_users_aggs b\non a.session_identifier = b.last_session_identifier", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_users_lasts", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.200945Z", "completed_at": "2026-01-20T14:49:12.672997Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.675351Z", "completed_at": "2026-01-20T14:49:12.675361Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.4910728931427002, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified_integration_tests.dbt_utils_equality_snowplow_unified_consent_log_actual_ref_snowplow_unified_consent_log_expected_stg_.71b95e8674", "compiled": true, "compiled_code": "\n\n\n\n-- setup\n\n\n\n\n\n\nwith a as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_log_actual\n\n),\n\nb as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_log_expected_stg\n\n),\n\na_minus_b as (\n\n    select  from a\n    \n\n    except\n\n\n    select  from b\n\n),\n\nb_minus_a as (\n\n    select  from b\n    \n\n    except\n\n\n    select  from a\n\n),\n\nunioned as (\n\n    select 'a_minus_b' as which_diff, a_minus_b.* from a_minus_b\n    union all\n    select 'b_minus_a' as which_diff, b_minus_a.* from b_minus_a\n\n)\n\nselect * from unioned\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.685260Z", "completed_at": "2026-01-20T14:49:12.698399Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.699226Z", "completed_at": "2026-01-20T14:49:12.699239Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.020878314971923828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_users_aggs_user_identifier.67601373c5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_identifier\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_users_aggs\nwhere user_identifier is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.692359Z", "completed_at": "2026-01-20T14:49:12.701440Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.702673Z", "completed_at": "2026-01-20T14:49:12.702684Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.020205020904541016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_users_aggs_user_identifier.7a0ce8ecea", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_identifier as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_users_aggs\nwhere user_identifier is not null\ngroup by user_identifier\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.703554Z", "completed_at": "2026-01-20T14:49:12.711135Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.712365Z", "completed_at": "2026-01-20T14:49:12.712375Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.011649131774902344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified_integration_tests.dbt_utils_equal_rowcount_snowplow_unified_consent_versions_actual_ref_snowplow_unified_consent_versions_expected_stg_.7b92210c06", "compiled": true, "compiled_code": "\n\n\n\n\nwith a as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_a \n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_versions_actual\n    group by id_dbtutils_test_equal_rowcount\n\n\n),\nb as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_b \n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_versions_expected_stg\n    group by id_dbtutils_test_equal_rowcount\n\n),\nfinal as (\n\n    select\n    \n        a.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_a,\n          b.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_b,\n        \n\n        count_a,\n        count_b,\n        abs(count_a - count_b) as diff_count\n\n    from a\n    full join b\n    on\n    a.id_dbtutils_test_equal_rowcount = b.id_dbtutils_test_equal_rowcount\n    \n\n\n)\n\nselect * from final\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.726860Z", "completed_at": "2026-01-20T14:49:12.733179Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.733811Z", "completed_at": "2026-01-20T14:49:12.733821Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009369850158691406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_consent_scope_status", "compiled": true, "compiled_code": "\n\n\n\nwith arrays as (\n\n  select\n    u.user_identifier,\n    \n    split(u.last_consent_scopes, ', ')\n as scope_array\n\n  from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_users u\n\n  where is_latest_version\n\n  )\n\n  , unnesting as (\n\n    \n    select t.user_identifier, replace(r.value, '\"', '') as consent_scope\n    \n    from arrays t, table(flatten(t.scope_array)) r\n\n\n  )\n\nselect\n  replace(replace(replace(cast(consent_scope as \n    TEXT\n), '\"', ''), '[', ''), ']', '') as scope,\n  count(*) as total_consent\n\nfrom unnesting\n\ngroup by 1", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_scope_status", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.736715Z", "completed_at": "2026-01-20T14:49:12.743603Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.744192Z", "completed_at": "2026-01-20T14:49:12.744201Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008816003799438477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_consent_totals", "compiled": true, "compiled_code": "\n\n\n\nwith totals as (\n\n  select\n    last_consent_version,\n    count(distinct user_identifier) as total_visitors,\n    count(case when last_consent_event_type ='allow_all' then 1 end) as allow_all,\n    count(case when last_consent_event_type ='allow_selected' then 1 end) as allow_selected,\n    count(case when last_consent_event_type IN ('allow_all', 'allow_selected') then 1 end) as allow,\n    count(case when last_consent_event_type = 'pending' then 1 end) as pending,\n    count(case when last_consent_event_type = 'deny_all'  then 1 end) as denied,\n    count(case when last_consent_event_type = 'expired'  then 1 end) as expired,\n    count(case when last_consent_event_type = 'withdrawn'  then 1 end) as withdrawn,\n    count(case when last_consent_event_type = 'implicit_consent'  then 1 end) as implicit_consent,\n    count(case when \n\n    dateadd(\n        year,\n        1,\n        last_consent_event_tstamp\n        )\n\n <= \n\n    dateadd(\n        month,\n        6,\n        current_date\n        )\n\n\n          and last_consent_event_type <> 'expired'\n          and \n\n    dateadd(\n        year,\n        1,\n        last_consent_event_tstamp\n        )\n\n > current_date then 1 end) as expires_in_six_months\n\n  from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_users\n\n  where last_consent_event_type is not null\n\n  group by 1\n\n)\n\nselect\n  v.*,\n  t.total_visitors,\n  t.allow_all,\n  t.allow_selected,\n  t.allow,\n  t.pending,\n  t.denied,\n  t.expired,\n  t.withdrawn,\n  t.implicit_consent,\n  t.expires_in_six_months\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_versions v\n\nleft join totals t\non t.last_consent_version = v.consent_version\n\norder by v.version_start_tstamp desc", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_totals", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.747060Z", "completed_at": "2026-01-20T14:49:12.752314Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.752901Z", "completed_at": "2026-01-20T14:49:12.752911Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.007197141647338867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified_integration_tests.snowplow_unified_consent_users_actual", "compiled": true, "compiled_code": "\n\n\n\n\nselect *\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_users", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_users_actual", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.755682Z", "completed_at": "2026-01-20T14:49:12.760775Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.761343Z", "completed_at": "2026-01-20T14:49:12.761352Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.006930828094482422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_consent_users_user_identifier.6c2cb3f0a2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_identifier\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_users\nwhere user_identifier is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.763998Z", "completed_at": "2026-01-20T14:49:12.769179Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.769762Z", "completed_at": "2026-01-20T14:49:12.769772Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00702357292175293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_consent_users_user_identifier.e93ed6baff", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_identifier as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_users\nwhere user_identifier is not null\ngroup by user_identifier\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.772404Z", "completed_at": "2026-01-20T14:49:12.779277Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.779959Z", "completed_at": "2026-01-20T14:49:12.779970Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008819818496704102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified_integration_tests.dbt_utils_equal_rowcount_snowplow_unified_web_vital_measurements_actual_ref_snowplow_unified_web_vital_measurements_expected_stg_.d3e434d0cf", "compiled": true, "compiled_code": "\n\n\n\n\nwith a as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_a \n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_web_vital_measurements_actual\n    group by id_dbtutils_test_equal_rowcount\n\n\n),\nb as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_b \n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_web_vital_measurements_expected_stg\n    group by id_dbtutils_test_equal_rowcount\n\n),\nfinal as (\n\n    select\n    \n        a.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_a,\n          b.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_b,\n        \n\n        count_a,\n        count_b,\n        abs(count_a - count_b) as diff_count\n\n    from a\n    full join b\n    on\n    a.id_dbtutils_test_equal_rowcount = b.id_dbtutils_test_equal_rowcount\n    \n\n\n)\n\nselect * from final\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.334528Z", "completed_at": "2026-01-20T14:49:12.801514Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.802906Z", "completed_at": "2026-01-20T14:49:12.802917Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.47370409965515137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified_integration_tests.dbt_utils_equality_snowplow_unified_views_actual_ref_snowplow_unified_views_expected_stg_.13f329e6b4", "compiled": true, "compiled_code": "\n\n\n\n-- setup\n\n\n\n\n\n\nwith a as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_views_actual\n\n),\n\nb as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_views_expected_stg\n\n),\n\na_minus_b as (\n\n    select  from a\n    \n\n    except\n\n\n    select  from b\n\n),\n\nb_minus_a as (\n\n    select  from b\n    \n\n    except\n\n\n    select  from a\n\n),\n\nunioned as (\n\n    select 'a_minus_b' as which_diff, a_minus_b.* from a_minus_b\n    union all\n    select 'b_minus_a' as which_diff, b_minus_a.* from b_minus_a\n\n)\n\nselect * from unioned\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.811471Z", "completed_at": "2026-01-20T14:49:12.827688Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.828292Z", "completed_at": "2026-01-20T14:49:12.828303Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.019821882247924805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_users_this_run", "compiled": true, "compiled_code": "\n\n\n\nselect\n  -- user fields\n  a.user_id\n  , a.user_identifier\n  , a.network_userid\n  \n    -- updated with mapping as part of post hook on derived sessions table\n    , cast(a.user_identifier as \n    TEXT\n) as stitched_user_id\n  \n\n  -- timestamp fields\n  , b.start_tstamp\n  , b.end_tstamp\n  , \n    convert_timezone('UTC', convert_timezone('UTC', current_timestamp()))::timestamp\n as model_tstamp\n\n  -- device fields\n  , a.platform as first_platform\n  , c.last_platform\n  , cast(a.on_web as boolean) as on_web\n  , cast(a.on_mobile as boolean) as on_mobile\n  , c.last_screen_resolution\n  , c.last_os_type\n  , c.last_os_version\n\n  \n    , a.mobile__device_manufacturer as first_mobile__device_manufacturer\n    , a.mobile__device_model as first_mobile__device_model\n    , a.mobile__carrier as first_mobile__carrier\n    , c.last_mobile__device_manufacturer\n    , c.last_mobile__device_model\n    , c.last_mobile__carrier\n\n    , a.mobile__os_type\n    , a.mobile__os_version\n    , a.mobile__android_idfa\n    , a.mobile__apple_idfa\n    , a.mobile__apple_idfv\n    , a.mobile__open_idfa\n    , a.mobile__network_technology\n    , a.mobile__network_type\n    , a.mobile__physical_memory\n    , a.mobile__system_available_memory\n    , a.mobile__app_available_memory\n    , a.mobile__battery_level\n    , a.mobile__battery_state\n    , a.mobile__low_power_mode\n    , a.mobile__available_storage\n    , a.mobile__total_storage\n    , a.mobile__is_portrait\n    , a.mobile__resolution\n    , a.mobile__scale\n    , a.mobile__language\n    , a.mobile__app_set_id\n    , a.mobile__app_set_id_scope\n    -- Derivative fields\n    , a.mobile_language_name\n  \n\n  -- geo fields\n  , a.first_geo_country\n  , a.first_geo_country_name\n  , a.first_geo_continent\n  , a.first_geo_city\n  , a.first_geo_region_name\n  , c.last_geo_country\n  , c.last_geo_country_name\n  , c.last_geo_continent\n  , c.last_geo_city\n  , c.last_geo_region_name\n\n  , a.geo_zipcode\n  , a.geo_latitude\n  , a.geo_longitude\n  , a.geo_timezone\n\n  -- engagement fields\n  , b.views\n  , b.sessions\n  , b.active_days\n\n  \n    , b.engaged_time_in_s\n  \n\n  , b.absolute_time_in_s\n\n  \n    , b.screen_names_viewed\n  \n\n\n  -- webpage / referer / browser fields\n  , a.page_referrer\n  , a.refr_medium\n  , a.refr_source\n  , a.refr_term\n\n  \n    , a.first_page_title\n    , a.first_page_url\n    , a.first_page_urlscheme\n    , a.first_page_urlhost\n    , a.first_page_urlpath\n    , a.first_page_urlquery\n    , a.first_page_urlfragment\n    , a.first_br_lang\n    , a.first_br_lang_name\n    , c.last_page_title\n    , c.last_page_url\n    , c.last_page_urlscheme\n    , c.last_page_urlhost\n    , c.last_page_urlpath\n    , c.last_page_urlquery\n    , c.last_page_urlfragment\n    , c.last_br_lang\n    , c.last_br_lang_name\n    , a.refr_urlscheme\n    , a.refr_urlhost\n    , a.refr_urlpath\n    , a.refr_urlquery\n    , a.refr_urlfragment\n\n  \n    , a.first_screen_view__name\n    , a.first_screen_view__type\n    , c.last_screen_view__name\n    , c.last_screen_view__transition_type\n    , c.last_screen_view__type\n\n  -- marketing fields\n  , a.mkt_medium\n  , a.mkt_source\n  , a.mkt_term\n  , a.mkt_content\n  , a.mkt_campaign\n  , a.mkt_clickid\n  , a.mkt_network\n  , a.mkt_source_platform\n  , a.default_channel_group\n\n  \n    , b.app_errors\n    , b.fatal_app_errors\n    ,a.event_id as first_event_id\n    ,event_id2 || '-first' as first_event_id2\n    ,c.last_event_id\n    ,c.last_event_id2\n  \n    \n      , b.agg_test\n    \n  \n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_users_aggs as b\n\ninner join SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_users_sessions_this_run as a\non a.session_identifier = b.first_session_identifier\n\ninner join SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_users_lasts c\non b.user_identifier = c.user_identifier", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_users_this_run", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.831508Z", "completed_at": "2026-01-20T14:49:12.838719Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.840081Z", "completed_at": "2026-01-20T14:49:12.840092Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010095596313476562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_users_lasts_user_identifier.bf9c874d36", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_identifier\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_users_lasts\nwhere user_identifier is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.848088Z", "completed_at": "2026-01-20T14:49:12.854962Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.855574Z", "completed_at": "2026-01-20T14:49:12.855584Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010011911392211914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_users_lasts_user_identifier.2e0875d502", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_identifier as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_users_lasts\nwhere user_identifier is not null\ngroup by user_identifier\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.858275Z", "completed_at": "2026-01-20T14:49:12.862568Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.863142Z", "completed_at": "2026-01-20T14:49:12.863151Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0061380863189697266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified_integration_tests.snowplow_unified_consent_scope_status_actual", "compiled": true, "compiled_code": "\n\n\n\n\nselect *\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_scope_status", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_scope_status_actual", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.866087Z", "completed_at": "2026-01-20T14:49:12.871523Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.872095Z", "completed_at": "2026-01-20T14:49:12.872105Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0074481964111328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_consent_scope_status_scope.2b9365b124", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect scope\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_scope_status\nwhere scope is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.874793Z", "completed_at": "2026-01-20T14:49:12.879949Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.880561Z", "completed_at": "2026-01-20T14:49:12.880572Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007076740264892578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_consent_scope_status_scope.cd80ea727a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    scope as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_scope_status\nwhere scope is not null\ngroup by scope\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.883261Z", "completed_at": "2026-01-20T14:49:12.888770Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.889341Z", "completed_at": "2026-01-20T14:49:12.889351Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007359027862548828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified_integration_tests.snowplow_unified_consent_totals_actual", "compiled": true, "compiled_code": "\n\n\n\n\nselect *\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_consent_totals", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_totals_actual", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.892063Z", "completed_at": "2026-01-20T14:49:12.898501Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.899088Z", "completed_at": "2026-01-20T14:49:12.899098Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008340597152709961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified_integration_tests.dbt_utils_equal_rowcount_snowplow_unified_consent_users_actual_ref_snowplow_unified_consent_users_expected_stg_.8251b18a75", "compiled": true, "compiled_code": "\n\n\n\n\nwith a as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_a \n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_users_actual\n    group by id_dbtutils_test_equal_rowcount\n\n\n),\nb as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_b \n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_users_expected_stg\n    group by id_dbtutils_test_equal_rowcount\n\n),\nfinal as (\n\n    select\n    \n        a.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_a,\n          b.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_b,\n        \n\n        count_a,\n        count_b,\n        abs(count_a - count_b) as diff_count\n\n    from a\n    full join b\n    on\n    a.id_dbtutils_test_equal_rowcount = b.id_dbtutils_test_equal_rowcount\n    \n\n\n)\n\nselect * from final\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.559188Z", "completed_at": "2026-01-20T14:49:12.938945Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:12.939598Z", "completed_at": "2026-01-20T14:49:12.939610Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3816955089569092, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified_integration_tests.dbt_utils_equality_snowplow_unified_consent_cmp_stats_actual_ref_snowplow_unified_consent_cmp_stats_expected_stg_.ada2f282a8", "compiled": true, "compiled_code": "\n\n\n\n-- setup\n\n\n\n\n\n\nwith a as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_cmp_stats_actual\n\n),\n\nb as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_cmp_stats_expected_stg\n\n),\n\na_minus_b as (\n\n    select  from a\n    \n\n    except\n\n\n    select  from b\n\n),\n\nb_minus_a as (\n\n    select  from b\n    \n\n    except\n\n\n    select  from a\n\n),\n\nunioned as (\n\n    select 'a_minus_b' as which_diff, a_minus_b.* from a_minus_b\n    union all\n    select 'b_minus_a' as which_diff, b_minus_a.* from b_minus_a\n\n)\n\nselect * from unioned\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.713384Z", "completed_at": "2026-01-20T14:49:13.085975Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:13.086588Z", "completed_at": "2026-01-20T14:49:13.086599Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3761723041534424, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified_integration_tests.dbt_utils_equality_snowplow_unified_consent_versions_actual_ref_snowplow_unified_consent_versions_expected_stg_.6e4043b1d2", "compiled": true, "compiled_code": "\n\n\n\n-- setup\n\n\n\n\n\n\nwith a as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_versions_actual\n\n),\n\nb as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_versions_expected_stg\n\n),\n\na_minus_b as (\n\n    select  from a\n    \n\n    except\n\n\n    select  from b\n\n),\n\nb_minus_a as (\n\n    select  from b\n    \n\n    except\n\n\n    select  from a\n\n),\n\nunioned as (\n\n    select 'a_minus_b' as which_diff, a_minus_b.* from a_minus_b\n    union all\n    select 'b_minus_a' as which_diff, b_minus_a.* from b_minus_a\n\n)\n\nselect * from unioned\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:13.089302Z", "completed_at": "2026-01-20T14:49:13.095261Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:13.095965Z", "completed_at": "2026-01-20T14:49:13.095976Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.0079498291015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_users_this_run_end_tstamp.2343122421", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect end_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_users_this_run\nwhere end_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:13.098991Z", "completed_at": "2026-01-20T14:49:13.112398Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:13.114363Z", "completed_at": "2026-01-20T14:49:13.114376Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.016826391220092773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_users_this_run_engaged_time_in_s.6c8ec87fc3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engaged_time_in_s\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_users_this_run\nwhere engaged_time_in_s is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:13.118273Z", "completed_at": "2026-01-20T14:49:13.126074Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:13.128657Z", "completed_at": "2026-01-20T14:49:13.128669Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.012339115142822266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_users_this_run_network_userid.01e75c2b66", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect network_userid\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_users_this_run\nwhere network_userid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.943449Z", "completed_at": "2026-01-20T14:49:13.144489Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:13.145885Z", "completed_at": "2026-01-20T14:49:13.145897Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.20476889610290527, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified.snowplow_unified_users", "compiled": true, "compiled_code": "\n\n\n\nselect *\n  \nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_users_this_run\nwhere cast(True as boolean) --returns false if run doesn't contain new events.", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_users", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:13.138666Z", "completed_at": "2026-01-20T14:49:13.145242Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:13.146812Z", "completed_at": "2026-01-20T14:49:13.146822Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.010696887969970703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_users_this_run_sessions.3a2f33dcae", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sessions\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_users_this_run\nwhere sessions is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:13.152075Z", "completed_at": "2026-01-20T14:49:13.163367Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:13.164144Z", "completed_at": "2026-01-20T14:49:13.164156Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.014962911605834961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_users_this_run_start_tstamp.e6b6b8a018", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect start_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_users_this_run\nwhere start_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:13.158106Z", "completed_at": "2026-01-20T14:49:13.171958Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:13.172899Z", "completed_at": "2026-01-20T14:49:13.172911Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.022974729537963867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_users_this_run_user_identifier.2a721feeaf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_identifier\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_users_this_run\nwhere user_identifier is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:13.166865Z", "completed_at": "2026-01-20T14:49:13.180954Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:13.181654Z", "completed_at": "2026-01-20T14:49:13.181664Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.016063690185546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_users_this_run_views.6535b10483", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect views\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_users_this_run\nwhere views is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:13.175874Z", "completed_at": "2026-01-20T14:49:13.301843Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:13.309603Z", "completed_at": "2026-01-20T14:49:13.309619Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.13506579399108887, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_users_this_run_user_identifier.84672e2e42", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_identifier as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_scratch.snowplow_unified_users_this_run\nwhere user_identifier is not null\ngroup by user_identifier\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:13.185258Z", "completed_at": "2026-01-20T14:49:13.313099Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:13.316213Z", "completed_at": "2026-01-20T14:49:13.316225Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.13242769241333008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified_integration_tests.dbt_utils_equal_rowcount_snowplow_unified_consent_scope_status_actual_ref_snowplow_unified_consent_scope_status_expected_stg_.b8cacd3cab", "compiled": true, "compiled_code": "\n\n\n\n\nwith a as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_a \n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_scope_status_actual\n    group by id_dbtutils_test_equal_rowcount\n\n\n),\nb as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_b \n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_scope_status_expected_stg\n    group by id_dbtutils_test_equal_rowcount\n\n),\nfinal as (\n\n    select\n    \n        a.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_a,\n          b.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_b,\n        \n\n        count_a,\n        count_b,\n        abs(count_a - count_b) as diff_count\n\n    from a\n    full join b\n    on\n    a.id_dbtutils_test_equal_rowcount = b.id_dbtutils_test_equal_rowcount\n    \n\n\n)\n\nselect * from final\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.783743Z", "completed_at": "2026-01-20T14:49:13.344146Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:13.344837Z", "completed_at": "2026-01-20T14:49:13.344848Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5633871555328369, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified_integration_tests.snowplow_unified_integration_tests_equality_snowplow_unified_web_vital_measurements_actual_ref_snowplow_unified_web_vital_measurements_expected_stg___3.2ce4bf2e3f", "compiled": true, "compiled_code": "\n\n\n\n-- setup\n\n\n\n\n\n\nwith a as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_web_vital_measurements_actual\n\n),\n\nb as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_web_vital_measurements_expected_stg\n\n),\n\na_minus_b as (\n\n    select  from a\n    \n\n    except\n\n\n    select  from b\n\n),\n\nb_minus_a as (\n\n    select  from b\n    \n\n    except\n\n\n    select  from a\n\n),\n\nunioned as (\n\n    select 'a_minus_b' as which_diff, a_minus_b.* from a_minus_b\n    union all\n    select 'b_minus_a' as which_diff, b_minus_a.* from b_minus_a\n\n)\n\nselect * from unioned\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:13.336846Z", "completed_at": "2026-01-20T14:49:13.345738Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:13.347687Z", "completed_at": "2026-01-20T14:49:13.347698Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.016952037811279297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified_integration_tests.dbt_utils_equal_rowcount_snowplow_unified_consent_totals_actual_ref_snowplow_unified_consent_totals_expected_stg_.485f757328", "compiled": true, "compiled_code": "\n\n\n\n\nwith a as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_a \n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_totals_actual\n    group by id_dbtutils_test_equal_rowcount\n\n\n),\nb as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_b \n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_totals_expected_stg\n    group by id_dbtutils_test_equal_rowcount\n\n),\nfinal as (\n\n    select\n    \n        a.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_a,\n          b.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_b,\n        \n\n        count_a,\n        count_b,\n        abs(count_a - count_b) as diff_count\n\n    from a\n    full join b\n    on\n    a.id_dbtutils_test_equal_rowcount = b.id_dbtutils_test_equal_rowcount\n    \n\n\n)\n\nselect * from final\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:12.901838Z", "completed_at": "2026-01-20T14:49:13.346323Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:13.348598Z", "completed_at": "2026-01-20T14:49:13.348613Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.44809722900390625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified_integration_tests.dbt_utils_equality_snowplow_unified_consent_users_actual_ref_snowplow_unified_consent_users_expected_stg_.ed39291772", "compiled": true, "compiled_code": "\n\n\n\n-- setup\n\n\n\n\n\n\nwith a as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_users_actual\n\n),\n\nb as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_users_expected_stg\n\n),\n\na_minus_b as (\n\n    select  from a\n    \n\n    except\n\n\n    select  from b\n\n),\n\nb_minus_a as (\n\n    select  from b\n    \n\n    except\n\n\n    select  from a\n\n),\n\nunioned as (\n\n    select 'a_minus_b' as which_diff, a_minus_b.* from a_minus_b\n    union all\n    select 'b_minus_a' as which_diff, b_minus_a.* from b_minus_a\n\n)\n\nselect * from unioned\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:13.364261Z", "completed_at": "2026-01-20T14:49:13.377046Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:13.377712Z", "completed_at": "2026-01-20T14:49:13.377722Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02571725845336914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.snowplow_unified_integration_tests.snowplow_unified_users_actual", "compiled": true, "compiled_code": "\n\n\n--Removing model_tstamp\n\nselect\n  user_id\n  ,user_identifier\n  ,network_userid\n  ,stitched_user_id\n  ,start_tstamp\n  ,end_tstamp\n\n  ,first_platform\n  ,last_platform\n  ,on_web\n  ,on_mobile\n  ,last_screen_resolution\n  ,last_os_type\n  ,last_os_version\n  ,first_mobile__device_manufacturer\n  ,first_mobile__device_model\n  ,first_mobile__carrier\n  ,last_mobile__device_manufacturer\n  ,last_mobile__device_model\n  ,last_mobile__carrier\n  ,mobile__os_type\n  ,mobile__os_version\n  ,mobile__android_idfa\n  ,mobile__apple_idfa\n  ,mobile__apple_idfv\n  ,mobile__open_idfa\n  ,mobile__network_technology\n  ,mobile__network_type\n  ,mobile__physical_memory\n  ,mobile__system_available_memory\n  ,mobile__app_available_memory\n  ,mobile__battery_level\n  ,mobile__battery_state\n  ,mobile__low_power_mode\n  ,mobile__available_storage\n  ,mobile__total_storage\n  ,mobile__is_portrait\n  ,mobile__resolution\n  ,mobile__scale\n  ,mobile__language\n  ,mobile__app_set_id\n  ,mobile__app_set_id_scope\n  ,first_geo_country\n  ,first_geo_country_name\n  ,first_geo_continent\n  ,first_geo_city\n  ,first_geo_region_name\n  ,last_geo_country\n  ,last_geo_country_name\n  ,last_geo_continent\n  ,last_geo_city\n  ,last_geo_region_name\n  ,geo_zipcode\n  ,geo_latitude\n  ,geo_longitude\n  ,geo_timezone\n  ,views\n  ,sessions\n  ,active_days\n  ,engaged_time_in_s\n  ,screen_names_viewed\n  ,absolute_time_in_s\n  ,page_referrer\n  ,refr_medium\n  ,refr_source\n  ,refr_term\n  ,first_page_title\n  ,first_page_url\n  ,first_page_urlscheme\n  ,first_page_urlhost\n  ,first_page_urlpath\n  ,first_page_urlquery\n  ,first_page_urlfragment\n  ,first_br_lang\n  ,first_br_lang_name\n  ,last_page_title\n  ,last_page_url\n  ,last_page_urlscheme\n  ,last_page_urlhost\n  ,last_page_urlpath\n  ,last_page_urlquery\n  ,last_page_urlfragment\n  ,last_br_lang\n  ,last_br_lang_name\n  ,refr_urlscheme\n  ,refr_urlhost\n  ,refr_urlpath\n  ,refr_urlquery\n  ,refr_urlfragment\n  ,first_screen_view__name\n  ,first_screen_view__type\n  ,last_screen_view__name\n  ,last_screen_view__transition_type\n  ,last_screen_view__type\n  ,mkt_medium\n  ,mkt_source\n  ,mkt_term\n  ,mkt_content\n  ,mkt_campaign\n  ,mkt_clickid\n  ,mkt_network\n  ,mkt_source_platform\n  ,default_channel_group\n  ,app_errors\n  ,fatal_app_errors\n\n-- hard-coding due to non-deterministic outcome from row_number for Redshift/Postgres/databricks\n\n  ,first_event_id\n  ,first_event_id2\n  ,last_event_id\n  ,last_event_id2\n\n  ,agg_test\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_users", "relation_name": "SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_users_actual", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:13.369026Z", "completed_at": "2026-01-20T14:49:13.385577Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:13.386694Z", "completed_at": "2026-01-20T14:49:13.386705Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0340425968170166, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_users_end_tstamp.f58b0bcf06", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect end_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_users\nwhere end_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:13.380489Z", "completed_at": "2026-01-20T14:49:13.388600Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:13.389816Z", "completed_at": "2026-01-20T14:49:13.389826Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010692119598388672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_users_engaged_time_in_s.c55717a97e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engaged_time_in_s\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_users\nwhere engaged_time_in_s is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:13.392000Z", "completed_at": "2026-01-20T14:49:13.404765Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:13.405459Z", "completed_at": "2026-01-20T14:49:13.405470Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01639842987060547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_users_network_userid.998e27e258", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect network_userid\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_users\nwhere network_userid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:13.398656Z", "completed_at": "2026-01-20T14:49:13.407716Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:13.408878Z", "completed_at": "2026-01-20T14:49:13.408889Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011799812316894531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_users_sessions.55421015ef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sessions\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_users\nwhere sessions is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:13.409766Z", "completed_at": "2026-01-20T14:49:13.416910Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:13.422715Z", "completed_at": "2026-01-20T14:49:13.422728Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01581406593322754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_users_start_tstamp.5d33b09a65", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect start_tstamp\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_users\nwhere start_tstamp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:13.417514Z", "completed_at": "2026-01-20T14:49:13.425763Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:13.431512Z", "completed_at": "2026-01-20T14:49:13.431526Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.015925884246826172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_users_user_identifier.38f23dc040", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_identifier\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_users\nwhere user_identifier is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:13.426353Z", "completed_at": "2026-01-20T14:49:13.433912Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:13.435352Z", "completed_at": "2026-01-20T14:49:13.435363Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010921716690063477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.not_null_snowplow_unified_users_views.bbd526f2de", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect views\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_users\nwhere views is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:13.438398Z", "completed_at": "2026-01-20T14:49:13.447061Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:13.448905Z", "completed_at": "2026-01-20T14:49:13.448917Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.014331579208374023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified.unique_snowplow_unified_users_user_identifier.fd4bf488ce", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_identifier as unique_field,\n    count(*) as n_records\n\nfrom SNOWPLOW_DEV1.gh_sp_unified_dbt_1_derived.snowplow_unified_users\nwhere user_identifier is not null\ngroup by user_identifier\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:13.449795Z", "completed_at": "2026-01-20T14:49:13.461680Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:13.465145Z", "completed_at": "2026-01-20T14:49:13.465158Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01974201202392578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified_integration_tests.dbt_utils_equal_rowcount_snowplow_unified_users_actual_ref_snowplow_unified_users_expected_stg_.78448e6f51", "compiled": true, "compiled_code": "\n\n\n\n\nwith a as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_a \n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_users_actual\n    group by id_dbtutils_test_equal_rowcount\n\n\n),\nb as (\n\n    select \n      \n      1 as id_dbtutils_test_equal_rowcount,\n      count(*) as count_b \n    from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_users_expected_stg\n    group by id_dbtutils_test_equal_rowcount\n\n),\nfinal as (\n\n    select\n    \n        a.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_a,\n          b.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_b,\n        \n\n        count_a,\n        count_b,\n        abs(count_a - count_b) as diff_count\n\n    from a\n    full join b\n    on\n    a.id_dbtutils_test_equal_rowcount = b.id_dbtutils_test_equal_rowcount\n    \n\n\n)\n\nselect * from final\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:13.317794Z", "completed_at": "2026-01-20T14:49:13.668854Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:13.669456Z", "completed_at": "2026-01-20T14:49:13.669467Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3571183681488037, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified_integration_tests.dbt_utils_equality_snowplow_unified_consent_scope_status_actual_ref_snowplow_unified_consent_scope_status_expected_stg_.cd008a201b", "compiled": true, "compiled_code": "\n\n\n\n-- setup\n\n\n\n\n\n\nwith a as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_scope_status_actual\n\n),\n\nb as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_scope_status_expected_stg\n\n),\n\na_minus_b as (\n\n    select  from a\n    \n\n    except\n\n\n    select  from b\n\n),\n\nb_minus_a as (\n\n    select  from b\n    \n\n    except\n\n\n    select  from a\n\n),\n\nunioned as (\n\n    select 'a_minus_b' as which_diff, a_minus_b.* from a_minus_b\n    union all\n    select 'b_minus_a' as which_diff, b_minus_a.* from b_minus_a\n\n)\n\nselect * from unioned\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:13.353387Z", "completed_at": "2026-01-20T14:49:13.681330Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:13.682745Z", "completed_at": "2026-01-20T14:49:13.682756Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.33336353302001953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified_integration_tests.dbt_utils_equality_snowplow_unified_consent_totals_actual_ref_snowplow_unified_consent_totals_expected_stg_.89fccda7d0", "compiled": true, "compiled_code": "\n\n\n\n-- setup\n\n\n\n\n\n\nwith a as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_totals_actual\n\n),\n\nb as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_consent_totals_expected_stg\n\n),\n\na_minus_b as (\n\n    select  from a\n    \n\n    except\n\n\n    select  from b\n\n),\n\nb_minus_a as (\n\n    select  from b\n    \n\n    except\n\n\n    select  from a\n\n),\n\nunioned as (\n\n    select 'a_minus_b' as which_diff, a_minus_b.* from a_minus_b\n    union all\n    select 'b_minus_a' as which_diff, b_minus_a.* from b_minus_a\n\n)\n\nselect * from unioned\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T14:49:13.466227Z", "completed_at": "2026-01-20T14:49:13.783902Z"}, {"name": "execute", "started_at": "2026-01-20T14:49:13.784510Z", "completed_at": "2026-01-20T14:49:13.784520Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.323591947555542, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.snowplow_unified_integration_tests.dbt_utils_equality_snowplow_unified_users_actual_ref_snowplow_unified_users_expected_stg_.971c3ddd69", "compiled": true, "compiled_code": "\n\n\n\n-- setup\n\n\n\n\n\n\nwith a as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_users_actual\n\n),\n\nb as (\n\n    select * from SNOWPLOW_DEV1.gh_sp_unified_dbt_1_snplw_unified_int_tests.snowplow_unified_users_expected_stg\n\n),\n\na_minus_b as (\n\n    select  from a\n    \n\n    except\n\n\n    select  from b\n\n),\n\nb_minus_a as (\n\n    select  from b\n    \n\n    except\n\n\n    select  from a\n\n),\n\nunioned as (\n\n    select 'a_minus_b' as which_diff, a_minus_b.* from a_minus_b\n    union all\n    select 'b_minus_a' as which_diff, b_minus_a.* from b_minus_a\n\n)\n\nselect * from unioned\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 6.147042751312256, "args": {"indirect_selection": "eager", "empty_catalog": false, "partial_parse": true, "require_yaml_configuration_for_mf_time_spines": false, "show_resource_report": false, "macro_debugging": false, "require_nested_cumulative_type_params": false, "log_format_file": "debug", "skip_nodes_if_on_run_start_fails": false, "favor_state": false, "log_level": "info", "state_modified_compare_more_unrendered_values": false, "state_modified_compare_vars": false, "source_freshness_run_project_hooks": true, "upload_to_artifacts_ingest_api": false, "use_colors": true, "invocation_command": "dbt docs generate --vars {snowplow__atomic_schema: \"snowflake_snplw_unified_int_tests\"}", "print": true, "select": [], "profiles_dir": "./ci", "quiet": false, "require_all_warnings_handled_by_warn_error": false, "require_unique_project_resource_names": false, "strict_mode": false, "use_fast_test_edges": false, "printer_width": 80, "warn_error_options": {"error": [], "warn": [], "silence": []}, "write_json": true, "cache_selected_only": false, "compile": true, "defer": false, "require_resource_names_without_spaces": true, "require_explicit_package_overrides_for_builtin_materializations": true, "log_file_max_bytes": 10485760, "which": "generate", "static": false, "project_dir": "/home/runner/work/dbt-snowplow-unified/dbt-snowplow-unified/integration_tests", "require_ref_searches_node_package_before_root": false, "static_parser": true, "require_generic_test_arguments_property": true, "exclude": [], "validate_macro_args": false, "vars": {"snowplow__atomic_schema": "snowflake_snplw_unified_int_tests"}, "version_check": true, "require_batched_execution_for_custom_microbatch_strategy": false, "log_format": "default", "send_anonymous_usage_stats": false, "log_level_file": "debug", "use_colors_file": true, "populate_cache": true, "log_path": "/home/runner/work/dbt-snowplow-unified/dbt-snowplow-unified/integration_tests/logs", "partial_parse_file_diff": true, "show_all_deprecations": false, "introspect": true}}